"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["13932"],{82121:function(e,t,i){i.d(t,{A:()=>n});let n={closeWelcomeModal:"closeWelcomeModal-KVUfKQ",maybeLater:"maybeLater-PlK9NK",publicationCoverPhotoLeft:"publicationCoverPhotoLeft-txdH2G",publicationCoverPhotoRight:"publicationCoverPhotoRight-RHPl8T",largePublicationCoverPhotoRight:"largePublicationCoverPhotoRight-A77S35",column:"column-_rp_8U",largeColumn:"largeColumn-bqn6Me",centeredColumn:"centeredColumn-M8Fujf",largeCenteredColumn:"largeCenteredColumn-AfeswM",hideColumnSmallScreens:"hideColumnSmallScreens-rlLOgZ",hideLargeColumnSmallScreens:"hideLargeColumnSmallScreens-LQBTX8",publicationCoverPhotoCenter:"publicationCoverPhotoCenter-rMU5R1",publicationLogo:"publicationLogo-EWjoMq",coverPrimary:"coverPrimary-cGRhhL",coverSecondary:"coverSecondary-pfbfwO",blurbImage:"blurbImage-bS0Pkx",containerClassName:"containerClassName-iHFmrN",promptClassName:"promptClassName-fM9VHe",inputClassName:"inputClassName-v5NZvy",subscribeButtonClassName:"subscribeButtonClassName-wpxkEl",largeHeading:"largeHeading-ZEJJF0",largeSubHeading:"largeSubHeading-lGmUwg",largePromptClassName:"largePromptClassName-Uexj1F",largeInputWrapperClassName:"largeInputWrapperClassName-VqAUAb",largeInputClassName:"largeInputClassName-zCK22A",largeSubscribeButtonClassName:"largeSubscribeButtonClassName-gTO6Dt",postContainer:"postContainer-iqizM2",postTitle:"postTitle-uVmG1_",postSubtitle:"postSubtitle-sIac6Y",postImage:"postImage-nsvz_r",faces:"faces-igzFCe",face:"face-G_PpVO",first:"first-bCHdQ8",last:"last-GRcjMY",bigSubtitle:"bigSubtitle-o28Z4u",balancedText:"balancedText-oQ__Kv",tosLink:"tosLink-n6HoHl",blurbText:"blurbText-isJ4mY",tosText:"tosText-yAQHNw",emailFormContainer:"emailFormContainer-TcAFa_",dividerText:"dividerText-_CxQGl"}},74084:function(e,t,i){i.d(t,{A:()=>n});let n={closeButton:"closeButton-YU1ngO",absolute:"absolute-ecQ0HE",imageCloseButton:"imageCloseButton-YQIpP0"}},70780:function(e,t,i){i.d(t,{T:()=>h});var n=i(4006),a=i(17402),r=i(24142),l=i(84605),o=i(86500),s=i(94729),u=i(68349),c=i(35369),d=i(76977),p=i(49807),m=i(57324);let h=e=>{let{publication:t,user:i,email:h,onSubscribeSuccess:g}=e,{iString:b}=(0,l.GO)(),[f,_]=(0,a.useState)(!1),y=(0,a.useCallback)(async()=>{if(!f){_(!0);try{(0,o.u4)(o.qY.APP_STORE_LINK_CLICKED,{source:"intro_popup_app_upsell",utm_campaign:m._9.welcomeSubscribeInApp,utm_source:m.VU.coverPage});let e=h||(null==i?void 0:i.email);if(e)try{await (0,s.x6)("/api/v1/free",{method:"POST",json:{email:e,source:"intro_popup_app_upsell"}})}catch(e){console.error("Failed to subscribe user:",e)}try{await (0,s.x6)("/api/v1/app_intended_state",{method:"POST",json:{data:{category:"publication",publicationId:t.id},useIp:!i}}),await (0,s.x6)("/api/v1/onboarding_intended_recommendations",{method:"POST",json:{recommendations:[{publicationId:t.id,isPrechecked:!0,source:"intro_popup_app_upsell"}],useIp:!i}})}catch(e){console.error("Failed to set app intended state:",e)}g&&g();let n=(0,p.Bte)({subdomain:t.subdomain,utm_source:m.VU.coverPage,utm_campaign:m._9.welcomeSubscribeInApp,redirect:"app-store"});(0,u.V2)(n,{local_navigation:!1})}catch(e){console.error("Failed to handle subscribe in app click:",e)}finally{_(!1)}}},[f,i,h,t,g]);return(0,n.Y)(d.I1,{paddingBottom:24,paddingX:24,style:{width:"100%",maxWidth:"380px"},children:(0,n.Y)(c.$n,{priority:"quaternary",width:"100%",className:"button-kENIJe",onClick:y,disabled:f,loading:f,leading:(0,n.Y)(r.A,{height:20,fill:"#FF6719"}),children:b("Subscribe in the app")})})}},97432:function(e,t,i){i.d(t,{A:()=>x});var n=i(99851),a=i(69277),r=i(70408),l=i(79785),o=i(4006),s=i(32485),u=i.n(s),c=i(17402),d=i(34206),p=i(84605),m=i(34835),h=i(86500),g=i(1683),b=i(68349),f=i(35369),_=i(63136),y=i(65842),v=i(21398),C=i(40659),S=i(39318),E=i(41086),Y=i(80856),I=i(82776),P=i(57324),k=i(27569);function N(){let e=(0,l._)(["Confirmation required: we sent an email to ",". Click the link there to finish subscribing."]);return N=function(){return e},e}class x extends c.Component{getSavedEmail(){return this.props.user&&this.props.user.email||null}getPrefilledEmail(){return this.props.email||this.props.freeSignupEmail||this.getSavedEmail()}async componentDidMount(){let{autoFocus:e,disabled:t}=this.props;if(this.getPrefilledEmail())this.emailInput.value=this.getPrefilledEmail();else if(e&&!(this.getPrefilledEmail()||t)&&!(0,b.rr)()){var n;null==(n=this.emailInput)||n.focus()}i.e("40837").then(i.bind(i,24548)).then(e=>{this.setState({fetchSuggestion:e.fetchSuggestion})})}onLoadingState(e){this.setState({loading:e,requires_confirmation:!1})}onError(e){var t;(null==(t=e.response)?void 0:t.status)===425&&this.setState({requires_confirmation:!0}),this.props.onError&&this.props.onError(e)}render(){var e,t,n,r,l,s,c;let{children:p,className:m,disabled:h,allowEmptyInput:N,expectTruncation:x,isWelcomePageColor:w,loginRedirect:A,next:F,onAccentBackground:T,pub:R,referralCode:D,showLogin:O,showTerms:B,source:L,submitButtonText:H,useSubscribeLink:q,useGenericEndpoint:V,additionalPubIds:K,user:j,utm_campaign:M,onPrepareData:U,promptClassName:W,inputWrapperClassName:Q,inputClassName:G,subscribeButtonClassName:J,subscribeToSpecificSectionIds:z,endpointOverride:Z,separateInputAndSubmitButton:X,placeholder:$}=this.props,{loading:ee,requires_confirmation:et,currentEmail:ei}=null!=(c=this.state)?c:{},en="treatment_bold_fade"===L,ea=(null==(n=(0,E.y)("referring_pub_ids"))||null==(t=n.split)||null==(e=t.call(n,","))?void 0:e[0])||void 0,er=(null==(s=(0,E.y)("referring_pub_ids"))||null==(l=s.split)||null==(r=l.call(s,","))?void 0:r.slice(1))||void 0,el=this.getPrefilledEmail(),{iString:eo,language:es}=this.context;if(z&&(K||V))throw Error("Specific section subscriptions only supported on /api/v1/free");let eu=!Z&&!K;return(0,o.FD)("div",{className:u()(m,k.A.container),children:[(0,o.Y)(C.HM.Consumer,{children:e=>{var t,i,n,r,l,s,c;let{getSessionAttribution:m}=e;return(0,o.FD)(d.Ay,{ref:this.assignForm,className:k.A.form,noInlineErrors:!0,action:Z||(K?(0,S.yRP)("/api/v1/bulk_signup"):V?(0,S.yRP)("/api/v1/reader/signup/pub"):(0,S.yRP)("/api/v1/free")),noJsAction:Z||(K?(0,S.yRP)("/api/v1/bulk_signup",{nojs:!0}):V?(0,S.yRP)("/api/v1/reader/signup/pub",{nojs:!0}):(0,S.yRP)("/api/v1/free",{nojs:!0})),prepareData:async e=>{if(et&&(e.resend_confirmation=!0),"string"==typeof e.publications&&(e.publications=JSON.parse(e.publications)),"undefined"!=typeof window&&eu){let t=await m();e=(0,a._)({},t,e)}return U&&await U(e),e},onChangeLoadingState:this.onLoadingState.bind(this),onError:e=>this.onError(e),onSuccess:e=>this.onSuccess(e),typoFound:e=>this.setState({emailSuggestion:e}),disableSubmit:q,analyticsName:"Free Email Form",children:[(0,o.Y)("input",{type:"hidden",name:"first_url",value:g.R9}),(0,o.Y)("input",{type:"hidden",name:"first_referrer",value:g.b7}),(0,o.Y)("input",{type:"hidden",name:"current_url",value:g.AT}),(0,o.Y)("input",{type:"hidden",name:"current_referrer",value:g.uC}),(0,o.Y)("input",{type:"hidden",name:"first_session_url",value:g.K0}),(0,o.Y)("input",{type:"hidden",name:"first_session_referrer",value:g.OG}),(0,o.Y)("input",{type:"hidden",name:"referral_code",value:D}),(0,o.Y)("input",{type:"hidden",name:"source",value:L}),(0,o.Y)("input",{type:"hidden",name:"referring_pub_id",value:ea}),(0,o.Y)("input",{type:"hidden",name:"additional_referring_pub_ids",value:null==er?void 0:er.join(",")}),F&&(0,o.Y)("input",{type:"hidden",name:"redirect",value:F}),z&&(0,o.Y)("input",{type:"hidden",name:"specific_section_ids",value:z}),z&&(0,o.Y)("input",{type:"hidden",name:"section_and_root",value:"true"}),!K&&V&&(0,o.Y)("input",{type:"hidden",name:"publication_id",value:R.id}),K&&(0,o.Y)("input",{type:"hidden",name:"publications",value:JSON.stringify(K.concat(R.id))}),(0,o.FD)("div",{className:u()(W,{[k.A.sideBySideWrap]:!X}),children:[!!el&&(0,b.o7)(),(0,o.Y)("div",{className:u()(Q,k.A.emailInputWrapper,{[null!=(n=k.A.emailInputWrapperExpectTruncation)?n:"undefined"]:x}),children:(0,o.Y)(y.ks,{className:u()(G,"pencraft",k.A.emailInput,{[null!=(r=k.A.emailInputOnAccentBackground)?r:"undefined"]:T,[null!=(l=k.A.emailInputExpectTruncation)?l:"undefined"]:x,[null!=(s=k.A.emailInputOnWelcomePage)?s:"undefined"]:w}),onChange:this.handleEmailChange,onInput:this.handleEmailChange,ref:this.assignEmailInput,type:"email",name:en?"email-pop":"email",readOnly:!!(this.getSavedEmail()||ee||h),disabled:!!(ee||h),placeholder:null!=$?$:eo("Type your email..."),value:ei||el||null})}),(0,o.Y)(f.Nm,{resetCss:!0,className:u()(J,"rightButton primary subscribe-btn",k.A.button,{pop:en,[null!=(c=k.A.buttonOnAccentBackground)?c:"undefined"]:T}),type:"submit",disabled:!!(ee||h||!N&&!(null==(i=this.emailInput)||null==(t=i.value)?void 0:t.trim())),onClick:()=>{q&&(location.href=(0,S.eV6)(R,(0,a._)({addBase:!0,user:j,utm_source:P.VU.substack,utm_medium:P.Jn.web,utm_campaign:M,next:F},(ei||el)&&{email:ei||el})))},children:(0,o.Y)("span",{className:"button-text ".concat(en?"pop":""),children:H||(0,I.getSubscribeText)(R,{language:es})})})]}),et?(0,o.Y)("div",{children:(0,o.FD)(_.EY,{translated:!0,className:"error other-error",children:["This email address is not confirmed yet.",(0,o.Y)("br",{}),(0,o.Y)("a",{href:"javascript:void(0)",onClick:()=>{if(this.form)return this.form.handleSubmit()},children:"Click here"})," ","to resend the confirmation email."]})}):(0,o.Y)("div",{id:"error-container"}),O||B||p?(0,o.FD)("div",{className:u()("subtle-help-text below-input",k.A.links),children:[O&&(this.getSavedEmail()?(0,o.Y)("a",{className:"login-button",href:(0,S.bgT)({for_pub:R.subdomain}),native:!0,children:eo("Not you?")}):(0,o.Y)("a",{className:"login-button",href:(0,S.a7q)({for_pub:R.subdomain,redirect:A}),native:!0,children:eo("Login")})),B&&[(0,o.Y)("a",{className:"legal",href:(0,Y._)({pub:R}),target:"_blank",native:!0,children:eo("Privacy")}),(0,o.Y)("a",{className:"legal",href:(0,Y.Ru)({pub:R}),target:"_blank",native:!0,children:eo("Terms")}),(0,o.Y)("a",{className:"legal",href:(0,Y.iQ)(),target:"_blank",native:!0,children:eo("Information collection notice")})],p]}):null]})}}),(0,o.Y)(v.Ic,{onRequest:()=>i.e("58911").then(i.bind(i,56130)),resolve:e=>e.EmailTypoHandler,module:"@/frontend/login/typo_handler/EmailTypoHandler",emailSuggestions:this.state.emailSuggestions,currentEmail:this.state.currentEmail,onAccept:this.onAcceptSuggestion})]})}constructor(e){super(e),(0,n._)(this,"emailInput",void 0),(0,n._)(this,"form",void 0),(0,n._)(this,"assignEmailInput",e=>{this.emailInput=e}),(0,n._)(this,"assignForm",e=>{this.form=e}),(0,n._)(this,"handleEmailChange",()=>{var e,t,i;let n=null==(e=this.emailInput)?void 0:e.value;!n||(this.setState({currentEmail:n}),this.state.emailSuggestions&&this.state.emailSuggestions.hasOwnProperty(n)||null==(t=(i=this.state).fetchSuggestion)||t.call(i,n).then(e=>{let[t,i]=e;this.setState({emailSuggestions:(0,r._)((0,a._)({},this.state.emailSuggestions),{[null!=t?t:"undefined"]:null!=i?i:""})})}))}),(0,n._)(this,"_onSuccess",async e=>{let{iTemplate:t}=this.context;(!0===e.body.is_new_subscriber||!1===e.body.prompt_to_login&&!0===e.body.didSignup)&&h.$5(),(Array.isArray(e.body)&&e.body.every(e=>e.requires_confirmation)||e.body.requires_confirmation)&&(this.props.onConfirmationRequired?await this.props.onConfirmationRequired(e):alert(t(N(),e.body.email))),this.props.freeSignupEmail&&this.props.freeSignupEmail!==e.body.email&&(0,m.E)({freeSignupEmail:e.body.email}),this.props.onSuccess&&await this.props.onSuccess(e)}),(0,n._)(this,"onSuccess",async e=>{"undefined"!=typeof window&&window.campaign&&(0,E.y)("referralCode")?window.campaign.identify({email:e.body.email},()=>this._onSuccess(e)):await this._onSuccess(e)}),(0,n._)(this,"onAcceptSuggestion",e=>{this.emailInput&&(this.emailInput.value=null!=e?e:"",this.form.handleSubmit(null,!0))}),this.state={emailSuggestions:{}}}}(0,n._)(x,"contextType",p.OW)},1156:function(e,t,i){i.d(t,{VP:()=>r,fI:()=>a,ov:()=>l});var n=i(89490);let a=(0,n.I4)({display:"flex"}),r=(0,n.I4)({display:"flex",direction:"column"}),l=(0,n.I4)({display:"flex",justifyContent:"center",alignItems:"center"})},61554:function(e,t,i){i.d(t,{U:()=>h});var n=i(69277),a=i(70408),r=i(4006),l=i(56778),o=i(86500),s=i(60322),u=i(76977),c=i(63136),d=i(18189),p=i(80856),m=i(84479);let h=e=>{let{includeCheckbox:t=!0,onCheckboxChange:i=()=>{},checked:h=!1,addSubscribePreamble:g=!1,addSignupPreamble:b=!1,fontWeight:f="regular",size:_="regular",color:y="primary",textAlign:v="left",style:C,pub:S}=e,E=null==S?void 0:S.has_custom_tos,Y=null==S?void 0:S.has_custom_privacy,I=null;return E&&Y?I=(0,r.FD)(r.FK,{children:["the publisher's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p.Ru)({pub:S}),target:"_blank",style:{textDecoration:"underline"},children:"Terms of Service"})," ","and"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p._)({pub:S}),target:"_blank",style:{textDecoration:"underline"},children:"Privacy Policy"}),","," "]}):E?I=(0,r.FD)(r.FK,{children:["the publisher's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p.Ru)({pub:S}),target:"_blank",style:{textDecoration:"underline"},children:"Terms of Service"}),","," "]}):Y&&(I=(0,r.FD)(r.FK,{children:["the publisher's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p._)({pub:S}),target:"_blank",style:{textDecoration:"underline"},children:"Privacy Policy"}),","," "]})),(0,r.FD)(r.FK,{children:[(0,r.Y)(l.A,{onVisible:()=>{(0,o.u4)(d.q.TERMS_OF_SERVICE_SEEN,{withCheckbox:t,initialCheckboxValue:h})}}),(0,r.FD)(u.Ye,{as:"label",alignItems:"center",justifyContent:"center",gap:12,style:C,className:m.A.tosCheckbox,children:[t&&(0,r.Y)(s.S,{checked:h,onChange:e=>{(0,o.u4)(d.q.TERMS_OF_SERVICE_CHECKBOX_CLICKED,{checkboxValue:e}),i(e)},size:"sm"}),(0,r.FD)(c.EY.B4,(0,a._)((0,n._)({color:y,textAlign:v,fontWeight:f},"small"===_?{size:11,lineHeight:16}:{}),{children:[g?"By subscribing, ":b?"By creating an account, ":"","I agree to"," ",I,"Substack's"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p.lk)(),target:"_blank",style:{textDecoration:"underline"},children:"Terms of Use"}),", and acknowledge its"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p.iQ)(),target:"_blank",style:{textDecoration:"underline"},children:"Information Collection Notice"})," ","and"," ",(0,r.Y)(c.EY,{as:"a",href:(0,p.gB)(),target:"_blank",style:{textDecoration:"underline"},children:"Privacy Policy"}),"."]}))]})]})}},55298:function(e,t,i){i.d(t,{cx:()=>r,wH:()=>a,zw:()=>l});var n=i(92636);let a=e=>(0,n.yR)("".concat((0,n.Ew)(),"/app/app-store-redirect"),e),r=e=>(0,n.yR)("".concat((0,n.Ew)(),"/app/get-ios"),e),l=e=>(0,n.yR)("".concat((0,n.Ew)(),"/app/get-android"),e)}}]);