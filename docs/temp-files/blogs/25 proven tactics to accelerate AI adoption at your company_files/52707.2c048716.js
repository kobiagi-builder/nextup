"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["52707"],{91093:function(e,t,i){i.d(t,{A:()=>a});let a={queue:"queue-EZRP7x",cardWrapper:"cardWrapper-qR0zV5",smallCardWrapper:"smallCardWrapper-GidLX3",archived:"archived-tVgnOK",arrow:"arrow-M1xp9f",disabled:"disabled-C1q6TH",link:"link-gPxpTf",highlight:"highlight-khGgmH",border:"border-Sobc4n",playButtonContainer:"playButtonContainer-SkXFOr",playButton:"playButton-NfBL9x",logoContainerShadow:"logoContainerShadow-MadM6a",cornerLogo:"cornerLogo-sq79Zv",vibranceTertiaryIcon:"vibranceTertiaryIcon-FMLmJq",vibranceSecondaryText:"vibranceSecondaryText-mI5k5T",vibranceTertiaryBg:"vibranceTertiaryBg-dway6D",closeButton:"closeButton-dm0qJO",closeIcon:"closeIcon-dUQ0_l",card:"card-DZvXCa",smallCard:"smallCard-QlKXKt",cardBg:"cardBg-Vnz3e5",cardTop:"cardTop-qa11Ls",bigCardTop:"bigCardTop-xISBuI",smallCardTop:"smallCardTop-YuCbBT",gifPreview:"gifPreview-jTpyu3",coverImage:"coverImage-h44eo2",audioWaveform:"audioWaveform-QTkNO2",audioLogoContainer:"audioLogoContainer-yUWOV3",cardBottom:"cardBottom-KjkXaq",smallCardRight:"smallCardRight-A8Afqo",titleContainerMinHeight:"titleContainerMinHeight-QKOvED",title:"title-EwaRJw",smallCardAuthor:"smallCardAuthor-MXnD06",iconButton:"iconButton-g5L_4l",isSaved:"isSaved-Ml5fNZ",newIconButton:"newIconButton-AH4esm",livePreview:"livePreview-t_LWyR",blur:"blur-Q0P53N",explicitIcon:"explicitIcon-otqJ1H"}},70828:function(e,t,i){i.d(t,{A:()=>a});let a={container:"container-fi9IrN",nav:"nav-ptYSWX"}},61431:function(e,t,i){i.d(t,{_:()=>h});var a=i(69277),n=i(70408),o=i(4006),r=i(84605),l=i(86500),s=i(89490),c=i(35369),d=i(60322),u=i(76977),p=i(81203),m=i(63136);function h(e){let{profile:t,onFinalizeVisibility:i,onSetVisibility:s,source:d,hideButton:p}=e,{iString:m}=(0,r.GO)();if(!t)return null;let h=t.subscriptions.every(e=>{let{visibility:t}=e;return"public"===t});return(0,o.FD)(u.VP,{children:[(0,o.Y)(u.fI,{justifyContent:"end",pullX:8,children:(0,o.Y)(c.$n,{size:"sm",priority:"quaternary",onClick:()=>{let e=h?"private":"public";s(t.subscriptions.reduce((t,i)=>{let{publication:o}=i;return(0,n._)((0,a._)({},t),{[o.id]:e})},{})),(0,l.u4)(l.qY.PROFILE_EDITED,{type:"visibility_toggled_all",for:"reads",count:t.subscriptions.length,newVisibility:e})},children:m(h?"Hide all":"Show all")})}),(0,o.Y)(u.VP,{minHeight:320,gap:4,children:t.subscriptions.map(e=>{let i;return(0,o.Y)(g,{sub:e,onSetVisibility:(i=e.publication,e=>{s(t.subscriptions.reduce((t,o)=>{let{visibility:r,publication:l}=o;return(0,n._)((0,a._)({},t),{[l.id]:l.id===i.id?e:r})},{})),(0,l.u4)(l.qY.PROFILE_EDITED,{type:"read_visibility_toggled",visibility:e})}),source:d},e.id)})}),!p&&(0,o.Y)(c.$n,{priority:"primary",onClick:i,children:m("Done")})]})}function g(e){let{sub:t,onSetVisibility:i}=e,a=t.publication;return(0,o.FD)(Y,{children:[(0,o.Y)(p.Nq,{pub:a,size:32}),(0,o.Y)(m.EY.B3,{weight:"medium",flex:"grow",children:a.name}),(0,o.Y)(d.S,{checked:"public"===t.visibility,onChange:()=>i("public"===t.visibility?"private":"public")})]})}let Y=(0,s.I4)({display:"flex",paddingY:8,gap:12,alignItems:"center",minWidth:0})},12165:function(e,t,i){i(4006),i(97731)},72035:function(e,t,i){i(4006),i(97731)},13918:function(e,t,i){i.d(t,{Dq:()=>X,d2:()=>$,u3:()=>V});var a=i(99851),n=i(69277),o=i(70408),r=i(4006),l=i(32485),s=i.n(l),c=i(83673),d=i.n(c),u=i(17402),p=i(34615),m=i(27437),h=i(17436),g=i(54158),Y=i(89839),b=i(18325),_=i(59821),v=i(26184),y=i(53868),f=i(97683),C=i(11333),k=i(41935),S=i(55136),w=i(84605),N=i(85478),B=i(6049),T=i(86500),A=i(12501),D=i(24078),E=i(22057),I=i(76977),P=i(63136),M=i(83629),F=i(16291),L=i(41232),x=i(98111),q=i(56458),W=i(56262),O=i(39318),R=i(70189),U=i(49807),Z=i(82776),H=i(57324);class K extends u.Component{componentWillUnmount(){this.unmounted=!0}render(){let{pub:e,post:t,showAuthor:i,showPhoto:a,fromPostPage:l}=this.props;return(0,k.AS)({pub:e,post:t,showAuthor:i,showPhoto:a})||(0,k.o$)({pub:e,post:t,showAuthor:i})||(0,k.Bq)({pub:e,post:t,showAuthor:i})?this.withAuthorLine(this.props,this.state):(0,r.Y)(j,(0,o._)((0,n._)({},this.props),{className:"alternative-meta",isMobileWidth:this.state.isMobileWidth,actionBarStyle:l?"post-header-compact":"post-preview"}))}constructor(e,t){var i;if(super(e,t),(0,a._)(this,"unmounted",void 0),(0,a._)(this,"withAuthorLine",(e,t)=>{let{pub:i,post:a,showAuthor:n,showPhoto:o,getConfigFor:l,isAppMode:c}=e,d="adhoc_email"===a.type,u=(0,Z.getBylineUsers)(a).length,p=1===u&&(0,Z.getBylineUsers)(a)[0],m=p&&p.is_guest&&!l("dont_show_guest_byline")&&!d,h=e.showDate||e.showDatetime,g=!a.is_published&&!e.inThreadHead&&h&&!d,Y=e.isFreePreview&&e.showAudience&&h&&!d,b=(0,W.isFoundingAudience)(a.audience)&&e.showAudience&&!Y&&h&&!d&&!(0,q.Ed)({post:a}),_=(0,W.isPaidAudience)(a.audience)&&e.showAudience&&!b&&!Y&&h&&!d&&!(0,q.Ed)({post:a}),v=(0,k.AS)({pub:i,post:a,showAuthor:n,showPhoto:o});return(0,r.Y)(B.h2,{width:"100%",className:s()("post-meta"),children:(0,r.FD)("tr",{children:[(0,r.Y)("td",{children:(0,r.FD)(B.jJ,{children:[(0,r.Y)(B.ZB,{gap:4,children:(0,r.Y)(P.EY.Meta,{color:"primary",className:L.A.postAuthor,children:u>0?(0,Z.oxfordComma)((0,Z.getBylineUsers)(a).map(e=>(0,r.Y)(P.EY.Meta,{as:"a",href:c?(0,U.gTK)({user_id:e.id,user_name:e.name,redirect:"app-store-no-desktop"}):(0,O.laT)(e,i),color:"primary",style:"text-decoration: none",children:e.name}))):(0,Z.getPrintedByline)(i,a)})}),(0,r.FD)(B.ZB,{gap:4,children:[(0,r.Y)(P.EY.Meta,{children:(e.showDate||e.showDatetime)&&a.post_date&&(0,r.Y)("time",{dateTime:(0,F.A)(a.post_date).toISOString(),children:(0,F.A)(a.post_date).locale(this.context.language).standardDate()})}),_&&(0,r.FD)(B.ZB,{gap:4,children:[(0,r.Y)(P.EY.Meta,{children:"∙"}),(0,r.Y)(P.EY.Meta,{color:"paid",translated:!0,children:"Paid"})]}),b&&(0,r.FD)(B.ZB,{gap:4,children:[(0,r.Y)(P.EY.Meta,{children:"∙"}),(0,r.Y)(P.EY.Meta,{color:"paid",children:this.context.iString((0,q.G8)(i,a))})]}),Y&&(0,r.FD)(B.ZB,{gap:4,children:[(0,r.Y)(P.EY.Meta,{children:"∙"}),(0,r.Y)(P.EY.Meta,{color:"paid",translated:!0,children:"Preview"})]}),m&&(0,r.FD)(B.ZB,{gap:4,children:[(0,r.Y)(P.EY.Meta,{children:"∙"}),(0,r.Y)(P.EY.Meta,{translated:!0,children:"Guest post"})]}),g&&(0,r.FD)(B.ZB,{gap:4,children:[(0,r.Y)(P.EY.Meta,{children:"∙"}),(0,r.Y)(P.EY.Meta,{translated:!0,children:"Draft"})]})]})]})}),v&&(0,r.Y)("td",{align:"right",children:(0,r.Y)(B.ZB,{gap:4,children:u>0&&(0,Z.getBylineUsers)(a).map((e,t)=>{var a;return t<4&&(0,r.Y)("a",{href:c?(0,U.gTK)({user_id:e.id,user_name:e.name,redirect:"app-store-no-desktop"}):(0,O.laT)(e,i),children:(0,r.Y)(B.Kb,{src:null!=(a=e.photo_url)?a:"",size:u>1?32:40})})})})})]})})}),"undefined"!=typeof window&&(null==(i=window)?void 0:i.matchMedia)){const e=window.matchMedia("screen and (max-width: 650px)");this.state={isMobileWidth:e.matches};const t=e=>{this.unmounted||this.setState({isMobileWidth:e.matches})};e.addEventListener?e.addEventListener("change",t):e.addListener&&e.addListener(t)}}}(0,a._)(K,"contextType",w.OW);let V=(0,N.P_)(K);function $(e){var t,i;let{pub:a,post:o,user:l,reactors:s,secondaryFaces:c,mediaClipId:d}=e,[m,h]=(0,u.useState)(null),[g,Y]=(0,u.useState)(!1),b=(0,A.st)({pathname:"primary"===m?"/api/v1/post/".concat(o.id,"/reactors"):"/api/v1/".concat(d?"media_clip":"post","/").concat(null!=d?d:o.id,"/restackers"),auto:!!m,deps:[o.id,m]}),_=G(s,l,!!o.reaction,a),v=G(c,l,!!o.restacked,a),y=_.concat(v.filter(e=>!!e.photo_url&&!_.find(t=>t.id===e.id))),f=Math.max(null!=(t=o.reactions["❤"])?t:0,(null!=_?_:[]).length),C=a.hide_post_restacks?0:null!=(i=o.restacks)?i:0,k=f>0?(0,Z.pluralize)(f,"Like"):"",S="";return C>0&&(S="".concat((0,Z.pluralize)(C,"Restack"))),(0,r.FD)(r.FK,{children:[(0,r.FD)(I.fI,{gap:16,alignItems:"center",color:"secondary",children:[(0,r.Y)(E.Z,{users:y,renderAvatar:e=>(0,r.Y)(D.tp,(0,n._)({},e)),direction:"rtl",renderCount:()=>(0,r.Y)(u.Fragment,{})}),(0,r.Y)(P.EY.B4,{color:"secondary",children:(0,r.FD)(I.fI,{gap:4,alignItems:"center",children:[(0,r.Y)(z,{label:k,onClick:()=>{f&&((0,T.u4)(T.qY.POST_REACTIONS_MODAL_VIEWED,{post_id:o.id}),h("primary"),Y(!0))}}),k&&S&&"∙",(0,r.Y)(J,{post:o,label:S})]})})]}),b.result&&(0,r.Y)(p.K,{isOpen:g,modalLabel:k,faces:b.result,totalCount:f,onClose:()=>{Y(!1),h(null)},utmSource:"post-reactions-modal"})]})}let z=e=>{let{label:t,onClick:i}=e;return(0,r.Y)(P.Yq,{onClick:i,color:"secondary",cursor:"pointer",children:t})},J=e=>{let{label:t,post:i}=e;return(0,r.Y)(P.EY.B4,{color:"secondary",children:(0,r.Y)(P.Yq,{href:(0,R.so)(i.id,{noBase:M.Z,urlParams:{utm_source:H.VU.substack,utm_content:H.fL.facepileRestacks}}),color:"secondary",children:t})})};function X(e){var t,i;let{post:a,user:o,pub:l,mediaClipId:s}=e,c=(0,A.st)({pathname:"/api/v1/post/".concat(a.id,"/facepile"),auto:!0,deps:[a.id,s],query:{media_clip_id:s}});return(0,r.Y)($,(0,n._)({reactors:G(null==(t=c.result)?void 0:t.reactors,o,!!a.reaction,l),secondaryFaces:G(null==(i=c.result)?void 0:i.restackers,o,!!a.restacked,l)},e))}function G(e,t,i,a){if(!e)return[];if(t){let n=e.findIndex(e=>e.id===t.id);i&&("private"!==t.subscription_visibility||46438===a.id)&&t.activity_likes_enabled&&n<0?e.splice(0,0,{id:t.id,name:t.name,photo_url:t.photo_url}):!i&&n>=0&&e.splice(n,1)}return e}function j(e){var t;let i,{additionalCommentCount:a=0,className:n,user:o,pub:l,post:c,showAudience:u=!1,showDate:p=!1,showEmailSent:Y=!1,showDatetime:w=!1,showReactions:N=!0,showComments:B=!0,showShare:T=!1,showRestack:A=!1,showPublicationName:D=!1,hidePinning:E=!1,reaction_token:I,onClick:M,onChange:L,isStatic:q=!1,isFreePreview:R=!1,allowSendEmail:U=!1,allowEdit:K=!1,shareTooltipText:V,showPins:$,sharedShareDialog:z,onClickCommentButton:J,showAuthor:X,showPhoto:G,fromPostPage:j,isMobileWidth:ee,actionBarStyle:et="post-header-compact"}=e,ei=l.id===c.publication_id?l:void 0,ea="post-footer"===et,en=ea?20:"post-preview"===et?14:18,eo="post-header-large"===et?20:"post-preview"===et?16:"thread-head"===et||ea?14:18;i=c.comment_url_override?c.comment_url_override:q?"".concat(x.T.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(H.VU.substack,"&utm_medium=").concat(H.Jn.email):(0,O.wu9)(l,c,{comments:!0});let er=a+(null!=(t=c.comment_count)?t:0),el=B&&!R&&(0,Z.showCommentsOnPost)({publication:l,post:c})&&"restack"!==c.type,es=N&&!R&&!["adhoc_email","restack"].includes(c.type),ec=(p||w)&&c.post_date&&!c.is_draft,ed=Y?!!c.email_sent_at:null,eu=d()([Y&&ed&&{className:"email-sent",title:"This post was sent as an email",content:(0,r.Y)(h.A,{className:"post-meta-icon",height:en,isStatic:q})},$&&c.is_section_pinned&&{className:"icon pinned",content:(0,r.Y)(v.A,{className:"post-meta-icon",isStatic:q})},"adhoc_email"===c.type?{className:"audience-adhoc",content:(0,r.Y)(y.A,{className:"post-meta-icon",isStatic:q})}:u&&(0,W.isPaidAudience)(c.audience)&&{className:"audience-lock",content:(0,r.Y)(g.A,{color:"#666666",height:en,isStatic:q})},(0,k.uC)({pub:l,post:c,showAuthor:X,showPhoto:G,isMobileWidth:ee})&&{className:"author",content:(0,Z.getBylineUsers)(c).length>0?(0,Z.oxfordComma)((0,Z.getBylineUsers)(c).map(e=>(0,r.Y)(m.ProfileHoverCard,{disabled:q,subject:e,utmSource:"byline",trigger:(0,r.Y)("a",{href:(0,O.laT)(e,l),onClick:e=>e.stopPropagation(),children:e.name})}))):(0,Z.getPrintedByline)(l,c)},D&&{className:"post-publication-name",content:l.name},K&&!q&&o&&o.is_contributor&&{className:"post-meta-item icon edit-icon",onClick:e=>e.stopPropagation(),content:(0,r.Y)(f.B,{pub:l,post:c,iconHeight:en,hidePinning:E,user:o,emailSent:ed,allowSendEmail:U})},ec&&{className:"post-date",title:(0,F.A)(c.post_date).toISOString(),content:(0,r.Y)(P.EY.Meta,{children:(0,r.Y)("time",{dateTime:(0,F.A)(c.post_date).toISOString(),children:(0,k.sq)({post:c,showDatetime:w,isStatic:q,fromPostPage:j,showReactions:es})})})},(null==ei?void 0:ei.community_enabled)&&c.slug&&es&&!c.is_draft&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,r.Y)(S.cy,{user:o,pub:l,post:c,token:I,onChange:e=>{null==L||L(e)},height:eo,isStatic:q,buttonStyle:ea,className:"post-meta-icon like-reaction-button",hideReactionCount:ea&&!q})},o&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,r.Y)(Q,{post:c,isPostFooter:ea,isStatic:q,lucideIconHeight:eo,onChange:L})},(null==ei?void 0:ei.community_enabled)&&c.slug&&el&&!c.is_draft&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,r.FD)("a",{className:ea?"post-meta-button button":"",href:i,native:ei&&(0,O.dVy)(document.location.pathname),onClick:J,children:[(0,r.Y)(b.A,{className:"comment-icon post-meta-icon",isStatic:q,height:eo,alt:"Comment",stroke:"#757575",fill:"transparent",strokeWidth:q?1:1.5,ampProps:{layout:"fixed"}}),!er&&ea&&(0,r.Y)("span",{className:"meta-button-label",children:"Comment"}),er>0&&(0,r.Y)("span",{className:"comment-count",children:(0,Z.numberToString)(er)})]})},A&&!ea&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,r.FD)("a",{href:x.T.RESTACK_URL,className:ea?"button post-meta-button":void 0,children:[(0,r.Y)(_.A,{className:"recommend-icon post-meta-icon",isStatic:q,height:eo,alt:"Recommend",stroke:"#757575",fill:"transparent",strokeWidth:q?1:1.5,ampProps:{layout:"fixed"}}),ea&&(0,r.Y)("span",{className:"meta-button-label",children:"Recommend"})]})},T&&"only_free"!==c.audience&&!c.is_draft&&!R&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,r.FD)(C._,{user:o,pub:ei,post:c,reaction_token:I,height:eo,onChange:L,isStatic:q,sharedShareDialog:z,position:"post-footer"===et?"post-footer":"post-header",linkClassName:ea?"button post-meta-button":void 0,children:[ea&&(0,r.Y)("span",{className:"meta-button-label",children:"Share"}),V&&(0,r.Y)("div",{className:"share-tooltip-wrap",children:(0,r.Y)("div",{className:"share-tooltip",children:V})})]})}]);return q?(0,r.Y)("table",{className:s()("post-meta custom",{big:ea},n),cellpadding:"0",cellspacing:"0",onClick:M,children:(0,r.Y)("tr",{children:eu.map(e=>{let{className:t,title:i,onClick:a,content:n}=e;return(0,r.Y)("td",{className:s()("post-meta-item",t),title:i,onClick:a,children:n})})})}):(0,r.Y)("div",{className:s()("post-meta post-meta-actions-web custom",{big:ea},n),onClick:M,children:eu.map(e=>{let{className:t,title:i,onClick:a,content:n}=e;return(0,r.Y)("div",{className:s()("post-meta-item",t),title:i,onClick:a,children:n})})})}function Q(e){let{post:t,isPostFooter:i,isStatic:a,lucideIconHeight:l,onChange:c}=e,{onSave:d,isSaved:u}=(0,k.Jj)({post:t,isSaved:t.is_saved});return(0,r.FD)("a",{className:s()("post-meta-save-button",i?"post-meta-button button":"",{isSaved:u}),href:a&&x.T.SAVE_POST_URL||void 0,onClick:()=>{let e=d();null==c||c({post:(0,o._)((0,n._)({},t),{is_saved:e})})},children:[(0,r.Y)(Y.A,{isStatic:a,height:l,stroke:"#757575",strokeWidth:a?1:1.5}),i&&(0,r.Y)("span",{className:"meta-button-label",children:"Save"})]})}},81295:function(e,t,i){i(99862),i(17402),i(68776),i(86500),i(94729)},70690:function(e,t,i){function a(e,t){return e.startsWith(t.replace(/\?.*$/,""))}function n(e,t){return e.replace(/\?.*$/,"")===t.replace(/\?.*$/,"")}i.d(t,{W:()=>a,y:()=>n})},59956:function(e,t,i){i.d(t,{LJ:()=>p});var a=i(4006),n=i(32485),o=i.n(n),r=i(80697),l=i(17402),s=i(17988);i(12165),i(9266),i(37767);var c=i(84605);i(81295),i(86500),i(68349);var d=i(35369);i(81203),i(39318);let u={desktop:15,mobile:6},p=e=>{let{className:t,hasFeatured:i,categories:n,categoryId:p,categoryIds:m,loadingCategoryId:h,ranking:g,onCategoryClicked:Y,defaultExpanded:b,expandedCategoryIds:_,onToggleCategory:v}=e,[y,f]=(0,l.useState)(b||!1),[C,k]=(0,l.useState)(new Set),S=u[(0,s.useMediaQuery)({query:"only screen and (max-width: 650px)"})?"mobile":"desktop"],{iString:w}=(0,c.GO)(),N=null!=_?_:C,B=n?y?n:n.slice(0,S):[],T=e=>e.id===p||(null==m?void 0:m.includes(e.id));return(0,a.FD)("div",{className:o()("categories",t),children:[i&&(0,a.Y)(d.$n,{priority:"featured"!==p||h&&"featured"!==h?"secondary":"primary-mono",loading:"featured"===h&&"featured"!==p,onClick:()=>{Y({categoryId:"featured",ranking:"all",categories:n})},children:w("Featured")}),B.map(e=>{var t;let i=N.has(e.id),o=e.subcategories&&e.subcategories.length>0,r=T(e)&&(!h||h===e.id),l=h===e.id&&p!==e.id;return(0,a.FD)(a.FK,{children:[(0,a.Y)(d.$n,{priority:r?"primary-mono":"secondary-outline",loading:l,onClick:()=>{var t;Y({categoryId:e.id,ranking:g,categories:n}),o&&(t=e.id,v?v(t):k(e=>{let i=new Set(e);return i.has(t)?i.delete(t):i.add(t),i}))},className:r?"test-active":"test-inactive",children:w(e.name||"")}),i&&o&&(null==e||null==(t=e.subcategories)?void 0:t.map(e=>{let t=T(e)&&(!h||h===e.id),i=h===e.id&&p!==e.id;return(0,a.Y)(d.$n,{priority:t?"primary-mono":"secondary",loading:i,onClick:()=>Y({categoryId:e.id,ranking:g,categories:n}),children:w(e.name)},e.id)}))]})}),n&&n.length>S&&!y&&(0,a.Y)(d.K0,{priority:"secondary-outline",onClick:()=>f(!0),children:(0,a.Y)(r.A,{size:20})})]})}}}]);