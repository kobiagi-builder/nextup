"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["56460"],{93038:function(e,t,n){n.d(t,{Ay:()=>f,_F:()=>g});var r=n(69277),i=n(70408),o=n(4006),a=n(32485),l=n.n(a),s=n(15734),c=n.n(s),u=n(27437),d=n(84777),m=n(95899),h=n(49807),p=n(3223);let f=e=>{let{id:t,type:n,name:r,url:i,photo_url:a,uuid:s,mentionText:c,isStatic:f=!1,isEditorContext:b=!1}=e;return f?(0,o.Y)("span",{className:l()(p.A.mention,p.A.mentionStatic),"data-component-name":"MentionStatic",children:(0,o.Y)("a",{href:(0,h.bzS)(n,t,r,i),children:r||"Substack user"})}):"user"===n?(0,o.Y)(m.HW,{children:(0,o.Y)(u.ProfileHoverCard,{subject:{id:t,name:r||"Substack user",photo_url:a},utmSource:"mention",trigger:(0,o.Y)("a",{className:p.A.mention,href:b?void 0:(0,h.bzS)(n,t,r,i),target:"_blank",rel:"noopener","data-attrs":JSON.stringify({name:r,id:t,type:n,url:i,photo_url:a,uuid:s}),onClick:e=>e.stopPropagation(),"data-component-name":"MentionUser",children:null!=c?c:r})})}):"pub"===n?(0,o.Y)(d.m,{pubId:t,utmSource:"mention",trigger:(0,o.Y)("a",{className:p.A.mention,href:i,target:"_blank",rel:"noopener","data-attrs":JSON.stringify({name:r,id:t,type:n,url:b?void 0:(0,h.bzS)(n,t,r,i),uuid:s}),onClick:e=>e.stopPropagation(),"data-component-name":"MentionPub",children:null!=c?c:r})}):(0,o.Y)("a",{className:p.A.mention,target:"_blank",rel:"noopener",href:(0,h.bzS)(n,t,r,i),"data-attrs":JSON.stringify({name:r,id:t,type:n,url:i,photo_url:a,uuid:s}),"data-component-name":"Mention",children:null!=c?c:r})},b={},g=async function(e){let{pathname:t="/api/v1/posts/mention"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(b[e])return b[e];let{profiles:n,publications:o}=(await c().get(t).query({query:e})).body,a=new Map;return n&&n.length&&a.set("Writers",n.map(e=>(0,i._)((0,r._)({},e),{type:"user"}))),o&&o.length&&a.set("Publications",null==o?void 0:o.map(e=>(0,i._)((0,r._)({},e),{type:"pub",url:(0,h.Bte)({subdomain:e.subdomain}),photo_url:e.logo_url}))),b[e]=a,a}},10398:function(e,t,n){n.d(t,{Hr:()=>I});var r=n(69277),i=n(70408),o=n(79785),a=n(4006),l=n(78649),s=n(84605),c=n(42686),u=n(89607),d=n(95282),m=n(81992),h=n(27332),p=n(25859),f=n(60897),b=n(99662),g=n(24078),y=n(76977),v=n(63136),Y=n(83629),_=n(83357),k=n(49095),S=n(49807),F=n(57324),w=n(44307);function C(){let e=(0,o._)(["This content is only visible to paid subscribers of ",""]);return C=function(){return e},e}function I(e){let{parent:t,comment:n,publication:r,readOnly:i,onAttachmentClick:o,utm_content:s,isDm:c,isPermalink:u,commentId:d}=e,m=(0,_.g)({onClick:()=>null==o?void 0:o({commentId:String(n.id)}),href:i?void 0:(0,S.Zgx)(n,{noBase:Y.Z}),state:{showBack:!0}});return(0,a.Y)(l.Q,{children:(0,a.Y)(D,{readOnly:i,linkProps:m,isEmbed:b.y,children:(0,a.Y)(T,{parent:t,comment:n,publication:r,readOnly:i,onAttachmentClick:o,utm_content:s,isDm:c,isPermalink:u,commentId:d})})})}function D(e){let{children:t,readOnly:n,linkProps:o,isEmbed:l}=e;return(0,a.Y)(y.I1,(0,i._)((0,r._)({as:n?"div":"a",bg:"primary",border:"detail",radius:"md",padding:12,gap:8,target:l()?"_blank":void 0,draggable:!1},o),{showFocus:!0,animate:!0,className:w.A.commentContainer,children:t}))}function T(e){var t,n,r,i;let{parent:o,comment:l,publication:s,readOnly:c,onAttachmentClick:u,utm_content:d,isDm:m,isPermalink:h,commentId:p}=e,{truncatedBodyJson:b}=(0,f.A)(l,{truncationProfile:"small"}),g=null!=(i=l.user)?i:l.user_id?{id:l.user_id,name:null!=(t=l.name)?t:"",photo_url:l.photo_url,bestseller_tier:null!=(n=l.user_bestseller_tier)?n:void 0,status:null!=(r=l.userStatus)?r:null}:null;return(0,a.FD)(a.FK,{children:[g&&(0,a.Y)(O,{commentUser:g,comment:l,readOnly:c,utm_content:d}),(0,a.Y)(A,{parent:o,comment:l,publication:s,truncatedBodyJson:b,isDm:m,onAttachmentClick:u,utm_content:d,readOnly:c,isPermalink:h,commentId:p})]})}function O(e){let{commentUser:t,comment:n,readOnly:r,utm_content:i}=e;return t?(0,a.FD)(y.pT,{gap:8,alignItems:"center",justifyContent:"start",children:[(0,a.Y)(_.N,{href:(0,S.gYq)(t,{noBase:Y.Z,utm_content:F.fL.substackFeedItem,utm_source:null!=i?i:void 0}),target:(0,b.y)()?"_blank":void 0,showBack:!0,radius:"full",showFocus:!0,animate:!0,children:(0,a.Y)(g.eu,{size:20,user:t})}),(0,a.Y)(v.EY.B4,{weight:"medium",color:"primary",children:r?t.name:(0,a.FD)(y.pT,{gap:8,direction:"row",justifyContent:"space-between",children:[(0,a.Y)(p.yp,{user:t,utm_source:F.VU.substackFeedItem,utm_content:i,children:t.name}),(null==t?void 0:t.bestseller_tier)!=null&&(0,a.Y)(k.UserStatusSymbols,{tier:t.bestseller_tier,userId:t.id,size:"xs"})]})}),(0,a.Y)(v.EY.B4,{as:"span",color:"secondary",children:(0,a.Y)(h.Iz,{timestamp:n.date,comment:n})})]}):null}function A(e){var t,n,r,i,o;let{parent:l,comment:c,publication:u,truncatedBodyJson:d,isDm:m,isPermalink:h,readOnly:p,onAttachmentClick:f,utm_content:b,commentId:g}=e,{iString:y,iTemplate:v}=(0,s.GO)(),Y=null!=(o=null==u?void 0:u.name)?o:y("this publication"),_=v(C(),Y),k=null==l||null==(t=l.attachments)?void 0:t.some(e=>"image"===e.type||"video"===e.type),S=null==(n=c.attachments)?void 0:n.some(e=>"image"===e.type||"video"===e.type),F=null==(r=c.attachments)?void 0:r.some(e=>"image"!==e.type&&"video"!==e.type&&"live_stream"!==e.type),w=null==(i=c.attachments)?void 0:i.some(e=>"post"===e.type&&(e.postSelection||e.postImageSelection));return k||S&&F||F&&!w?(0,a.Y)(B,{comment:c,truncatedBodyJson:d,hiddenText:_,onAttachmentClick:f,utm_content:b}):(0,a.Y)(P,{comment:c,truncatedBodyJson:d,hiddenText:_,onAttachmentClick:f,utm_content:b,readOnly:p,isDm:m,isPermalink:h,commentId:g})}function B(e){var t,n;let{comment:r,truncatedBodyJson:i,hiddenText:o,onAttachmentClick:l,utm_content:s}=e;return(0,a.Y)(a.FK,{children:(0,a.FD)(y.pT,{gap:8,direction:"row",flex:"grow",justifyContent:"space-between",children:[(0,a.FD)(y.I1,{gap:4,children:[(0,a.Y)(u.T,{content:i,isHidden:r.hidden,hiddenText:o,attachedLinks:(0,d.MT)(r)}),(0,a.Y)(m.ot,{attachments:null!=(t=r.attachments)?t:[],onAttachmentClick:l,utm_content:s})]}),(0,a.Y)(c.Yw,{attachments:null!=(n=r.attachments)?n:[]})]})})}function P(e){var t;let{comment:n,truncatedBodyJson:r,hiddenText:i,onAttachmentClick:o,utm_content:l,readOnly:s,isDm:m,isPermalink:h,commentId:p}=e;return(0,a.FD)(a.FK,{children:[(0,a.Y)(u.T,{content:r,isHidden:n.hidden,hiddenText:i,attachedLinks:(0,d.MT)(n)}),(0,a.Y)(c.ti,{attachments:null!=(t=n.attachments)?t:[],onAttachmentClick:o,utm_content:l,isRestack:!0,readOnly:s,isDm:m,isPermalink:h,commentId:p})]})}},44333:function(e,t,n){n.d(t,{rd:()=>a,wN:()=>o});var r=n(99862),i=n(17402);function o(e,t){(0,i.useEffect)(()=>{let t=t=>{e(t)};return r.subscribers.push(t),()=>{r.subscribers.splice(r.subscribers.indexOf(t)>>>0,1)}},t)}function a(){let{path:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,i.useState)({}),a=(0,i.useRef)(null);o(e=>{a.current=e,n({})},[]);let l=a.current||(0,r.getCurrentUrl)(),s=l.replace(/\?.+$/,""),c=document.location.hash;return a.current=null,[{url:l,path:s,matches:e&&(0,r.exec)(s,e,{})||null,hash:c},r.route]}n(88377)},19832:function(e,t,n){n.d(t,{m:()=>o});var r=n(4006),i=n(16993);let o=e=>{let{isOpen:t=!1,title:n,description:o,icon:a,onClose:l,primaryButton:s,secondaryButton:c}=e;return(0,r.FD)(i.aF,{isOpen:t,onClose:l,children:[n&&(0,r.Y)(i.rQ,{title:n,description:o,showClose:!1,icon:a}),(0,r.Y)(i.q1,{}),(0,r.Y)(i.jl,{primaryButton:s,secondaryButton:c})]})}},89955:function(e,t,n){n.d(t,{O:()=>a});var r=n(4006),i=n(68349),o=n(20500);function a(e){let{error:t}=e,n=(0,i.zs)(t);return(null==n?void 0:n.html)?(0,r.Y)(o.yn,{dangerouslySetInnerHTML:{__html:n.html}}):(0,r.Y)(o.yn,{children:(null==n?void 0:n.msg)||"Something went wrong"})}},62088:function(e,t,n){n.d(t,{$P:()=>v,M9:()=>g,dt:()=>Y});var r=n(69277),i=n(70408),o=n(4006),a=n(84605),l=n(80103),s=n(17028),c=n(16993),u=n(84843),d=n(50630),m=n(83842),h=n(23358),p=n(82804),f=n(23191),b=n(11510);function g(e){let{onCancel:t,onSuccess:n,onSignup:r,onUserCreated:i,noCloseButton:a,noExit:s,isOpen:u,redirectOverride:m,overrideTitle:h}=e,p=(0,b.Iu)();return(0,o.Y)(c.aF,{onClose:t,isOpen:u,children:(0,o.FD)(d.W,{children:[(0,o.Y)(y,{onCancel:t,onSuccess:n,onSignup:r,onUserCreated:i,noCloseButton:a,noExit:s,redirectOverride:m,overrideTitle:h}),p&&(0,o.Y)(l.a7,{})]})})}function y(e){let{onCancel:t,onSuccess:n,onSignup:a,onUserCreated:l,noCloseButton:s,noExit:c,redirectOverride:u,overrideTitle:b}=e,{mode:g}=(0,d.r)(),y={overrideTitle:b,noCloseButton:s||c,onCancel:t,onSignup:a};return(0,o.FD)(o.FK,{children:["magic-link"===g&&(0,o.Y)(m.j,(0,i._)((0,r._)({},y),{onSuccess:n})),"email"===g&&(0,o.Y)(h._,(0,i._)((0,r._)({},y),{onUserCreated:l,redirectOverride:u})),"password"===g&&(0,o.Y)(f.d,(0,i._)((0,r._)({},y),{onSuccess:n})),"mfa"===g&&(0,o.Y)(p.Q,{onSuccess:n})]})}let v=e=>{let{overrideTitle:t,noCloseButton:n,onCancel:r,onSignup:i}=e,{iString:l}=(0,a.GO)();return(0,o.Y)(u.rQ,{title:t||l("Sign in to Substack"),description:i?(0,o.FD)(o.FK,{children:[l("First time here? "),(0,o.Y)(s.Yq,{color:"substack",decoration:"hover-underline",onClick:i,cursor:"pointer",children:l("Create account")})]}):void 0,showClose:!n,onClose:r,icon:(0,o.Y)(u.Ud,{}),alignItems:"center"})},Y=e=>{let{children:t}=e;return(0,o.Y)(s.VP,{padding:16,borderTop:"detail",children:(0,o.Y)(s.EY.B4,{as:"span",color:"secondary",align:"center",children:t})})}},46647:function(e,t,n){n.d(t,{D:()=>d});var r=n(4006),i=n(84605),o=n(17028),a=n(16291);let l=new Intl.DateTimeFormat(void 0,{timeStyle:"short"}),s=new Intl.DateTimeFormat(void 0,{weekday:"long"}),c=new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric"}),u=new Intl.DateTimeFormat(void 0,{dateStyle:"long"});function d(e){let{timestamp:t,conjunction:n=!1}=e,{iString:d,language:m}=(0,i.GO)(),h=new Date(t),p=(0,a.A)(),f=m.startsWith("en"),b=p.isSame(h,"day")?d("Today"):p.subtract(1,"day").isSame(h,"day")?d("Yesterday"):p.isSame(h,"week")?s.format(h):p.isSame(h,"year")?c.format(h):u.format(h);return(0,r.Y)(o.fI,{alignItems:"center",justifyContent:"center",children:(0,r.FD)(o.EY.B4,{color:"secondary",children:[b,n&&f?" at ":" ",l.format(h)]})})}},87782:function(e,t,n){n(4006),n(76977),n(63136),n(35407)},69089:function(e,t,n){n.d(t,{e:()=>c});var r=n(69277),i=n(32641),o=n(4006),a=n(26683),l=n(17028),s=n(3898);function c(e){var{children:t,setReactions:n=!0,alignSelf:l}=e,s=(0,i._)(e,["children","setReactions","alignSelf"]);return n?(0,o.FD)(u,{position:"relative",alignSelf:l,children:[t,(0,o.Y)(a.LI,(0,r._)({},s))]}):(0,o.Y)(o.FK,{children:t})}let u=(0,l.yw)({display:"flex",className:s.A.reactionsHoverZone})},80351:function(e,t,n){n(94729)},85050:function(e,t,n){n.d(t,{s:()=>s});var r=n(17402),i=n(52820),o=n(46271),a=n(86500),l=n(46453);function s(e){let{surface:t,zIndex:n=null}=e,s=(0,o.Jd)(),{onboardingModalRef:c,onboardingModal:u}=(0,l.eE)(),{getExperimentVariant:d,exposeExperiment:m}=(0,i.Wk)();return(0,r.useEffect)(()=>{c.current&&null!==n&&(c.current.props.zIndex=n)},[c,n]),(e,n)=>r=>{if(!e)return void console.warn("No publication provided to usePubOnboardingHandler handler");if(!s){let t="treatment"===d("reader_onboarding_modal_v2")?u:c.current;if(!t)return;r.preventDefault(),m("reader_onboarding_modal_v2"),n?t.openForPub(e,n):t.openToPubSignup(e);return}(0,a.fN)(e,t)}}},53457:function(e,t,n){n(76528)}}]);