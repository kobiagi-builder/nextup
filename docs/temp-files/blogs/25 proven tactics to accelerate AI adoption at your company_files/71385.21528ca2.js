(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["71385"],{7642:function(e,t,n){"use strict";n.d(t,{A:()=>r});let r={popover:"popover-Q5L48i",visible:"visible-w2GbD1",mounted:"mounted-xAyTLJ",disabled:"disabled-qyVgYn",explainer:"explainer-FXmc_P",dismissExplainer:"dismissExplainer-ns56FG",mobileFooter:"mobileFooter-CGz8PV",button:"button-r00Nrm"}},91086:function(e,t,n){"use strict";n.d(t,{A:()=>r});let r={transcriptionStatus:"transcriptionStatus-OyxRN5",transcriptionChunk:"transcriptionChunk-DKBYAw",hoverChunk:"hoverChunk-IPtOLw",rowIndicator:"rowIndicator-jiY8sp",hoverRow:"hoverRow-zMw3pV",activeRow:"activeRow-S2HzS9",rowText:"rowText-T4jYBi",speakerText:"speakerText-lh6QvQ",rowEditableText:"rowEditableText-PLHmec",activeWord:"activeWord-J6YmxG",playCircle:"playCircle-Ech_eu"}},73683:function(e,t,n){"use strict";n.d(t,{A:()=>r});let r={subscribeButton:"subscribeButton-LcKYi7"}},96063:function(e,t,n){"use strict";n.d(t,{A:()=>r});let r={"byline-wrapper":"byline-wrapper-rwhTzJ",bylineWrapper:"byline-wrapper-rwhTzJ",bottomWithTos:"bottomWithTos-g5MwKO","byline-wrapper--swap-on-mobile":"byline-wrapper--swap-on-mobile-Cs2Jac",bylineWrapperSwapOnMobile:"byline-wrapper--swap-on-mobile-Cs2Jac","byline-faces--swap-on-mobile":"byline-faces--swap-on-mobile-ucRXf3",bylineFacesSwapOnMobile:"byline-faces--swap-on-mobile-ucRXf3",subscribeWidget:"subscribeWidget-sIP7pQ",title:"title-X77sOw",subtitle:"subtitle-HEEcLo"}},74213:function(e,t,n){"use strict";n.d(t,{A:()=>r});let r={postUFI:"postUFI-Oh86n4",postUfi:"postUFI-Oh86n4",hasVoiceover:"hasVoiceover-rbvr3u",editButtonContainer:"editButtonContainer-hWwvUO"}},67754:function(e,t,n){"use strict";n.d(t,{A:()=>r});let r={inputWithIcons:"inputWithIcons-vs0rlV",error:"error-nMG79e",inputWrapper:"inputWrapper-Wvkzvn",icon:"icon-wnhO6c"}},3526:function(e,t,n){"use strict";n.d(t,{D:()=>S});var r=n(79785),i=n(4006),a=n(32485),l=n.n(a),o=n(17402),s=n(33764),c=n(84605),d=n(86500),u=n(58418),p=n(35369),h=n(76977),m=n(16993),g=n(63136),b=n(39318),f=n(50963),Y=n(57324);let _="ig_modal_logo-jNPKzo",v="logo_substack-xHlM5o";function y(){let e=(0,r._)(["Follow "," in the app"]);return y=function(){return e},e}function w(){let e=(0,r._)(["Get the Substack app to follow ","'s reading and writing."]);return w=function(){return e},e}let S=e=>{let{pub:t,slug:n,action:r,platform:a}=e,{iString:S,iTemplate:k}=(0,c.GO)(),[C,F]=(0,u.A)("".concat(a,"_webview_app_upsell"),259200),[I,E]=(0,o.useState)(!C);(0,o.useEffect)(()=>{I&&(0,d.u4)(d.qY.APP_FOOTER_SHEET_CTA_VIEWED,{surface:"post",type:"webview-sheet",platform:a})},[]);let D=(0,b.XV8)(t.subdomain,n,{redirect:"app-store",source:Y.VU.postFooter}),A="read"===r?t.logo_url:t.author_photo_url||t.logo_url;return(0,i.Y)(m.aF,{isOpen:I,onClose:()=>{E(!1)},children:(0,i.Y)(m.cw,{children:(0,i.FD)(h.I1,{gap:32,alignItems:"center",paddingY:40,paddingX:24,children:[(0,i.Y)(h.Ye,{alignItems:"center",justifyContent:"center",style:{position:"relative"},children:A?(0,i.FD)(i.FK,{children:[(0,i.Y)(h.pT,{justifyContent:"center",alignItems:"center",className:l()(_,v,"logo_left-HHdifs"),children:(0,i.Y)(s.o,{src:"/img/substack-white.svg",imageIsFixedWidth:!0,useRetinaSizing:!0,maxWidth:44})}),(0,i.Y)(h.pT,{justifyContent:"center",alignItems:"center",className:l()(_,"logo_right-_og3lw"),children:(0,i.Y)(s.o,{className:"ig_image_border-FuLDjr",src:A,imageIsFixedWidth:!0,useRetinaSizing:!0,maxWidth:56})})]}):(0,i.Y)(h.pT,{justifyContent:"center",alignItems:"center",className:l()(_,v),children:(0,i.Y)(s.o,{src:"/img/substack-white.svg",imageIsFixedWidth:!0,useRetinaSizing:!0,maxWidth:44})})}),(0,i.FD)(h.I1,{gap:8,alignItems:"center",children:[(0,i.Y)(g.EY.B1,{align:"center",weight:"semibold",children:"read"===r?S("Read in the Substack app"):k(y(),t.author_name)}),(0,i.Y)(g.EY.B4,{align:"center",fontSize:14,color:"secondary",children:"read"===r?S("Get the Substack app for the best reading experience on the go."):k(w(),(0,f.$k)(t.author_name))})]}),(0,i.FD)(h.I1,{gap:16,paddingX:16,alignItems:"center",className:"ig_modal_button_container-wKHKdO",children:[(0,i.Y)(p.$n,{priority:"primary",onClick:()=>{(0,d.u4)(d.qY.APP_BANNER_TAPPED,{surface:"post",type:"webview-sheet",platform:a})},href:D,children:S("Open in app")}),(0,i.Y)(p.$n,{priority:"tertiary",onClick:()=>{(0,d.u4)(d.qY.APP_FOOTER_SHEET_CTA_DISMISSED,{surface:"post",type:"webview-sheet",platform:a}),F(),E(!1)},children:S("Maybe later")})]})]})})})}},70997:function(e,t,n){"use strict";n.d(t,{p:()=>h});var r=n(4006),i=n(87677),a=n(17402),l=n(94794),o=n(86500),s=n(16074),c=n(76977),d=n(63136),u=n(18947),p=n(57324);let h=e=>{let{user:t,isMobile:n,post:h}=e,m=(0,l.aZ)(),g=(null==t?void 0:t.is_contributor)&&!m,b=!n||!g;return((0,a.useEffect)(()=>{b||(0,o.u4)(o.qY.POST_STATS_IN_APP_UPSELL_SEEN,{post_id:h.id,source:"mobile_post_page"})}),b)?null:(0,r.FD)(c.VP,{children:[(0,r.Y)(s.c,{}),(0,r.FD)(c.fI,{className:"statsLink-zUlL_7",alignItems:"center",justifyContent:"space-between",children:[(0,r.Y)(d.EY.B3,{paddingY:16,as:"a",weight:"semibold",translated:!0,href:(0,u.MG)({postId:h.id,params:{utm_source:p.VU.substack,utm_medium:p.Jn.web,utm_campaign:p._9.postStatsUpsellMobilePostPage,redirect:"app-store"}}),onClick:()=>(0,o.u4)(o.qY.POST_STATS_IN_APP_UPSELL_CLICKED,{post_id:h.id,source:"mobile_post_page"}),children:"View stats in the app"}),(0,r.Y)(i.A,{})]}),(0,r.Y)(s.c,{})]})}},76219:function(e,t,n){"use strict";n.d(t,{u:()=>a});var r=n(4006),i=n(63136);function a(e){let{doiUrl:t,pdfUrl:n}=e;return t&&n?(0,r.FD)(i.EY,{as:"p",children:["Cite as:"," ",(0,r.Y)("a",{href:t,target:"_blank",children:t})," ","â€¢"," ",(0,r.Y)("a",{href:n,target:"_blank",children:"PDF"})]}):null}},71328:function(e,t,n){"use strict";n.d(t,{k:()=>p});var r=n(69277),i=n(70408),a=n(4006),l=n(60927),o=n(93038),s=n(76977),c=n(63136),d=n(49807);let u={blurb:"blurb-PNfDEK"};function p(e){let{crossPostInfo:{introText:t,crossPostedPub:n,crossPostingByLine:r},postType:i}=e;return(0,a.Y)(s.VP,{paddingTop:8,paddingBottom:24*("podcast"!==i),children:(0,a.FD)(s.VP,{paddingX:20,padding:8,className:u.blurb,gap:12,children:[(0,a.Y)(h,{crossPostedPub:n}),(0,a.Y)(m,{introText:t}),(0,a.Y)(g,{byline:r})]})})}function h(e){let{crossPostedPub:t}=e;return(0,a.FD)(s.fI,{className:u.attribution,gap:8,alignItems:"center",children:[(0,a.Y)(l.A,{stroke:"var(--color-accent)",size:16}),(0,a.FD)(c.EY.Meta,{translated:!0,color:"accent",children:["Cross-posted by ",(0,a.Y)(c.Yq,{href:(0,d.$_T)(t),children:I18N.p(t.name)})]})]})}function m(e){let{introText:t}=e;return t?(0,a.Y)(c.EY.B2,{fontStyle:"italic",children:'"'.concat(t,'"')}):null}function g(e){let{byline:t}=e,n=null==t?void 0:t[0];return n?(0,a.FD)(c.EY.B2,{color:"accent",children:["- ",(0,a.Y)(o.Ay,(0,i._)((0,r._)({},n),{type:"user",uuid:""}))]}):null}},70345:function(e,t,n){"use strict";n.d(t,{y$:()=>L});var r=n(69277),i=n(70408),a=n(79785),l=n(4006),o=n(17402),s=n(47963),c=n(85048),d=n(58050),u=n(84605),p=n(46271),h=n(86500),m=n(94729),g=n(17186),b=n(68349),f=n(24078),Y=n(35369),_=n(76977),v=n(16993),y=n(63136),w=n(65842),S=n(36372),k=n(11510),C=n(16291),F=n(39318),I=n(41086),E=n(50963),D=n(57324);let A={is_www:!0,is_personal_mode:!1,id:0,name:"Substack",subdomain:"www",copyright:"Substack Inc.",mailing_address:"548 Market Street PMB 72296\nSan Francisco, CA 94104",email_from:"no-reply@substack.com",email_from_name:"Substack",logo_url:"/img/substack.png?v=3",language:"en",theme:void 0,theme_var_color_links:void 0,theme_var_background_pop:void 0,theme_var_cover_bg_color:void 0,custom_domain:void 0,type:void 0};function x(){let e=(0,a._)(["Already following ",""]);return x=function(){return e},e}function N(){let e=(0,a._)(["",", a paid subscriber of ",", shared this with you."]);return N=function(){return e},e}function T(){let e=(0,a._)(["",", a subscriber of ",", shared this with you."]);return T=function(){return e},e}function P(){let e=(0,a._)([""," shared this with you."]);return P=function(){return e},e}function O(){let e=(0,a._)(["Follow "," and continue reading"]);return O=function(){return e},e}function B(){let e=(0,a._)(["Sign up and follow ",""]);return B=function(){return e},e}let L=e=>{let{pub:t,post:n,referringUser:a,freeSignupEmail:s,forceFollowPrompt:c,surface:f}=e,[Y,y]=(0,o.useState)(!1),[w,k]=(0,o.useState)(!1),[D,A]=(0,o.useState)(0),[N,T]=(0,o.useState)(s),[P,O]=(0,o.useState)(!1),{iString:B,iTemplate:L}=(0,u.GO)(),U=(0,S.d)(),V=(0,p.Jd)(),j=!!V||!!s,W=(0,d.cC)(a,null!=f?f:"follow-referrer-prompt",void 0,{auto:j}),z=(0,o.useMemo)(()=>({free_signup_email:s,post_id:null==n?void 0:n.id,referring_user_id:a.id}),[s,null==n?void 0:n.id,a.id]);(0,o.useEffect)(()=>{if(j&&!W.isLoaded||W.isFollowing){c&&W.isFollowing&&U.popToast(()=>(0,l.Y)(S.y,{text:L(x(),(0,E.$k)(a.name))}));return}try{let e=new URL(document.referrer);if(/(\b|\.)google\./.test(e.hostname)||["news.ycombinator.com","hckrnews.com"].includes(e.hostname))return}catch(e){}if(V&&(0,I.y)("follow-referrer-on-load")){(0,b.qm)("follow-referrer-on-load"),(0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_REDIRECTED,z),G({fromRedirect:!0}).then(()=>y(!0));return}let e="follow-prompt-for-post-".concat(null==n?void 0:n.id,"-and-referrer-").concat(a.id,"-shown-at"),t=(0,g.xm)(e);!c&&t&&(0,C.A)().subtract(7,"days").isBefore(t)||((0,g.X3)(e,Date.now()),y(!0),(0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_SHOWN,z))},[V,W.isLoaded]);let K=(0,o.useCallback)(()=>{(0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_DISMISSED,(0,i._)((0,r._)({},z),{step:D})),y(!1)},[z,y,D]),J=(0,o.useCallback)(function(){let{email:e,reason:n="sign-in-click"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_SIGN_IN_INITIATED,(0,i._)((0,r._)({},z),{reason:n}));let l=(0,F.oRR)({"follow-referrer-on-load":a.id});(0,b.V2)((0,F.a7q)({email:e,for_pub:null==t?void 0:t.subdomain,redirect:l}))},[z,null==t?void 0:t.subdomain,a.id]),q=(0,o.useCallback)(async function(){let e,t,n,{email:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{({user:e,userExists:t}=await (0,m.x6)("/api/v1/reader/signup/just_email",{method:"POST",json:{email:a}}))}catch(e){e instanceof m.fk&&(n=e.getMessage())}return e?(T(a),0):t?((0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_EXISTING_EMAIL_ENTERED,(0,i._)((0,r._)({},z),{email:a})),T(a),2):((0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_SIGNUP_FAILED,(0,i._)((0,r._)({},z),{email:a,error:n})),U.popToast(()=>(0,l.Y)(S.y,{text:n||B("Something went wrong. Please try again later.")})),1)},[z,U,B]),G=(0,o.useCallback)(async function(){let e,{email:t,fromRedirect:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!w){if(k(!0),n||(0,h.u4)(h.qY.FOLLOW_REFERRER_PROMPT_CTA_CLICKED,(0,i._)((0,r._)({},z),{email:t})),!j){if(!t){A(1),k(!1);return}if(1===(e=await q({email:t})))return void k(!1)}W.isFollowing||void 0!==e&&0!==e||(await W.toggle(),O(!0)),!V||n?A(2):y(!1),k(!1)}},[V,j,W,z,w,k,A,q]);return(0,l.Y)(v.aF,{fullscreenMobile:0!==D,isOpen:Y,onClose:K,children:(0,l.FD)(_.I1,{style:{height:"100%"},children:[(0,l.Y)(v.rQ,{showClose:!0,onClose:K}),(0,l.FD)(_.I1,{flex:"grow",gap:48,paddingX:32,paddingBottom:32,paddingTop:12,children:[0===D&&(0,l.Y)(R,{pub:t,referringUser:a,loading:w,onFollowClick:G,onDismiss:K}),1===D&&(0,l.Y)(M,{referringUser:a,loading:w,onFollowWithEmail:G,onSignInClick:J}),2===D&&(0,l.Y)(H,{email:N,referringUser:a,followed:P,onDismiss:K})]})]})})},R=e=>{var t,n,r,i,a;let o,{pub:s,referringUser:c,loading:d,onFollowClick:p,onDismiss:h}=e,{iTemplate:m,iString:g}=(0,u.GO)(),b=null!=(a=null!=(i=null!=(r=c.photo_url)?r:null==s?void 0:s.logo_url)?i:null==s?void 0:s.author_photo_url)?a:(0,F.Ji1)(c.id),v=(0,E.$k)(c.name),w=null==(n=c.subscriptions)||null==(t=n.find(e=>e.publication_id==(null==s?void 0:s.id)))?void 0:t.membership_state;return o=s&&"subscribed"===w?m(N(),c.name,s.name):s&&"free_signup"===w?m(T(),c.name,s.name):m(P(),c.name),(0,l.FD)(_.I1,{alignItems:"center",gap:8,children:[(0,l.FD)(_.I1,{alignItems:"center",gap:16,paddingBottom:16,children:[(0,l.Y)("div",{className:"avatarContainer-Bvvbb6",children:(0,l.Y)(f.eu,{className:"avatar-Gt1fvo",user:{photo_url:b},size:64})}),(0,l.Y)(y.EY.H3,{align:"center",weight:"heavy",children:o})]}),(0,l.Y)(Y.$n,{priority:"primary",disabled:d,onClick:p,children:m(O(),v)}),(0,l.Y)(Y.$n,{priority:"secondary",onClick:h,children:g("Skip")})]})},M=e=>{let{referringUser:t,loading:n,onFollowWithEmail:r,onSignInClick:i}=e,[a,s]=(0,o.useState)(""),{iTemplate:d}=(0,u.GO)(),p=(0,o.useRef)(null);(0,o.useEffect)(()=>{var e;null==(e=p.current)||e.focus()},[]);let h=(0,o.useCallback)(e=>{e.preventDefault(),""!==a&&r({email:a})},[r,a]),m=(0,E.$k)(t.name);return(0,l.FD)(l.FK,{children:[(0,l.FD)(_.I1,{alignItems:"center",gap:8,children:[(0,l.FD)(y.EY.H3,{translated:!0,align:"center",weight:"heavy",children:["Sign up to follow ",I18N.p(m)]}),(0,l.Y)(y.EY.B4,{translated:!0,align:"center",color:"secondary",children:"Discover great writing and follow your friends on Substack"})]}),(0,l.FD)(_.I1,{gap:12,children:[(0,l.Y)(y.EY.B4,{translated:!0,weight:"semibold",children:"Your email address"}),(0,l.Y)("form",{onSubmit:h,children:(0,l.Y)(w.ks,{ref:p,placeholder:"bob@gmail.com",value:a,onChange:e=>s(e.currentTarget.value)})})]}),(0,l.FD)(_.I1,{alignItems:"center",gap:16,justifyContent:"center",children:[(0,l.Y)(Y.$n,{disabled:n||""===a,onClick:h,children:d(B(),m)}),(0,l.FD)(y.EY.B4,{translated:!0,align:"center",color:"secondary",children:["Already have a Substack account?"," ",(0,l.Y)(y.EY.B4,{translated:!0,color:"secondary",decoration:"underline",as:"a",href:"#",onClick:i,children:"Sign in"})]})]}),(0,l.Y)(_.I1,{flex:"grow",justifyContent:"end",children:(0,l.Y)(y.EY.B4,{align:"center",children:(0,l.Y)(c.qd,{className:"termsFooter-KerNk3",publication:A})})})]})},H=e=>{let{onDismiss:t,email:n,referringUser:a,followed:o}=e,{iString:c}=(0,u.GO)(),d=(0,k.Iu)(),p={utm_medium:D.Jn.web,utm_campaign:D._9.postFollowReferrerPrompt,utm_source:D.VU.post};return(0,l.FD)(l.FK,{children:[o?(0,l.FD)(_.I1,{alignItems:"center",gap:4,children:[(0,l.Y)(y.EY.H3,{translated:!0,align:"center",weight:"heavy",children:"Read and follow in the app"}),(0,l.FD)(y.EY.B4,{translated:!0,align:"center",color:"secondary",children:["See who else ",I18N.p((0,E.$k)(a.name))," reads in the Substack app"]})]}):(0,l.FD)(_.I1,{alignItems:"center",gap:4,children:[(0,l.FD)(y.EY.H3,{translated:!0,align:"center",weight:"heavy",children:["Finish following ",I18N.p((0,E.$k)(a.name))," in the app"]}),(0,l.FD)(y.EY.B4,{translated:!0,align:"center",color:"secondary",children:["See who else ",I18N.p((0,E.$k)(a.name))," reads on Substack"]})]}),d?(0,l.FD)(l.FK,{children:[(0,l.Y)(_.Ye,{alignSelf:"center",children:(0,l.Y)("img",{src:(0,F.dJ9)("/img/app-preview-card.png"),height:265})}),(0,l.Y)(_.Ye,{flex:"grow",children:(0,l.FD)(_.I1,{alignItems:"center",flex:"grow",gap:8,children:[(0,l.Y)(Y.$n,{href:(0,F.wHz)(p),children:c("Get the Substack app")}),(0,l.Y)(Y.$n,{priority:"tertiary",onClick:t,children:c("Skip")})]})})]}):(0,l.FD)(_.I1,{alignItems:"center",gap:24,children:[(0,l.Y)("div",{style:{minHeight:231},children:(0,l.Y)(s.gF,(0,i._)((0,r._)({},p),{suggestedEmail:n,size:180,padding:0}))}),(0,l.Y)(Y.$n,{priority:"secondary",onClick:t,children:c("Continue reading")})]})]})}},47789:function(e,t,n){"use strict";n.d(t,{I:()=>i});var r=n(41935);function i(e){let{post:t,user:n,onChange:i,reaction_token:a,children:l}=e,{toggle:o}=(0,r.Ph)({post:t,user:n,surface:"reader",onChange:i?e=>{let{post:t}=e;return i({post:t})}:void 0,postReactionToken:a});return l(async()=>{await o()})}},84664:function(e,t,n){"use strict";n.d(t,{C:()=>m});var r=n(69277),i=n(32641),a=n(4006),l=n(70408),o=n(97731);let s=e=>{var{stroke:t="black",height:n=19,width:s=19}=e,c=(0,i._)(e,["stroke","height","width"]);return(0,a.FD)(o.A,(0,l._)((0,r._)({},c),{name:"AdhocEmailIcon",svgParams:{height:n,width:s,viewBox:"0 0 19 19"},children:[(0,a.Y)("path",{d:"M3 4C3 3.72386 3.22386 3.5 3.5 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4V12.5C13.5 12.7761 13.2761 13 13 13H3.5C3.22386 13 3 12.7761 3 12.5V4Z",stroke:t}),(0,a.Y)("path",{d:"M3.5 4L8.25 9.02499L13 4",stroke:t,strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M5 13.5V15C5 15.2761 5.22386 15.5 5.5 15.5H15.3151C15.5913 15.5 15.8151 15.2761 15.8151 15V7C15.8151 6.72386 15.5913 6.5 15.3151 6.5H14",stroke:t})]}))};var c=n(14394);let d=e=>{var{stroke:t="black",height:n=19,width:s=19}=e,c=(0,i._)(e,["stroke","height","width"]);return(0,a.FD)(o.A,(0,l._)((0,r._)({},c),{name:"NewsletterIcon",svgParams:{height:n,width:s,viewBox:"0 0 19 19"},children:[(0,a.Y)("path",{d:"M3.5 3.5H15.5",stroke:t,strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M3.5 7.5H15.5",stroke:t,strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M3.5 11.5H15.5",stroke:t,strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M3.5 15.5H12",stroke:t,strokeLinecap:"round","stroke-linejoin":"round"})]}))},u=e=>(0,a.FD)(o.A,(0,l._)((0,r._)({},e),{name:"PodcastIcon",svgParams:{height:19,width:19},children:[(0,a.Y)("path",{d:"M10.1505 3H8.61291C6.06527 3 4 4.9401 4 7.33333V10","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M8.89246 3H10.4301C12.9778 3 15.043 4.9401 15.043 7.33333V10.5","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M3 12.1429V13.3571C3 14.5406 3.81359 15.5 4.81721 15.5H6.42473V10H4.81721C3.81359 10 3 10.9594 3 12.1429Z","stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M16 12.1429V13.3571C16 14.5406 15.1864 15.5 14.1828 15.5H12.5753V10H14.1828C15.1864 10 16 10.9594 16 12.1429Z","stroke-linejoin":"round"})]}));var p=n(15052);let h=e=>{var{stroke:t="black",height:n=19,width:s=19}=e,c=(0,i._)(e,["stroke","height","width"]);return(0,a.Y)(o.A,(0,l._)((0,r._)({},c),{name:"VideoIcon",svgParams:{height:n,width:s,viewBox:"2 2 15 15"},children:(0,a.FD)("g",{fill:"transparent",children:[(0,a.Y)("path",{d:"M15.5 15H3.5V4H15.5V15Z",stroke:t,"stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M11.5 11L8.5 9V12.5L11.5 11Z",stroke:t,"stroke-linejoin":"round"}),(0,a.Y)("path",{d:"M4 7H15",stroke:t}),(0,a.Y)("path",{d:"M4.5 4L7.5 7",stroke:t}),(0,a.Y)("path",{d:"M8 4L11 7",stroke:t}),(0,a.Y)("path",{d:"M11.5 4L14.5 7",stroke:t})]})}))},m=e=>{var{postType:t}=e,n=(0,i._)(e,["postType"]);switch(t){case"newsletter":return(0,a.Y)(d,(0,r._)({},n));case"adhoc_email":return(0,a.Y)(s,(0,r._)({},n));case"thread":return(0,a.Y)(p.A,(0,r._)({},n));case"podcast":return(0,a.Y)(u,(0,r._)({},n));case"video":return(0,a.Y)(h,(0,r._)({},n));case"restack":return(0,a.Y)(c.A,(0,r._)({},n));default:return console.warn("Unrecognized post type: [".concat(t,"]")),null}}},3338:function(e,t,n){"use strict";n.d(t,{V:()=>S});var r=n(4006),i=n(81143),a=n(17402),l=n(15734),o=n.n(l),s=n(47963),c=n(84605),d=n(43294),u=n(86500),p=n(94729),h=n(24078),m=n(35369),g=n(16074),b=n(76977),f=n(16993),Y=n(63136),_=n(65842),v=n(11510),y=n(39318),w=n(57324);let S=e=>{let{post:t,pub:n,freeSignupEmail:l,user:d,magicToken:h,onClose:Y,onSubscriptionComplete:_,onUnlockFailed:S,hasCompletedUnlock:F=!1}=e,[I,E]=(0,a.useState)(!0),[D,A]=(0,a.useState)(!1),[x,N]=(0,a.useState)(!d&&!F),[T,P]=(0,a.useState)(F),[O,B]=(0,a.useState)((null==d?void 0:d.email)||l||""),[L,R]=(0,a.useState)(!1),[M,H]=(0,a.useState)(!1),[U,V]=(0,a.useState)(!1),{iString:j}=(0,c.GO)(),W=(0,v.Iu)();(0,a.useEffect)(()=>{(0,u.u4)(u.qY.UNSUBSCRIBED_POST_UNLOCK_MODAL_VIEWED,{post_id:t.id})},[t.id]);let z=()=>{(0,u.u4)(u.qY.UNSUBSCRIBED_POST_UNLOCK_MODAL_DISMISSED,{post_id:t.id,has_reached_max_tokens:L}),E(!1),null==Y||Y()},K=(0,y.XV8)(n.subdomain,t.slug,{params:{utm_campaign:w._9.postUnlockUnsubscribedModal,utm_source:w.VU.post},redirect:"app-store"}),J=async e=>{if((0,u.u4)(u.qY.PAYWALL_UNLOCK_CTA_CLICKED,{post_id:t.id,has_email:!!e||!!(null==d?void 0:d.email),source:"unsubscribed_post_unlock_modal"}),!d&&!e)return void N(!0);let n=e||(null==d?void 0:d.email)||"";if(!n||!n.trim())return void N(!0);B(n),A(!0);try{await o().post("/api/v1/free").send({email:n,source:"post_unlock_upsell"});try{await o().post("/api/v1/post_unlock_token").send({post_id:t.id,token:h,email:n})}catch(n){var r,i,a,l;let e=(null==n||null==(i=n.response)||null==(r=i.body)?void 0:r.error)||(null==n||null==(l=n.response)||null==(a=l.body)?void 0:a.message)||(null==n?void 0:n.message)||"";"Max tokens redeemed"===e?(null==S||S(),R(!0)):H(!0),(0,u.u4)(u.qY.UNSUBSCRIBED_POST_UNLOCK_MODAL_ERROR,{post_id:t.id,error:e,max_redeem_error:"Max tokens redeemed"===e}),console.warn("Failed to create unlock token, user may need to complete setup in app:",n)}null==_||_(),P(!0)}catch(e){console.error("Failed to subscribe or unlock:",e)}finally{A(!1)}},q=async()=>{A(!0);try{await (0,p.x6)("/api/v1/send_app_download_link",{method:"POST",json:{email:O}}),V(!0)}catch(e){console.error("Failed to send app download link:",e)}finally{A(!1)}};return(0,r.Y)(f.aF,{isOpen:I,onClose:z,children:(0,r.Y)(f.cw,{children:T?(0,r.FD)(b.I1,{gap:16,children:[(0,r.Y)(k,{post:t,pub:n,secondaryText:j(W?"Open the Substack app to read this post":"Scan the QR code or receive a link to read this post in the Substack app"),errorText:L?j("You've already redeemed an unlock token"):M?j("Something went wrong. Please try again later."):void 0}),!W&&(0,r.FD)(b.I1,{gap:16,alignItems:"center",children:[(0,r.Y)(s.hj,{size:142,utm_campaign:w._9.postUnlockUnsubscribedModal,utm_source:w.VU.post,openUrl:K}),(0,r.Y)(g.v,{}),(0,r.Y)(m.$n,{priority:"primary",onClick:q,disabled:U||D,children:j(U?"Email sent":"Email me a link")})]}),W&&(0,r.Y)(b.I1,{alignItems:"center",paddingBottom:16,children:(0,r.Y)(m.$n,{href:K,style:{width:"80%"},children:j("Install the app")})})]}):x?(0,r.FD)(b.I1,{gap:8,children:[(0,r.Y)(k,{post:t,pub:n}),(0,r.Y)(C,{freeSignupEmail:l,onSubmit:J,isLoading:D})]}):(0,r.FD)(b.I1,{gap:8,children:[(0,r.Y)(k,{post:t,pub:n}),(0,r.Y)(m.$n,{leading:(0,r.Y)(i.A,{}),priority:"primary",paddingY:12,disabled:D,onClick:()=>J(),children:j("Subscribe and unlock")}),(0,r.Y)(m.$n,{priority:"secondary",onClick:z,children:j("Maybe later")})]})})})},k=e=>{var t;let{post:n,pub:i,secondaryText:a,errorText:l}=e,{iString:o}=(0,c.GO)(),s=null==(t=n.publishedBylines)?void 0:t[0],d=s?{id:s.id,name:s.name,photo_url:s.photo_url}:{id:i.author_id,name:i.author_name,photo_url:i.author_photo_url};return(0,r.FD)(b.I1,{gap:16,alignItems:"center",children:[(0,r.Y)(h.tp,{size:96,user:d}),(0,r.FD)(b.I1,{gap:8,alignItems:"center",children:[(0,r.Y)(Y.EY.H3,{align:"center",children:o("Unlock this post")}),l&&(0,r.Y)(Y.EY.B3,{color:"error",align:"center",children:l}),(0,r.Y)(Y.EY.B3,{color:"secondary",align:"center",children:a||o("Get a free subscription and unlock this paid post in the Substack app")})]})]})},C=e=>{let{freeSignupEmail:t,onSubmit:n,isLoading:i}=e,[l,o]=(0,a.useState)(null!=t?t:""),{iString:s}=(0,c.GO)(),u=(0,d.X)();return(0,r.FD)(b.I1,{gap:16,children:[(0,r.Y)(_.ks,{type:"email",name:"email",placeholder:s("Email Address"),ref:u,value:l,onInput:e=>o(e.target.value)}),(0,r.Y)(m.$n,{priority:"primary",onClick:()=>n(l),disabled:i,children:s(i?"Subscribing...":"Subscribe and unlock")}),(0,r.Y)(Y.EY.B4,{color:"secondary",weight:"light",align:"center",children:s("Maximum one post unlock per account")})]})}},76185:function(e,t,n){"use strict";n.d(t,{R:()=>E});var r=n(79785),i=n(4006),a=n(17402),l=n(15734),o=n.n(l),s=n(69277),c=n(48697),d=n(84605),u=n(86500),p=n(69618),h=n(68349),m=n(89490),g=n(35369),b=n(76977),f=n(81203),Y=n(63136),_=n(11587),v=n(36372),y=n(82776);function w(){let e=(0,r._)(["Why do you recommend this Substack?"]);return w=function(){return e},e}function S(){let e=(0,r._)(["Optional"]);return S=function(){return e},e}let k=e=>{var t;let{pubToRecommendBack:n,recommendingPub:r,recommendedPubs:l,setStep:u,close:k,setLoading:F,source:I}=e,{iString:E,iTemplate:D}=(0,d.GO)(),[A,x]=(0,a.useState)(null),{popToast:N}=(0,v.d)();(0,a.useEffect)(()=>{let e=null==l?void 0:l.find(e=>{let{id:t}=e;return t===n.id});if(null===A&&e){var t;x(null!=(t=e.blurb)?t:null)}},[A,l,n.id]);let T=async()=>{r?(await o().put("/api/v1/recommendations").send((0,s._)({recommended_publication_id:n.id,recommending_publication_id:r.id,source:I||"recommendation_notification_email",suggested:!1},A&&A.trim()?{description:A.trim()}:{})),(null==l?void 0:l.some(e=>{let{id:t}=e;return t!==n.id}))?null==k||k():null==u||u("choose"),F?(F(!0),null==k||k()):((0,h.V2)("/publish/recommendations"),N(()=>(0,i.Y)(v.y,{text:E("Recommendation added")})))):console.warn("No recommending pub")},P=(0,y.getByLine)(n);return(0,i.FD)(i.FK,{children:[(0,i.FD)(b.Ye,{justifyContent:"space-between",alignItems:"center",flex:"grow",paddingX:20,paddingTop:20,paddingBottom:16,borderBottom:"detail",children:[(0,i.Y)(Y.EY.H3,{weight:"heavy",flex:"grow",children:E("New recommendation")}),(0,i.Y)(g.K0,{priority:"tertiary",role:"button",size:"sm",title:"Close",onClick:()=>{k&&k()},"aria-label":"close",children:(0,i.Y)(c.A,{size:20})})]}),(0,i.Y)(b.I1,{padding:20,children:(0,i.FD)(b.I1,{gap:24,children:[(0,i.Y)(b.I1,{padding:12,gap:12,bg:"secondary",radius:"sm",shadow:"xs",children:(0,i.FD)(b.Ye,{gap:12,flex:"grow",alignItems:"center",children:[(0,i.Y)(m.az,{radius:"xs",border:"detail",children:(0,i.Y)(f.Nq,{pub:n,size:56,radius:"xs"})}),(0,i.FD)(b.I1,{flex:"grow",minWidth:0,children:[(0,i.Y)(Y.EY.B3,{weight:"semibold",ellipsis:!0,children:n.name}),P&&(0,i.Y)(Y.EY.B4,{color:"secondary",children:"By ".concat(P)})]})]})}),(0,i.FD)(b.I1,{gap:8,children:[(0,i.FD)(b.Ye,{flex:"grow",justifyContent:"space-between",children:[(0,i.Y)(Y.EY.B4,{weight:"semibold",children:D(w())}),(0,i.Y)(Y.EY.B4,{color:"secondary",children:D(S())})]}),(0,i.Y)(_.T,(0,s._)({placeholder:E("Tell your subscribers why they might enjoy ".concat(n.name,"...")),onChange:e=>x(e.currentTarget.value),value:null!=A?A:"",rows:6,maxlength:500},p.b))]}),(0,i.FD)(b.I1,{gap:12,children:[(0,i.Y)(g.$n,{disabled:(null!=(t=null==A?void 0:A.length)?t:0)>500,onClick:T,children:E("Recommend ".concat(n.name))}),(0,i.Y)(C,{})]})]})})]})},C=()=>{let{iString:e}=(0,d.GO)();return(0,i.FD)(Y.EY.B4,{color:"secondary",align:"center",children:[e("Recommendations will be shown to people after they subscribe to your Substack.")," ",(0,i.Y)(Y.Yq,{href:"https://support.substack.com/hc/en-us/articles/5036794583828-How-can-I-recommend-other-publications-on-Substack-",onClick:()=>{(0,u.u4)(u.qY.MANAGE_RECOMMENDATIONS_LEARN_MORE_CLICKED,{source:"modal-recommend-pub"})},decoration:"underline",children:e("Learn more")})]})};var F=n(16993);function I(){let e=(0,r._)(["Recommend "," to your readers"]);return I=function(){return e},e}let E=e=>{let{pub:t}=e,[n,r]=(0,a.useState)(!0),[l,s]=(0,a.useState)(null),[c,p]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),{iString:_,iTemplate:v}=(0,d.GO)();return((0,a.useEffect)(()=>{let e=async()=>{try{let e=(await o().get("/api/v1/publication_user/default")).body;if(s(e),!e||e.id===t.id){p(!0),r(!1);return}let n=await o().get("/api/v1/recommendations/from/".concat(e.id,"/to/").concat(t.id));p(!!n.body),r(!1)}catch(e){console.error("Failed to load recommend cta: ",e)}};!l&&n&&e()},[t,n,l]),n||c||l&&l.invite_only)?null:(0,i.FD)(i.FK,{children:[(0,i.FD)(b.I1,{alignItems:"center",padding:32,gap:20,borderTop:"detail",style:{marginTop:24},"data-testid":"recommendation-footer",children:[(0,i.Y)(f.wg,{pub:t,size:48,openInNewTab:!0}),(0,i.FD)(b.I1,{gap:8,children:[(0,i.Y)(Y.EY.H4,{align:"center",children:v(I(),t.name)}),t.hero_text&&(0,i.Y)(Y.EY.B3,{color:"secondary",align:"center",clamp:3,children:t.hero_text})]}),(0,i.Y)(g.$n,{onClick:()=>{(0,u.u4)(u.qY.END_OF_POST_RECOMMEND_CTA_CLICKED,{recommended_pub_id:t.id,recommending_pub_id:null==l?void 0:l.id}),m(!0)},children:_("Recommend")})]}),(0,i.Y)(D,{isOpen:h,onClose:()=>m(!1),pubToRecommend:t,recommendingPub:l,setStep:()=>{m(!1)},setLoading:r})]})},D=e=>{let{isOpen:t,onClose:n,pubToRecommend:r,recommendingPub:a,setLoading:l,setStep:o}=e,s=(0,v.d)(),{iString:c}=(0,d.GO)();return(0,i.Y)(F.aF,{isOpen:t,onClose:n,children:(0,i.Y)(k,{pubToRecommendBack:r,recommendingPub:a,setStep:o,close:n,setLoading:e=>{l(e),s.popToast(()=>(0,i.Y)(v.y,{text:c("Recommendation added")}))},source:"end-of-post-recommend-cta"})})}},58925:function(e,t,n){"use strict";n.d(t,{ut:()=>eo,YA:()=>ea});var r=n(20347),i=n(3849),a=n(69277),l=n(4006),o=n(32485),s=n.n(o),c=n(15977),d=n(72170),u=n(17402),p=n(23623),h=n(35426),m=n(89490);let g=(0,m.I4)({className:"backdrop-TSZpWr",height:40,paddingTop:64,paddingBottom:16,paddingLeft:16,paddingRight:16,pointerEvents:"none"}),b="transition-kQjRL0",f="show-SOOiPA",Y="hide-xglgl1";function _(e){let{children:t}=e;return(0,l.Y)(h.e.Child,{as:u.Fragment,enter:b,enterFrom:Y,enterTo:f,leave:b,leaveFrom:f,leaveTo:Y,children:t})}let v="show-RjVr49",y="hide-TYuTf7";function w(e){let{children:t}=e;return(0,l.Y)(h.e.Child,{as:u.Fragment,enter:"enter-BY7bVS",enterFrom:y,enterTo:v,leave:"leave-AN8v0R",leaveFrom:v,leaveTo:y,children:t})}var S=n(84605),k=n(35369),C=n(10996);function F(e){let{handleQuoteRestack:t,disableRestackButton:n,handleShare:r,isVisible:i,showRestackButton:a}=e;return(0,l.Y)(h.e,{as:u.Fragment,appear:!0,show:i,children:(0,l.Y)(D,{children:(0,l.FD)(C.e$,{children:[(0,l.Y)(_,{children:(0,l.Y)(g,{})}),(0,l.Y)(w,{children:(0,l.FD)(A,{children:[a&&(0,l.Y)(I,{onClick:t,disabled:n}),(0,l.Y)(E,{onClick:r,showRestackButton:a})]})})]})})})}function I(e){let{onClick:t,disabled:n}=e,{iString:r}=(0,S.GO)();return(0,l.Y)(k.Bj,{onClick:t,leading:(0,l.Y)(c.A,{size:20}),priority:"primary",flex:"grow",disabled:n,children:r("Restack")})}function E(e){let{onClick:t,showRestackButton:n}=e,{iString:r}=(0,S.GO)();return(0,l.Y)(k.Bj,{onClick:t,leading:(0,l.Y)(d.A,{size:20}),priority:"primary",flex:"grow",children:r(n?"Share":"Share quote")})}let D=(0,m.I4)({className:"root-VHsWlA",display:"flex",position:"fixed",padding:16}),A=(0,m.I4)({display:"flex",flex:"grow",justifyContent:"space-between",gap:12,zIndex:1});var x=n(48309),N=n(82853),T=n(68924),P=n(4067),O=n(79146),B=n(9979),L=n(93355),R=n(62870),M=n(98949);let H=e=>{let{pub:t,post:n,style:r,selectionId:i,size:a,hoverOverlay:o=!0}=e,{img:s,imgDownload:c,shareData:d,useNativeShare:p}=(0,L.Y)((0,R.wj)({pub:t,post:n,selectionId:i,style:r})),h=(0,u.useCallback)(async()=>{await (0,R.f3)({post_id:n.id,selection_id:i,aspect_ratio:r.aspectRatio,type:"post_selection",shareData:p?d:void 0,eventName:"SHARE_SELECTION_IMAGE_DOWNLOADED",additionalTrackingData:{interaction:"click"}})},[n.id,i,r.aspectRatio,p,d]);return(0,l.Y)(R.Cs,{onClick:h,href:p?void 0:c,children:(0,l.FD)(R.OK,{size:a,children:[!(0,M.Fr)()&&s&&o&&(0,l.Y)(R.lh,{onClick:h}),(0,l.Y)(R.BB,{img:s})]})})};var U=n(46271),V=n(86500),j=n(94729),W=n(12501),z=n(68349),K=n(76977),J=n(16993),q=n(36372),G=n(8295),$=n(11510),Z=n(39318),Q=n(49807),X=n(57324);let ee=e=>{let{assetStyle:t,aspectRatio:n,loadingSelection:r,post:i,pub:a,themeVariables:o,setAspectRatio:s,assetTheme:c,setAssetTheme:d,selectionId:u}=e,p=[],h=(null==i?void 0:i.cover_image)||(null==a?void 0:a.cover_photo_url);return h&&p.push("image"),o.background_pop&&p.push("accent"),p.push("primary"),(0,l.Y)(J.cw,{children:(0,l.FD)(K.I1,{gap:20,children:[(0,l.Y)(K.pT,{className:"imageContainer-OjAkhl",alignItems:"center",justifyContent:"center",children:i&&u&&!r&&(0,l.Y)(H,{pub:a,post:i,style:t,selectionId:u,size:400,hoverOverlay:!1})}),(0,l.FD)(G._d,{children:[(0,l.Y)(G.Jj,{assetThemes:p,assetTheme:c,setAssetTheme:d,theme:o,pubCoverImageUrl:h}),(0,l.Y)(G.aD,{aspectRatio:n,setAspectRatio:s,includeInstagram:!0})]})]})})},et=e=>{let{pub:t,post:n,isOpen:r,onClose:i,selection:a,selectionId:o,setSelectionId:s,themeVariables:c}=e,{iString:d}=(0,S.GO)(),[p,h]=(0,u.useState)(!1),[m,g]=(0,u.useState)("instagram"),b=(null==n?void 0:n.cover_image)||(null==t?void 0:t.cover_photo_url),[f,Y]=(0,u.useState)(b?"image":"accent"),_=(0,U.Jd)(),v=(0,q.d)(),y=(0,$.Iu)(),w=(0,M.Fr)({checkFirst4:!0}),{result:C}=(0,W.st)({pathname:"/api/v1/publication/".concat(t.id,"/theme"),auto:!!a&&n&&r&&!c,cacheTtl:1/0,initialResult:c,deps:[a,n,r,c]}),F=r&&(!!o||p)&&!!C;(0,u.useEffect)(()=>{F&&(null==n?void 0:n.id)&&(0,V.u4)(V.qY.SHARE_SELECTION_MODAL_OPENED,{post_id:n.id})},[F,n]),(0,u.useEffect)(()=>{a&&n&&r&&(async()=>{h(!0);try{let e=await (0,j.x6)("/api/v1/post_selection",{method:"PUT",json:{postId:n.id,publication_id:t.id,startParagraph:a.startParagraph,endParagraph:a.endParagraph,startOffset:a.startOffset,endOffset:a.endOffset}});if(h(!1),e instanceof Error)throw e;s(e.selection.id.toString())}catch(e){alert((0,j.Qd)(e)),h(!1),i()}})()},[t,n,a,r,s,i]);let I=(e,r)=>{let i=R(),a=(0,B.x5)(null,{pub:t,post:n,selectionId:o,user:_||void 0,medium:"web",utm_campaign:X._9.postShareSelection,params:{aspectRatio:m,bgColor:i.bgColor,textColor:i.textColor,bgImage:i.bgImage}});(0,B.Q_)(e,r,{shareUrl:a,post:n,pub:t,selectionId:o,utm_campaign:X._9.postShareSelection})},E=async()=>{I("copy",e=>((0,z.lW)(e),v.popToast(()=>(0,l.Y)(q.y,{text:d("Copied link to clipboard")})),!1))},D=async()=>{I("facebook",e=>(0,Q.yRP)("https://www.facebook.com/sharer/sharer.php",{u:e}))},A=async()=>{n&&I("twitter",e=>(0,Z.gKg)({url:e,text:n.title}))},L=async()=>{I("linkedin",e=>(0,Q.yRP)("https://www.linkedin.com/sharing/share-offsite/",{url:e}))},R=()=>{if(!C)return{aspectRatio:m};switch(f){case"image":return{aspectRatio:m,textColor:"#ffffff",bgImage:!0};case"accent":return{aspectRatio:m,bgColor:C.background_pop,textColor:C.print_on_pop};default:return{aspectRatio:m,bgColor:C.web_bg_color||C.cover_bg_color,textColor:C&&"string"==typeof C.print_on_web_bg_color&&C.print_on_web_bg_color.startsWith("hsl")?C.cover_print_primary||"#1a1a1a":(null==C?void 0:C.print_on_web_bg_color)||"#1a1a1a"}}},H=async()=>{let e=R(),r="Share Selection - ".concat(e.aspectRatio);(0,V.u4)(V.qY.SHARE_SELECTION_IMAGE_DOWNLOADED,{post_id:null==n?void 0:n.id,selection_id:o,type:r,aspect_ratio:m,interaction:"click"});let i=document.createElement("a");i.href=n&&o?(0,Z.SAZ)(t,n,o,e,r):"",i.download="Share Selection - ".concat(m),i.target="_blank",i.rel="noopener noreferrer",i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)};return(0,l.FD)(J.aF,{isOpen:F,onClose:i,width:640,fullscreenMobile:!0,children:[(0,l.Y)(J.rQ,{title:d("Share quote"),showClose:!0,onClose:i,showDivider:!0}),(0,l.Y)(ee,{assetStyle:R(),aspectRatio:m,loadingSelection:p,post:n,pub:t,themeVariables:C,setAspectRatio:g,assetTheme:f,setAssetTheme:Y,selectionId:o,setSelectionId:s}),(0,l.Y)(J.jl,{direction:"row",showDivider:!0,primaryButton:w?void 0:(0,l.Y)(k.$n,{priority:"primary",flex:y?void 0:"grow",disabled:!o,onClick:H,leading:(0,l.Y)(x.A,{size:20}),children:d("Download")}),secondaryButton:(0,l.FD)(K.Ye,{gap:8,children:[(0,l.Y)(k.K0,{priority:"secondary-outline",onClick:E,disabled:!o,children:(0,l.Y)(N.A,{height:20,width:20})}),(0,l.Y)(k.K0,{priority:"secondary-outline",onClick:A,disabled:!o,children:(0,l.Y)(O.A,{height:20,width:20})}),(0,l.Y)(k.K0,{priority:"secondary-outline",onClick:D,disabled:!o,children:(0,l.Y)(T.A,{height:20,width:20})}),(0,l.Y)(k.K0,{priority:"secondary-outline",onClick:L,disabled:!o,children:(0,l.Y)(P.A,{height:20,width:20})})]})})]})};var en=n(63136),er=n(2481),ei=n(7642);function ea(e){var t,n,r;let{post:i,pub:a,selection:o,onClose:s,themeVariables:c,userInteractionDisabled:d}=e,[p,h]=(0,u.useState)(!1),[m,g]=(0,u.useState)(),b=(0,u.useRef)(null),f=(null==o||null==(r=o.text)||null==(n=r.split)||null==(t=n.call(r," "))?void 0:t.length)||0,Y=!!(o&&f>=3&&!i.is_draft&&!(null==a?void 0:a.invite_only));(0,u.useEffect)(()=>{o&&(b.current=o)},[o]);let _=o||b.current;return(0,l.FD)(l.FK,{children:[_&&(0,l.Y)(el,{selection:_,onClose:s,userInteractionDisabled:d,onShowSelectionModal:h,post:i,pub:a,isOpen:Y}),(0,l.Y)(et,{selection:o,pub:a,post:i,isOpen:p,onClose:()=>h(!1),selectionId:m,setSelectionId:g,themeVariables:c})]})}function el(e){let{selection:t,onClose:n,userInteractionDisabled:r,onShowSelectionModal:i,post:a,pub:o,isOpen:s}=e,{iString:h}=(0,S.GO)(),m=(0,$.Iu)(),g=(0,U.Jd)(),b=(0,er.NP)(),f=(0,q.d)(),Y=!a.is_draft&&!!g,[_,v]=(0,u.useState)(!1),[y,w]=(0,u.useState)(!1);(0,u.useEffect)(()=>{s?w(!0):w(!1)},[s]),(0,u.useEffect)(()=>{if(!s)return;let e=()=>{w(!1),n()};return window.addEventListener("scroll",e,{passive:!0,capture:!0,once:!0}),()=>{window.removeEventListener("scroll",e,{capture:!0})}},[n,s]),(0,u.useEffect)(()=>{let e=()=>{t.y-57*!!m<104?C({top:t.rect.bottom+12}):C({top:t.y-92-12})};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[t,m]);let[k,C]=(0,u.useState)({top:-1}),I=()=>{i(!0)},E=async()=>{v(!0);try{let e=await (0,j.x6)("/api/v1/post_selection",{method:"PUT",json:{postId:a.id,publication_id:o.id,startParagraph:t.startParagraph,endParagraph:t.endParagraph,startOffset:t.startOffset,endOffset:t.endOffset}});if(v(!1),e instanceof Error)throw e;return e.selection.id}catch(e){alert((0,j.Qd)(e)),v(!1)}},D=async()=>{let e=await E();if((0,V.u4)(V.qY.RESTACK_SELECTION_CLICKED,{post_id:a.id}),!g){let t=(0,Z.oRR)(document.location.href,{action:"restack-comment",selection:e}),n=(0,Z.a7q)({redirect:t});(0,z.V2)(n,{local_navigation:!1,event});return}let t=(0,Z.wu9)(o,a,{urlParams:{r:g?g.id.toString(36):null,selection:e,utm_campaign:X._9.postShareSelection,utm_medium:X.Jn.web}});await b.open({restackUrl:t}) instanceof Error?f.popToast(()=>(0,l.Y)(q.y,{text:"Failed to post"})):f.popToast(()=>(0,l.Y)(q.y,{text:"Note sent",cta:"View now",href:(0,Q.oT5)()}))},A=!Y&&!_&&!!g;return -1===k.top?null:m?(0,l.Y)(F,{handleQuoteRestack:D,showRestackButton:!o.hide_post_restacks&&Y,disableRestackButton:A,handleShare:I,isVisible:y}):(0,l.Y)(p.a,{children:(0,l.FD)(K.I1,{style:{top:k.top,bottom:k.bottom,left:t.rect.x+t.rect.width/2},justifyContent:"center",outline:"detail",shadow:"md",radius:"md",className:"".concat(ei.A.popover," ").concat(y?ei.A.visible:""," ").concat(r?ei.A.disabled:""),padding:4,gap:4,children:[!o.hide_post_restacks&&Y&&(0,l.FD)(eo,{onClick:D,disabled:A,children:[(0,l.Y)(c.A,{stroke:"var(--color-utility-white)",size:20}),(0,l.Y)(en.EY.B4,{color:"vibrance-primary",weight:"medium",children:h("Restack")})]}),(0,l.FD)(eo,{onClick:I,children:[(0,l.Y)(d.A,{stroke:"var(--color-utility-white)",size:20}),(0,l.Y)(en.EY.B4,{color:"vibrance-primary",weight:"medium",children:h("Share")})]})]})})}function eo(e){var t=(0,r._)({},(0,i._)(e));return(0,l.Y)(k.Nm,(0,a._)({className:s()(ei.A.button,t.disabled&&ei.A.disabled),resetCss:!0},t))}},65207:function(e,t,n){"use strict";n.d(t,{F:()=>U});var r=n(69277),i=n(79785),a=n(4006),l=n(17402),o=n(15734),s=n.n(o),c=n(24142),d=n(13950),u=n(32485),p=n.n(u),h=n(3680),m=n(63446),g=n(15894),b=n(84605),f=n(86500),Y=n(68349),_=n(24078),v=n(76977),y=n(39318);let w={subscribeDialog:"subscribeDialog-ApxQJS",dismissButton:"dismissButton-gWmS4u",pictureBox:"pictureBox-yO_tQ9",childPublicationIcon:"childPublicationIcon-u5S7bv",signInLink:"signInLink-v__pXF",background:"background-qPxN3C",error:"error-ekhTFi",closeIcon:"closeIcon-pSUQVJ",fp:"fp-sXrGxn",form:"form-mUblsD",subscribeButton:"subscribeButton-GT6UQz",signInLinkWrapper:"signInLinkWrapper-WFxaK4",hed:"hed-pyKjVu",dek:"dek-YOBGIH",emailInput:"emailInput-Znhurz"},S=e=>{let{position:t,offset:n,target:r,left:i,modal:l,pub:o,setDismissed:s,subscribe:c,email:d,setEmail:u,loading:S,errors:k,post:C,opacityOfBackground:F,onBackgroundClicked:I}=e,{iString:E}=(0,b.GO)();return(0,a.FD)(a.FK,{children:[(0,a.Y)(v.I1,{ref:l,alignItems:"center",className:p()(w.subscribeDialog,w.fp),style:{top:"absolute"===t?"".concat(n,"px"):"".concat(r,"px"),left:"".concat(i,"px"),position:t},children:(0,a.FD)(a.FK,{children:[(0,a.FD)(v.Ye,{alignItems:"end",justifyContent:"center",paddingBottom:8,children:[(0,a.Y)("div",{className:w.pictureBox,children:(0,a.Y)(_.eu,{className:w.authorIcon,size:80,user:{photo_url:o.logo_url}})}),(0,a.Y)("div",{className:w.closeIcon,onClick:()=>s(!0),children:(0,a.Y)(h.A,{})})]}),(0,a.FD)(g.T,{align:"center",className:w.hed,preset:"h4-sans-condensed",children:[E("Discover more from"),(0,a.Y)("br",{}),I18N.p(o.name)]}),(0,a.Y)(g.T,{align:"center",className:w.dek,preset:"body",children:o.hero_text}),(0,a.FD)("form",{className:w.form,onSubmit:e=>{e.preventDefault(),c(d)},children:[(0,a.Y)("input",{className:w.emailInput,disabled:S,placeholder:E("Enter your email"),value:d,onChange:e=>{e.stopPropagation(),e.preventDefault(),u(e.currentTarget.value)}}),(0,a.Y)("div",{id:"error-container",children:k&&k.map(e=>(0,a.Y)("div",{className:w.error,children:e}))}),(0,a.Y)(m.v,{className:w.subscribeButton,disabled:S,type:"submit",children:E("Subscribe")})]}),(0,a.Y)(m.v,{className:w.dismissButton,trailingIcon:"chevron-right",variant:"tertiary",onClick:()=>s(!0),children:E("Continue reading")}),(0,a.FD)(g.T,{align:"center",className:w.signInLinkWrapper,preset:"caption",children:[(0,a.Y)("div",{children:E("Already have an account?")}),(0,a.FD)("div",{children:[(0,a.Y)("a",{className:w.signInLink,style:{cursor:"pointer"},onClick:()=>{(0,f.u4)(f.qY.SUBSCRIBE_PROMPT_SIGN_IN_CLICKED,{post_id:C.id}),(0,Y.V2)((0,y.a7q)({for_pub:o.subdomain,redirect:(0,y.wu9)(o,C)}))},children:E("Sign in")})," "]})]})]})}),F>0&&(0,a.Y)("div",{className:w.background,style:{opacity:"".concat(F,"%")},onClick:I})]})};var k=n(84565),C=n(94729),F=n(17186),I=n(89490),E=n(35369),D=n(16074),A=n(20500),x=n(84843),N=n(63136),T=n(65842),P=n(62088),O=n(11510),B=n(61554),L=n(16291),R=n(4016),M=n(57324);function H(){let e=(0,i._)(["Discover more from ",""]);return H=function(){return e},e}let U=e=>{var t;let{pub:n,post:i,isTest:o}=e,[u,p]=(0,l.useState)(!1),[h,m]=(0,l.useState)(!1),[g,U]=(0,l.useState)(!1),[V,j]=(0,l.useState)(""),[W,z]=(0,l.useState)([]),[K,J]=(0,l.useState)(200),[q,G]=(0,l.useState)(0),$=(0,l.useRef)(null),Z=(0,O.Iu)(),{getExperimentVariant:Q,exposeExperiment:X,getConfigFor:ee}=(0,k.NQ)(),et=ee("welcome_page_app_button"),en=Q("post_page_scrolling_modal_subscribe_in_app"),er=Z&&et&&"treatment"===en,[ei,ea]=(0,l.useState)(!1),el="pub-".concat(n.id,"-subscribe-prompt-next-shown-at"),eo="pub-".concat(n.id,"-takeover-next-shown-at"),es="undefined"!=typeof window&&(null==(t=window)?void 0:t.innerHeight)?window.innerHeight:700,ec=document.getElementsByClassName("available-content"),ed=ec.length>0&&ec[0]?ec[0].scrollHeight:0,eu=600;eu=Math.max(Math.min(600,ed-es),600),(()=>{var e;let{height:t,width:n}=(null==(e=$.current)?void 0:e.getBoundingClientRect())||{height:0,width:0};J("undefined"!=typeof window&&window&&$.current?(window.innerHeight-t)/2:200),G("undefined"!=typeof window&&window&&$.current?(window.innerWidth-n)/2:0)})();let[ep,eh]=(0,l.useState)(es+Math.max(K,eu)),[em,eg]=(0,l.useState)(Math.max(document.documentElement.scrollTop||document.body.scrollTop,0)),[eb,ef]=(0,l.useState)("absolute"),[eY,e_]=(0,l.useState)("fixed"===eb||em>ep-es),ev="fixed"===eb?60:Math.min(Math.max((em-ep+es)/(es-K)*60,0),60),ey=(0,l.useCallback)(()=>{!Z&&em>=ep-300&&m(!0)},[em,Z,ep,K,m]);(0,l.useEffect)(()=>{var e;if(o)return;ed<=1.5*es&&p(!0);let t=null;if(null==(e=document)?void 0:e.referrer){try{t=new URL(document.referrer)}catch(e){}((null==t?void 0:t.hostname)==="news.ycombinator.com"||(null==t?void 0:t.hostname)==="hckrnews.com")&&p(!0),"undefined"!=typeof navigator&&/Twitter for/i.test(navigator.userAgent)&&p(!0)}(0,F.xm)(el)>Date.now()&&p(!0)},[]),(0,l.useEffect)(()=>{!eY||u||((0,f.u4)(f.qY.SUBSCRIBE_PROMPT_SHOWN,{post_id:i.id}),Z&&et&&X("post_page_scrolling_modal_subscribe_in_app"),(0,F.X3)(el,(0,L.A)().add(1,"hour").valueOf()),(0,F.X3)(eo,(0,L.A)().add(1,"hour").valueOf()))},[eY,u,Z,et,X]),(0,l.useEffect)(()=>{h&&((0,f.u4)(f.qY.SUBSCRIBE_PROMPT_DISMISSED,{post_id:i.id}),(0,F.X3)(el,(0,L.A)().add(1,"day").valueOf()),(0,F.X3)(eo,(0,L.A)().add(1,"hour").valueOf()))},[h]);let ew=(0,l.useCallback)(async e=>{if(!g){var t,a,l,o,c;U(!0),z([]),(0,f.u4)(f.qY.SUBSCRIBE_PROMPT_SUBMITTED,{post_id:i.id});try{let t=await s().post("/api/v1/free").send({email:e,source:"post-subscribe-prompt"});((0,f.$5)(t.body.requires_confirmation),"enabled"===n.payments_state||n.has_recommendations)?document.location.href=(0,y.eV6)(n,(0,r._)({utm_medium:M.Jn.web,utm_source:M.VU.postSubscribePrompt,utm_content:i&&i.id,simple:!0,just_signed_up:!0,next:(0,y.wu9)(n,i),requires_confirmation:t.body.requires_confirmation?"true":""},t.body.subscription_id&&{subscription_id:t.body.subscription_id},t.body.referral_token&&{referral_token:t.body.referral_token})):window.location.href=(0,y.wu9)(n,i,{urlParams:{subscribe_prompt:"free"}})}catch(e){(null==e||null==(a=e.response)||null==(t=a.body)?void 0:t.error)&&"string"==typeof e.response.body.error?z([e.response.body.error]):(null==e||null==(o=e.response)||null==(l=o.body)?void 0:l.errors)&&Array.isArray(e.response.body.errors)&&e.response.body.errors.length>0&&"string"==typeof(null==(c=e.response.body.errors[0])?void 0:c.msg)&&z(e.response.body.errors.map(e=>e.msg))}finally{U(!1)}}},[i,n,g,U]),eS=(0,l.useCallback)(async()=>{if(!ei){ea(!0);try{if((0,f.u4)(f.qY.APP_STORE_LINK_CLICKED,{source:"post_subscribe_prompt_app_upsell",utm_campaign:M._9.postSubscribePromptSubscribeInApp,utm_source:M.VU.postSubscribePrompt}),V)try{await (0,C.x6)("/api/v1/free",{method:"POST",json:{email:V,source:"post_subscribe_prompt_app_upsell"}})}catch(e){console.error("Failed to subscribe user:",e)}try{await (0,C.x6)("/api/v1/app_intended_state",{method:"POST",json:{data:{category:"post",postId:i.id},useIp:!0}}),await (0,C.x6)("/api/v1/onboarding_intended_recommendations",{method:"POST",json:{recommendations:[{publicationId:n.id,isPrechecked:!0,source:"post_subscribe_prompt_app_upsell"}],useIp:!0}})}catch(e){console.error("Failed to set app intended state:",e)}m(!0);let e=(0,y.XV8)(n.subdomain,i.slug,{source:M.VU.postSubscribePrompt,params:{utm_campaign:M._9.postSubscribePromptSubscribeInApp},redirect:"app-store"});(0,Y.V2)(e,{local_navigation:!1})}catch(e){console.error("Failed to handle subscribe in app click:",e)}finally{ea(!1)}}},[ei,V,i,n,m]);(0,l.useEffect)(()=>{if(u||h)return;let e=()=>{let e=Math.max(document.documentElement.scrollTop||document.body.scrollTop,0),t=e-em;t>0&&"absolute"===eb&&e>ep-K&&ef("fixed"),t<0&&"fixed"===eb&&(ef("absolute"),eh(em+K)),t<0&&"absolute"===eb&&e<ep-es&&eh(es+Math.max(K,eu,em)),eg(e),("fixed"===eb||t>0&&e>ep-es)&&e_(!0)};return window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[eb,ep,eh,em,eg,e_]),(0,l.useEffect)(()=>{if(u||h)return;let e=e=>{"Escape"===e.key&&m(!0)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[u,h,m]);let{iString:ek,iTemplate:eC}=(0,b.GO)();return u||h?(0,a.Y)(a.FK,{}):(0,R.lu)({pub:n})?(0,a.Y)(S,{position:eb,offset:ep,target:K,left:q,modal:$,pub:n,setDismissed:m,subscribe:ew,email:V,setEmail:j,loading:g,errors:W,post:i,opacityOfBackground:ev,onBackgroundClicked:ey}):(0,a.FD)(d.DH,{children:[(0,a.FD)(v.I1,{ref:$,bg:"primary",border:"detail",radius:"md",shadow:"xl",className:w.subscribeDialog,style:{top:"absolute"===eb?"".concat(ep,"px"):"".concat(K,"px"),left:"".concat(q,"px"),position:eb},role:"dialog","aria-label":ek("Subscribe modal"),children:[(0,a.FD)(v.I1,{gap:20,position:"relative",padding:20,children:[(0,a.Y)(x.J,{onClose:()=>m(!0)}),(0,a.Y)(I.az,{alignSelf:"center",children:(0,a.Y)(_.eu,{size:64,photoUrl:n.author_photo_url})}),(0,a.FD)(v.I1,{justifyContent:"center",gap:4,alignItems:"center",textAlign:"center",children:[(0,a.Y)(N.EY.B2,{weight:"semibold",color:"primary",children:eC(H(),n.name)}),n.hero_text&&(0,a.Y)(N.EY.B3,{color:"secondary",clamp:3,children:n.hero_text}),n.rankingDetailFreeSubscriberCount&&(0,a.Y)(N.EY.B4,{paddingBottom:24,align:"center",color:"pub-secondary-text",children:n.rankingDetailFreeSubscriberCount})]}),(0,a.Y)("form",{onSubmit:e=>{e.preventDefault(),ew(V)},children:(0,a.FD)(v.I1,{gap:8,children:[(0,a.Y)(T.ks,{placeholder:ek("Enter your email..."),value:V,disabled:g,onChange:e=>{e.stopPropagation(),e.preventDefault(),j(e.currentTarget.value)}}),W.length>0&&(0,a.Y)(v.I1,{gap:4,children:W.map(e=>(0,a.Y)(A.yn,{align:"center",children:e}))}),(0,a.Y)(E.$n,{type:"submit",disabled:g,priority:"primary",children:ek("Subscribe")}),er&&(0,a.FD)(a.FK,{children:[(0,a.Y)(D.v,{text:ek("or")}),(0,a.Y)(E.$n,{priority:"secondary",width:"100%",onClick:eS,disabled:ei,loading:ei,leading:(0,a.Y)(c.A,{height:20,fill:"#FF6719"}),children:ek("Subscribe with Substack")})]}),(0,a.Y)(v.VP,{paddingTop:8,opacity:80,children:(0,a.Y)(B.U,{includeCheckbox:!1,addSubscribePreamble:!0,color:"secondary",textAlign:"center",pub:n})})]})})]}),(0,a.Y)(P.dt,{children:(0,a.FD)(a.FK,{children:[ek("Already have an account? "),(0,a.Y)(N.Yq,{color:"accent",decoration:"hover-underline",onClick:()=>{(0,f.u4)(f.qY.SUBSCRIBE_PROMPT_SIGN_IN_CLICKED,{post_id:i.id}),(0,Y.V2)((0,y.a7q)({for_pub:n.subdomain,redirect:(0,y.wu9)(n,i)}))},cursor:"pointer",children:ek("Sign in")})]})})]}),ev>0&&(0,a.Y)("div",{className:w.background,onClick:ey,style:{opacity:"".concat(ev,"%")}})]})}},64591:function(e,t,n){"use strict";n.d(t,{M:()=>_});var r=n(4006),i=n(32485),a=n.n(i),l=n(17402),o=n(84605),s=n(35369),c=n(76977),d=n(37598),u=n(75303),p=n(63136),h=n(58278),m=n(98949);let g={trigger:"trigger-V8d1vI",absolute:"absolute-PTY2O3",fixed:"fixed-n4RrZu",line:"line-DsYVXw",active:"active-Yh0Zwm","indent-1":"indent-1-vdeuvl",indent1:"indent-1-vdeuvl","indent-2":"indent-2-yiZ6hb",indent2:"indent-2-yiZ6hb","indent-3":"indent-3-levoo9",indent3:"indent-3-levoo9",label:"label-ZmMXKp",menu:"menu-IsOZj4",row:"row-gbMU1E"},b=e=>e?/^H[1-5]$/i.test(e.tagName)?e:b(e.parentElement):null,f=e=>{let{toc:t,minLevel:n,activeItem:i}=e;return(0,r.Y)(c.I1,{gap:12,paddingY:12,paddingX:8,alignItems:"end",children:t.map((e,t)=>{let l=e.level-n,o="indent-".concat(Math.min(l,3)),s=(0,h.uB)(e.text.toLowerCase(),!0);return(0,r.Y)("div",{className:a()(g.line,g[o],i===s&&g.active)},t)})})},Y=e=>{let{toc:t,minLevel:n,activeItem:i,onItemClick:l}=e,{iString:s}=(0,o.GO)();return(0,r.FD)(c.I1,{gap:4,padding:8,className:g.menu,children:[(0,r.Y)(p.EY.Meta,{padding:4,color:"primary",children:s("Contents")}),t.map((e,t)=>{let o=(0,h.uB)(e.text.toLowerCase(),!0),s=e.level-n,d="indent-".concat(Math.min(s,3));return(0,r.Y)(u.AE,{href:"#\xa7".concat(o),onClick:e=>{e.preventDefault(),l(o)},children:(0,r.Y)(c.Ye,{padding:4,className:a()(g.row),children:(0,r.Y)(p.EY.B3,{className:a()(g.label,g[d],i===o&&g.active),ellipsis:!0,children:e.text})})},t)})]})},_=e=>{let{toc:t,position:n="fixed"}=e,{iString:i}=(0,o.GO)(),c=Math.min(...t.map(e=>e.level)),[u,p]=(0,l.useState)(null),_=(e=>{let[t,n]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let t=[];return e.forEach(e=>{let r=(0,h.uB)(e.text.toLowerCase(),!0),i=document.getElementById("\xa7".concat(r));if(i){let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.intersectionRatio>=.8&&n(r)})},{threshold:.5,rootMargin:"0px 0px -90% 0px"});e.observe(i),t.push(e)}}),()=>t.forEach(e=>e.disconnect())},[e]),t})(t);return t.length<2||(0,m.Fr)()?null:(0,r.Y)(d.A,{trigger:(0,r.Y)(s.Nm,{className:a()(g.trigger,g[n]),"aria-label":i("Table of Contents"),position:n,showFocus:!0,children:(0,r.Y)(f,{toc:t,minLevel:c,activeItem:_})}),side:"right",children:(0,r.Y)(Y,{toc:t,minLevel:c,activeItem:_,onItemClick:e=>{let t=document.getElementById("\xa7".concat(e));if(t){let n=b(t);if(n){if(u){let e=document.getElementById("\xa7".concat(u)),t=e?b(e):null;null==t||t.classList.remove("highlight")}n.classList.add("highlight"),p(e),t.scrollIntoView({behavior:"smooth",block:"start"})}}}})})}},54014:function(e,t,n){"use strict";n.d(t,{j:()=>g});var r=n(69277),i=n(70408),a=n(4006),l=n(15734),o=n.n(l),s=n(52077),c=n(84605),d=n(35369),u=n(76977),p=n(76171),h=n(16993),m=n(65842);function g(e){let{isOpen:t,onClose:n,speakers:l,speakerMap:g,onChangeSpeakerMap:b,postId:f}=e,{iString:Y}=(0,c.GO)();return(0,a.FD)(h.aF,{isOpen:t,onClose:n,children:[(0,a.Y)(h.rQ,{title:Y("Assign Speakers"),description:Y("Assign names to each identified speaker to show them on the transcript. If there are too many speakers, you may have to duplicate a name."),showClose:!0,onClose:n,showDivider:!0}),(0,a.Y)(h.cw,{children:(0,a.Y)(u.I1,{gap:20,children:l.map(e=>(0,a.FD)(m.A0,{children:[(0,a.Y)(p.JU,{children:(0,s.Ui)(e)}),(0,a.Y)(m.ks,{onChange:t=>{var n;return b((0,i._)((0,r._)({},g),{[e]:null==(n=t.target)?void 0:n.value}))},value:(null==g?void 0:g[e])||"",placeholder:Y("Assign a name...")})]}))})}),(0,a.Y)(h.jl,{direction:"column",showDivider:!0,primaryButton:(0,a.Y)(d.$n,{priority:"primary",onClick:()=>{g&&Object.keys(g).length>0&&o().put("/api/v1/drafts/".concat(f,"/transcript")).send({speaker_map:g}).then(e=>{e.body.data&&n()})},children:Y("Save changes")})})]})}},76609:function(e,t,n){"use strict";n.d(t,{g:()=>_});var r=n(4006),i=n(38893),a=n(14506),l=n(48617),o=n(99070),s=n(91461),c=n(76977),d=n(63136);function u(e){let{text:t}=e;return(0,r.FD)(c.ov,{gap:8,flex:"grow",children:[(0,r.Y)(c.ov,{flex:"auto",children:(0,r.Y)(s.A,{size:16,color:"var(--color-fg-secondary)"})}),(0,r.Y)(d.EY.B4,{weight:"medium",color:"secondary",children:t})]})}var p=n(4169),h=n(69277),m=n(70408),g=n(97731);let b=e=>(0,r.FD)(g.A,(0,m._)((0,h._)({},e),{name:"VoiceoverIcon",svgParams:{height:24,width:24,viewBox:"0 0 24 24"},fill:"none",children:[(0,r.Y)("path",{d:"M11.8518 3.31518C12.2459 4.26329 13.551 7.10985 14.4542 8.3467C15.3764 9.60967 12.8285 9.95184 12 10.5",strokeWidth:"1.5",strokeLinecap:"round"}),(0,r.Y)("path",{d:"M12 10.5C12 10.5 12.4662 11.2332 12.7627 11.7326C13.0592 12.232 13 12.5 11.5 13C10.7772 13.2409 9.5 13.5 9.5 13.5C10.3447 13.9272 12.2664 14.1393 12.4041 14.3167C12.763 14.779 12.3241 15.4618 11.8617 15.8208C11.3994 16.1797 12.0724 18.7353 10.5 19.5C8.9276 20.2647 5.70772 19.432 3 18",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.Y)("path",{d:"M18.5 6.5L20.3544 4.8526",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.Y)("path",{d:"M18.5 15.5L20.3544 17.2545",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.Y)("path",{d:"M19.5 11.0326L22 11.0326",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}));var f=n(84605),Y=n(11510);function _(e){let{mediaUploadId:t,pub:n,post:s,duration:h,autoPlay:m,href:g,isPaywalled:b,trackingProps:_}=e,{iString:y}=(0,f.GO)(),w=(0,Y.Iu)();return(0,r.Y)(o.A,{src:"/api/v1/audio/upload/".concat(t,"/src"),pub:n,post:s,duration:h,autoPlay:m,href:g,isPaywalled:b,feature:"Add voiceover",metricsPost:s,trackingProps:null!=_?_:{},render:e=>{let{isPaywalled:t,currentTime:n,isPlaying:o,progress:s,progressBarRef:h,progressBarOnMouseDown:m,remainingTime:g,playbackRate:b,setPlaybackRate:f,togglePlayback:Y}=e;return(0,r.FD)(c.fI,{gap:8,flex:"grow",children:[!w&&(0,r.Y)(v,{}),(0,r.FD)(i.ju,{"aria-label":y("Voiceover player"),role:"region",children:[(0,r.Y)(a.e,{isPlaying:o,disabled:t,onClick:Y,size:"lg"}),t?(0,r.Y)(u,{text:y("Upgrade to paid to play voiceover")}):(0,r.FD)(i.lC,{children:[(0,r.Y)(d.EY.B4,{weight:"medium",color:"secondary",children:y("Article voiceover")}),(0,r.Y)(p.b,{currentTime:n,remainingTime:g,containerRef:h,progress:s,onMouseDown:m})]}),!t&&(0,r.Y)(l.x,{onSetPlaybackRate:f,playbackRate:b})]})]})}})}function v(){return(0,r.Y)(c.ov,{radius:"sm",height:72,width:72,flex:"auto",border:"detail",children:(0,r.Y)(b,{stroke:"var(--color-fg-secondary)"})})}},95337:function(e,t,n){"use strict";n.d(t,{K:()=>o});var r=n(4006);let i=e=>{let{children:t,href:n}=e;return(0,r.Y)(r.FK,{children:(0,r.Y)("table",{cellSpacing:"0",cellPadding:"8",border:"0",width:"100%",children:(0,r.Y)("tr",{children:(0,r.Y)("td",{align:"center",children:(0,r.Y)("a",{href:n,className:"tw-font-sans tw-text-[13px] tw-font-semibold tw-text-error",children:t})})})})})};var a=n(98111),l=n(57324);let o=e=>{let{post:t,compAlreadyExpired:n=!1}=e,o="".concat(a.T.CHECKOUT_URL,"&utm_medium=").concat(l.Jn.email,"&utm_campaign=").concat(l._9.continueYourSupport,"&utm_content=").concat(t.id);return(0,r.FD)("table",{width:"100%",cellSpacing:"0",cellPadding:"0",border:"0",className:"tw-bg-error-wash",bgcolor:"#FFFAFA",children:[(0,r.Y)("tr",{children:(0,r.Y)("td",{height:"16"})}),(0,r.Y)("tr",{children:(0,r.FD)("td",{align:"center",className:"tw-leading-5",children:[(0,r.Y)("span",{className:"tw-font-sans tw-text-base tw-font-bold tw-text-error",children:"Continue your support"}),(0,r.Y)("br",{}),n?(0,r.FD)("span",{className:"tw-font-sans tw-text-ssm tw-text-error",children:["Your free trial has ended!",(0,r.Y)("br",{}),"Continue your support to access paid-only content."]}):(0,r.FD)("span",{className:"tw-font-sans tw-text-ssm tw-text-error",children:["Subscribe now to keep your paid status. You won't be",(0,r.Y)("br",{}),"charged until your free trial ends on ",a.T.SUBSCRIPTION_EXPIRY_DATE,"."]})]})}),(0,r.Y)("tr",{children:(0,r.Y)("td",{height:"16"})}),(0,r.Y)("tr",{children:(0,r.Y)("td",{children:(0,r.Y)(i,{href:o,children:"Subscribe now"})})}),(0,r.Y)("tr",{children:(0,r.Y)("td",{height:"16"})})]})}},83628:function(e,t,n){"use strict";let r;n.d(t,{bs:()=>tA,Rv:()=>tx});var i,a=n(69277),l=n(70408),o=n(4006),s=n(31386),c=n(32485),d=n.n(c),u=n(17402),p=n(9751),h=n(83427),m=n(38893),g=n(97731);let b=e=>(0,o.FD)(g.A,(0,l._)((0,a._)({},e),{name:"PlayIconRound",svgParams:{height:24,width:24},children:[(0,o.Y)("path",{className:"outer-circle",d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",strokeWidth:"1.5",strokeLinecap:"round","stroke-linejoin":"round"}),(0,o.Y)("path",{className:"inner-triangle",d:"M10 8L16 12L10 16V8Z",strokeWidth:"1.5",strokeLinecap:"round","stroke-linejoin":"round"})]}));var f=n(84605),Y=n(82776);function _(e){var t;let{pub:n,post:r,duration:i,label:a}=e,{iString:l}=(0,f.GO)();return(0,o.Y)("table",{"data-component-name":"AudioEmbedPlayerStatic",className:"tw-w-full tw-rounded-full tw-bg-substack-wash",children:(0,o.Y)("tr",{children:(0,o.Y)("td",{className:"tw-text-center tw-font-meta tw-text-ssm tw-uppercase tw-text-substack-primary",children:(0,o.FD)("a",{href:null==r?void 0:r.canonical_url,className:d()("tw-block tw-w-full tw-p-4 tw-text-substack-primary","noUnderline-s6VF_k"),children:[(0,o.Y)(b,{className:"tw-w-max-4 tw-mr-2 tw-inline-block tw-w-4 tw-align-middle",stroke:null==(t=n.theme)?void 0:t.background_pop_color,isStatic:!0}),(0,o.FD)("span",{className:"tw-align-middle",children:[(0,Y.truncateText)(a,10)||l("Listen now")," \xb7 ",(0,Y.secondsToHHMMSS)(i||0)]})]})})})})}var v=n(98107),y=n(16460),w=n(32641),S=n(43327),k=n(47663),C=n(12988),F=n(6049),I=n(39318);let E="iconLink-hKp_3x",D={spotify:(0,I.dJ9)("/img/thefp/spotify-red.png"),apple:(0,I.dJ9)("/img/thefp/apple-red.png"),rss:(0,I.dJ9)("/img/thefp/rss-red.png")},A=e=>{let{showLinks:t,feedUrl:n}=e;return(0,o.FD)(F.ZB,{gap:12,verticalAlign:"middle",children:[t.spotify_url&&(0,o.Y)("a",{className:E,href:t.spotify_url,rel:"noreferrer noopener",target:"_blank",children:(0,o.Y)("img",{alt:"Spotify",height:20,src:D.spotify,width:20})}),t.apple_podcasts_url&&(0,o.Y)("a",{className:E,href:t.apple_podcasts_url,rel:"noreferrer noopener",target:"_blank",children:(0,o.Y)("img",{alt:"Apple Podcasts",height:20,src:D.apple,width:20})}),(0,o.Y)("a",{className:E,href:n,rel:"noreferrer noopener",target:"_blank",children:(0,o.Y)("img",{alt:"RSS",height:20,src:D.rss,width:20})})]})},x=e=>{let{youtubeUrl:t}=e;return t?(0,o.Y)("a",{className:"link-lpm56C",href:t,rel:"noopener noreferrer",target:"_blank",children:(0,o.Y)(F.ZB,{gap:8,verticalAlign:"middle",children:(0,o.Y)("img",{alt:"RSS",height:20,src:"/img/thefp/youtube-red.png",width:20})})}):null};var N=n(84297);let T=e=>{let{feedUrl:t,post:n,showLinks:r,youtubeUrl:i}=e,{title:a,canonical_url:l}=n,s=(0,N.a)(n),c="podcast"===n.type,d=!!n.video_upload_id,u=c&&r&&t||d&&i;return(0,o.FD)(F.jJ,{gap:4,children:[(0,o.Y)("div",{className:"heading-UGv4c2",children:s}),(0,o.Y)("a",{className:"link-jbVsqJ",href:l,children:a}),u&&(0,o.FD)("div",{className:"mediaLinks-AvHnB9",children:[c&&r&&t&&(0,o.Y)(A,{feedUrl:t,showLinks:r}),d&&i&&(0,o.Y)(x,{youtubeUrl:i})]})]})};var P=n(38305),O=n(49807);let B=e=>{let{bylines:t}=e;return(null==t?void 0:t.length)?(0,o.Y)("div",{className:"meta-XhipYq",children:(0,o.Y)(P.K,{array:t||[],formatter:e=>{let{id:t,name:n}=e;return(0,o.Y)("a",{className:"inheritColor-eP1Bab",href:(0,O.rfn)(t,n),children:n})},limit:3})}):null},L=e=>{let{cta:t,feedUrl:n,href:r,post:i,showLinks:a,size:l,youtubeUrl:s}=e,{iString:c}=(0,f.GO)(),u="podcast"===i.type,p=!!i.video_upload_id,h=t;return u&&a?h=c("Listen on"):p&&s&&(h=c("Watch on youtube")),(0,o.FD)(F.ZB,{gap:8,verticalAlign:"middle",children:[(0,o.Y)("div",{className:d()("button-fZfkQf",{"buttonSm-PaaWgJ":"sm"===l,"buttonMd-Lg5kyv":"md"===l}),children:(0,o.Y)("a",{href:r,children:h})}),u&&a&&n&&(0,o.Y)(A,{feedUrl:n,showLinks:a}),p&&s&&(0,o.Y)(x,{youtubeUrl:s})]})},R=e=>{let{href:t,size:n,title:r}=e;return(0,o.Y)("a",{className:"link-AiRTNr",href:t,children:(0,o.Y)("div",{className:"title-RKep04",style:{fontSize:n},children:r})})};var M=n(39891);let H=e=>{let{caption:t,cta:n,feedUrl:r,post:i,showBylines:a,showLinks:l,youtubeUrl:s}=e,{publishedBylines:c,title:d,canonical_url:u,cover_image:p,cover_image_alt:h}=i;return(0,o.FD)(F.jJ,{gap:16,style:{width:"100%"},children:[(0,o.Y)(R,{href:u,size:24,title:d}),a&&(0,o.Y)(B,{bylines:c}),p&&(0,o.Y)("a",{href:u,children:(0,o.Y)("img",{alt:null!=h?h:d,src:(0,M.dJ)(p,1100,{quality:"auto:good",smartCrop:!0}),style:{width:"auto",height:"auto",maxWidth:"100%"},width:550})}),(0,o.FD)(F.jJ,{gap:16,children:[(0,o.Y)("div",{children:t}),(0,o.Y)(L,{cta:n,feedUrl:r,href:u,post:i,showLinks:l,size:"md",youtubeUrl:s})]})]})},U=e=>{let{cta:t,feedUrl:n,post:r,showBylines:i,showLinks:a,youtubeUrl:l}=e,{publishedBylines:s,title:c,canonical_url:d,cover_image:u,cover_image_alt:p}=r;return(0,o.Y)(F.h2,{style:{width:"100%"},children:(0,o.FD)("tr",{children:[u&&(0,o.FD)(o.FK,{children:[(0,o.Y)("td",{style:{verticalAlign:"top"},width:90,children:(0,o.Y)("a",{href:d,children:(0,o.Y)("img",{alt:null!=p?p:c,src:(0,M.dJ)(u,180,{quality:"auto:good",smartCrop:!0,aspect:"1:1"}),style:{width:"auto",height:"auto",maxWidth:"100%"},width:90})})}),(0,o.Y)("td",{style:"min-width: 16px",width:16})]}),(0,o.Y)("td",{style:{verticalAlign:"top"},children:(0,o.FD)(F.jJ,{gap:16,children:[(0,o.Y)(R,{href:d,size:18,title:c}),i&&(0,o.Y)(B,{bylines:s}),(0,o.Y)(L,{cta:t,feedUrl:n,href:d,post:r,showLinks:a,size:"sm",youtubeUrl:l})]})})]})})},V=e=>{let{cta:t,feedUrl:n,post:r,showBylines:i,showLinks:a,youtubeUrl:l}=e,{publishedBylines:s,title:c,canonical_url:d}=r;return(0,o.FD)(F.jJ,{gap:16,children:[(0,o.Y)(R,{href:d,size:18,title:c}),i&&(0,o.Y)(B,{bylines:s}),(0,o.Y)(L,{cta:t,feedUrl:n,href:d,post:r,showLinks:a,size:"sm",youtubeUrl:l})]})};var j=n(41232),W=n(4016),z=n(20004);let K=e=>{var{caption:t,size:n,pub:r,cta:i,showBylines:a,youtube_url:l,show_links:s,feed_url:c}=e,u=(0,w._)(e,["caption","size","pub","cta","showBylines","youtube_url","show_links","feed_url"]);if(!u)return null;let p=(0,W.lu)({pub:r});return(0,o.Y)("div",{className:d()(z.A.digestPostEmbed,j.A.digestPostEmbed),"data-component-name":"DigestPostEmbedStatic",children:J({size:n,post:u,caption:t,isTheFP:p,cta:i,showBylines:a,mediaLinkProps:{youtubeUrl:null!=l?l:null,showLinks:null!=s?s:null,feedUrl:null!=c?c:void 0}})})},J=e=>{let{size:t,post:n,caption:r,isTheFP:i,cta:l,showBylines:s,mediaLinkProps:c}=e;switch(t){case"lg":return i?(0,o.Y)(H,(0,a._)({caption:r,cta:l,post:n,showBylines:s},c)):(0,o.Y)(S.hx,{post:n,children:q(r)});case"md":return i?(0,o.Y)(U,(0,a._)({cta:l,post:n,showBylines:s},c)):(0,o.Y)(k.J,{post:n,children:q(r)});case"sm":return i?(0,o.Y)(V,(0,a._)({cta:l,post:n,showBylines:s},c)):(0,o.Y)(C.g,{post:n});case"xs":return i?(0,o.Y)(T,(0,a._)({post:n},c)):(0,o.Y)(C.g,{post:n});default:return console.warn("unrecognized size",t),null}},q=e=>(0,o.Y)("p",{className:z.A.caption,dangerouslySetInnerHTML:{__html:e}});var G=n(79785);function $(e){let{children:t,href:n,className:r}=e;return(0,o.Y)("a",{className:d()("button primary email cta subscribe-btn",r),href:n,children:t})}var Z=n(15567);function Q(){let e=(0,G._)(["Message ",""]);return Q=function(){return e},e}let X=e=>{let{userId:t,userName:n}=e,{iTemplate:r}=(0,f.GO)();return(0,o.Y)("p",{className:"button-wrapper","data-component-name":"DirectMessageStatic",children:(0,o.Y)($,{href:(0,Z.qO)({userId:t,userName:n}),children:r(Q(),n)})})};var ee=n(27775),et=n(67078),en=n(97213),er=n(13950),ei=n(25006),ea=n(46271),el=n(86500),eo=n(12501),es=n(35369),ec=n(76977),ed=n(16993),eu=n(63136),ep=n(19256);function eh(){let e=(0,G._)(["Message ",""]);return eh=function(){return e},e}let em=e=>{let{userId:t,userName:n}=e,{iTemplate:r}=(0,f.GO)(),i=(0,ei.df)(),a=(0,ea.Jd)(),[l,s]=(0,u.useState)(!1),[c,d]=(0,u.useState)([]),[p,h]=(0,u.useState)(!1),[m,g]=(0,u.useState)(!1),[b,Y]=(0,u.useState)(!1),_=(0,O.LRz)({userId:t,userName:n}),{result:v}=(0,eo.st)({pathname:(0,O.lz6)({userId:t,userName:n}),deps:[t],auto:!0});(0,u.useEffect)(()=>{if(v){var e;s(null!=(e=v.can_dm)&&e),d(v.dm_upgrade_options||[])}},[v]);let y=r(eh(),(null==v?void 0:v.name)||n);return(0,o.Y)(o.FK,{children:(0,o.FD)(er.DH,{children:[(0,o.FD)(ec.pT,{flex:"grow",style:{marginBottom:"20px"},justifyContent:"center","data-component-name":"DirectMessageWeb",children:[!!l&&(0,o.Y)(es.$n,{priority:"primary",onClick:()=>(0,el.u4)(el.qY.DIRECT_MESSAGE_WRITER_BUTTON_CLICKED,{locked:!1}),href:(0,Z.pV)({urlParams:{user:_,utm_source:"direct-message-writer"}}),newTab:!0,leading:(0,o.Y)(ee.A,{size:20}),children:y}),!l&&(0,o.Y)(es.$n,{onClick:()=>{(0,el.u4)(el.qY.DIRECT_MESSAGE_WRITER_BUTTON_CLICKED,{locked:!0}),a?a.id===t?Y(!0):h(!0):g(!0)},priority:"secondary",leading:(0,o.Y)(et.A,{size:20}),children:y})]}),(0,o.Y)(eb,{isOpen:m,onClose:()=>g(!1),profile:v,pub:i}),(0,o.Y)(eg,{isOpen:b,onClose:()=>Y(!1)}),(0,o.Y)(ep._,{isOpen:p,onClose:()=>h(!1),profile:v,dmUpgradeOptions:c,isEditor:!0})]})})},eg=e=>{let{isOpen:t,onClose:n}=e,{iString:r}=(0,f.GO)();return(0,o.Y)(ed.aF,{width:360,isOpen:t,onClose:n,children:(0,o.Y)(ed.cw,{children:(0,o.FD)(ec.I1,{gap:16,children:[(0,o.Y)(ec.pT,{alignSelf:"center",flex:"auto",bg:"secondary",radius:"full",padding:16,children:(0,o.Y)(en.A,{size:24})}),(0,o.Y)(ec.I1,{children:(0,o.Y)(eu.EY.B2,{weight:"semibold",align:"center",children:r("You can't message yourself, but others will be able to message you via this button.")})}),(0,o.Y)(ec.I1,{children:(0,o.Y)(es.$n,{justifyContent:"center",onClick:n,priority:"secondary",children:r("Okay")})})]})})})},eb=e=>{let{isOpen:t,onClose:n,profile:r,pub:i}=e,{iString:a}=(0,f.GO)();return(0,o.Y)(ed.aF,{width:360,isOpen:t,onClose:n,children:(0,o.Y)(ed.cw,{children:(0,o.FD)(ec.I1,{gap:16,children:[(0,o.Y)(ec.pT,{alignSelf:"center",flex:"auto",bg:"secondary",radius:"full",padding:16,children:(0,o.Y)(et.A,{size:24})}),(0,o.Y)(ec.I1,{children:(0,o.Y)(eu.EY.B2,{weight:"semibold",align:"center",children:a("Sign in to send ".concat(null==r?void 0:r.name," a message"))})}),(0,o.FD)(ec.I1,{gap:8,children:[(0,o.Y)(es.$n,{justifyContent:"center",href:(0,I.a7q)({for_pub:null==i?void 0:i.subdomain}),children:a("Sign in")}),(0,o.Y)(es.$n,{justifyContent:"center",onClick:n,priority:"secondary",children:a("Maybe later")})]})]})})})};var ef=n(18999);let eY=e=>{let{href:t,children:n}=e;return t?(0,o.Y)("a",{href:t,target:"_blank",rel:"noopener",style:{textDecoration:"none"},children:n}):n};var e_=n(60177);let ev=e=>{let{src:t,alt:n,title:r,width:i,height:a,align:l,href:s,captionHtml:c}=e,u="100%"===i?I.oSl:i;return(0,o.Y)("div",{className:d()(e_.A.staticView),"data-component-name":"Image3Static",children:(0,o.Y)(eY,{href:s,children:(0,o.FD)("div",{style:(e=>{let{align:t,width:n}=e,r={};return"center"===t||"100%"===n||n>=I.oSl||(r["left"===t?"paddingRight":"paddingLeft"]=I.oSl-n),r})({align:l,width:i}),className:d()(e_.A.staticImageWrap),children:[(0,o.Y)("img",{width:u,height:a,src:(0,I.dJ9)(t,2*I.oSl),alt:n}),!c&&r&&(0,o.Y)("div",{className:d()(e_.A.caption,e_.A.static),children:r}),!!c&&(0,o.Y)("div",{className:d()(e_.A.caption,e_.A.static),dangerouslySetInnerHTML:{__html:c}})]})})})};var ey=n(52742),ew=n(33764);let eS=e=>{let{src:t,alt:n,title:r,width:i,size:a,align:l,href:s,captionHtml:c}=e,p=s||null,[h,m]=(0,u.useState)(!1),g=(0,u.useRef)(null);return(0,o.FD)("figure",{className:d()(e_.A.mediaNodeView,l&&e_.A["align-".concat(l)||""]),"data-component-name":"Image3Dynamic",children:[(0,o.Y)(ec.Ye,{className:d()(e_.A.imageContainer,e_.A[a],{[e_.A.pointer]:p,[e_.A.zoom]:!p}),onClick:()=>{s?window.open(s,"_blank"):m(!0)},children:(0,o.FD)(ec.I1,{gap:8,children:[(0,o.Y)(ew.o,{className:e_.A[a],src:t,alt:n,title:r,maxWidth:(()=>{switch(a){case"large":return I.T$x;case"full":if("undefined"!=typeof window)return window.innerWidth;return I.YL9;default:if("100%"===i)return I.EZZ;return i}})(),imageRef:g,useRetinaSizing:!0,imageIsFixedWidth:!1}),!c&&!!r&&(0,o.Y)("figcaption",{"data-component-name":"Image3DynamicTitle",className:e_.A.caption,children:r}),!!c&&(0,o.Y)("figcaption",{"data-component-name":"Image3DynamicCaption",className:e_.A.caption,dangerouslySetInnerHTML:{__html:c}})]})}),(0,o.Y)(ey.V,{isOpen:h,modalContent:[{attrs:{src:t,alt:n,title:r}}],onClose:()=>m(!1),step:0})]})};var ek=n(73653),eC=n(65113),eF=n(21805),eI=n(21471),eE=n(54515),eD=n(42114),eA=n(41873);let ex=e=>{let{mediaUpload:t,post:n,pub:r}=e;if(!t)return(0,o.Y)("div",{"data-component-name":"video-embed-player-static-missing-media",children:"Did not find video"});let i=(0,O.py2)({pub:r,post:n,mediaUploadId:t.id});return(0,o.Y)(eA.b,{mediaUpload:t,href:i})};var eN=n(74728),eT=n.n(eN);let eP={allowedTags:["pre","code","span"],allowedAttributes:{pre:["class","style","tabindex"],code:["class","style"],span:["class","style"]}};function eO(e){let{code:t,highlightedHtml:n}=e;if(n){let e=eT()(n,eP);return(0,o.Y)("div",{dangerouslySetInnerHTML:{__html:e}})}return(0,o.Y)("pre",{children:(0,o.Y)("code",{children:t})})}var eB=n(88711);function eL(e){let{code:t,language:r}=e,[i,a]=(0,u.useState)(null);return((0,u.useEffect)(()=>{n.e("65118").then(n.bind(n,30605)).then(e=>{a(()=>e.CodeBlock)})},[]),i)?(0,o.Y)(eB.v,{padding:20,children:(0,o.Y)(i,{code:t,language:r,showCopyButton:!0,showLineNumbers:!0})}):(0,o.Y)("pre",{style:{padding:20,overflow:"auto"},children:(0,o.Y)("code",{children:t})})}var eR=n(95977),eM=n(89490),eH=n(76270);function eU(e){let{equipment:t}=e,{iString:n}=(0,f.GO)();return t?(0,o.FD)(F.jJ,{gap:20,style:{width:"100%"},children:[(0,o.Y)(F.mV,{}),(0,o.FD)(F.jJ,{gap:2,children:[(0,o.Y)(eH.I5,{label:n("Equipment")}),(0,o.Y)(eH.BX,{value:t})]})]}):null}var eV=n(85345),ej=n(53448);function eW(e){let{ingredients:t}=e,{iString:n}=(0,f.GO)();return t&&0!==t.length?(0,o.FD)(F.jJ,{gap:20,style:{width:"100%"},children:[(0,o.Y)(F.mV,{}),(0,o.FD)(F.jJ,{gap:12,children:[(0,o.Y)(eV.bK,{title:n("Ingredients")}),(0,o.Y)(F.h2,{width:"100%",children:t.map((e,n)=>{let{number:r,text:i}=(0,ej.L_)(e),a=n===t.length-1;return(0,o.FD)("tr",{children:[(0,o.Y)("td",{style:{verticalAlign:"top",paddingRight:8,paddingBottom:4*!a,width:"auto"},children:(0,o.Y)(eu.EY.B3,{as:"span",weight:"semibold",children:r||""})}),(0,o.Y)("td",{style:{verticalAlign:"top",paddingBottom:4*!a},children:(0,o.Y)(eu.EY.B3,{as:"span",children:i})})]},n)})})]})]}):null}function ez(e){let{steps:t}=e,{iString:n}=(0,f.GO)();return t&&0!==t.length?(0,o.FD)(F.jJ,{gap:20,style:{width:"100%"},children:[(0,o.Y)(F.mV,{}),(0,o.FD)(F.jJ,{gap:12,children:[(0,o.Y)(eV.bK,{title:n("Preparation")}),(0,o.Y)(F.jJ,{gap:16,children:t.map((e,t)=>(0,o.FD)(F.jJ,{gap:4,children:[(0,o.FD)(eu.EY.B3,{as:"span",weight:"bold",children:[n("Step")," ",t+1]}),(0,o.Y)(eu.EY.B3,{as:"span",children:e})]},t))})]})]}):null}function eK(e){let{recipeYield:t}=e,{iString:n}=(0,f.GO)();return t?(0,o.Y)("td",{width:"25%",style:{verticalAlign:"top"},children:(0,o.FD)(F.jJ,{gap:2,children:[(0,o.Y)(eH.I5,{label:n("Serves")}),(0,o.Y)(eH.BX,{value:t})]})}):null}function eJ(e){let{values:t,getLabel:n}=e;return t&&0!==t.length?(0,o.Y)(o.FK,{children:t.map(e=>(0,o.Y)(eM.az,{display:"inline-block",paddingRight:12,paddingBottom:12,children:(0,o.Y)(eM.az,{paddingX:4,paddingY:2,bg:"secondary",radius:"xs",children:(0,o.Y)(eu.EY.B4,{as:"span",weight:"medium",children:n?n(e):e})},e)},e))}):null}function eq(e){var t;let n,r,{label:i,time:a}=e;if(0===a)return null;let l=(n=Math.floor((t=a)/60),r=t%60,n>0&&r>0?"".concat(n,"h ").concat(r,"m"):n>0?"".concat(n,"h"):"".concat(r,"m"));return(0,o.Y)("td",{width:"25%",style:{verticalAlign:"top",paddingRight:8},children:(0,o.FD)(F.jJ,{gap:2,children:[(0,o.Y)(eH.I5,{label:i}),(0,o.Y)(eH.BX,{value:l})]})})}function eG(e){let{recipe:t}=e,{iString:n}=(0,f.GO)();if(!t)return null;let r=t.metadata,i=r.prepTime||r.cookTime||r.totalTime||r.recipeYield,a=r.category||r.keywords||r.cuisine||r.diet;return(0,o.FD)(eM.az,{border:"detail",radius:"md",overflow:"hidden",children:[(0,o.Y)(eR.A,{src:(0,I.dJ9)(t.image_url,2*I.oSl),width:I.oSl,style:{width:I.oSl,height:"auto",objectFit:"cover"}}),(0,o.FD)(F.jJ,{gap:20,style:{padding:20,width:"100%"},children:[(0,o.FD)(F.jJ,{gap:12,children:[(0,o.Y)(eu.EY.H2,{weight:"heavy",children:t.name}),r.description&&(0,o.Y)(eu.EY.B3,{as:"span",children:r.description})]}),i&&(0,o.Y)(F.mV,{}),(0,o.Y)(F.h2,{width:"100%",children:(0,o.FD)("tr",{children:[(0,o.Y)(eq,{label:n("Prep time"),time:r.prepTime}),(0,o.Y)(eq,{label:n("Cook time"),time:r.cookTime}),(0,o.Y)(eq,{label:n("Total time"),time:r.totalTime}),(0,o.Y)(eK,{recipeYield:r.recipeYield})]})}),(0,o.Y)(eU,{equipment:r.tools}),(0,o.Y)(eW,{ingredients:t.ingredients||[]}),(0,o.Y)(ez,{steps:t.steps||[]}),a&&(0,o.Y)(F.mV,{}),(0,o.FD)("div",{style:{display:"block",width:"100%"},children:[(0,o.Y)(eJ,{values:r.category,getLabel:ej.F$}),(0,o.Y)(eJ,{values:r.keywords}),(0,o.Y)(eJ,{values:r.cuisine,getLabel:ej.lX}),(0,o.Y)(eJ,{values:r.diet,getLabel:ej.TD})]})]})]})}var e$=n(20956);function eZ(e){return(0,o.Y)(F.jJ,{gap:8,style:{width:"100%"},children:(0,o.Y)(e$.Y,(0,l._)((0,a._)({},e),{separator:(0,o.Y)(F.mV,{})}))})}var eQ=n(5955);function eX(e){var t;let{username:n,name:r,profile_image_url:i}=e;return(0,o.FD)(F.ZB,{gap:12,verticalAlign:"middle",children:[(0,o.Y)(F.Kb,{src:null!=(t=null==i?void 0:i.replace("_normal",""))?t:"",alt:(0,eQ.sK)(n),size:40}),(0,o.FD)(F.jJ,{children:[(0,o.Y)(eu.EY.B4,{weight:"semibold",children:r}),(0,o.FD)(eu.EY.B4,{color:"secondary",children:["@",n]})]})]})}function e0(e){let{expandedUrl:t}=e,{title:n,domain:r,image:i}=t,a="string"==typeof i?i:null==i?void 0:i.url;return(0,o.FD)(F.ZB,{gap:12,style:{width:"100%",padding:12,backgroundColor:"#f7f7f7",borderRadius:8},children:[(0,o.FD)(F.jJ,{gap:2,children:[r&&(0,o.Y)(eu.EY.B4,{color:"secondary",children:r}),n&&(0,o.Y)(eu.EY.B3,{weight:"medium",children:n})]}),a&&(0,o.Y)(e1,{src:a,alt:n})]})}function e1(e){let{src:t,alt:n}=e;return(0,o.Y)("td",{style:{width:64},children:(0,o.Y)("img",{src:(0,O.dJ9)(t,128,{aspect:"1:1",crop:"fill"}),alt:n||"Link preview",width:64,height:64,style:{borderRadius:8,objectFit:"cover"}})})}function e2(e){let{photos:t}=e;return t&&0!==t.length&&t[0]?(0,o.Y)(eR.A,{src:(0,O.dJ9)(t[0].img_url,550),alt:t[0].alt_text||"Image",style:{display:"inline",width:"auto",height:"auto",maxWidth:"100%",maxHeight:420,borderRadius:8}}):null}function e4(e){let{quotedTweet:t}=e;if(!(null==t?void 0:t.full_text))return null;let n=t.full_text.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();return(0,o.Y)(F.h2,{width:"100%",style:{border:"1px solid #eeeeee",borderRadius:8,padding:12},children:(0,o.Y)("tr",{children:(0,o.Y)("td",{children:(0,o.FD)(F.jJ,{gap:8,children:[(0,o.FD)(F.ZB,{gap:8,verticalAlign:"middle",children:[t.username&&(0,o.Y)(F.Kb,{src:(0,eQ.Wk)(t.username,20),size:20}),(0,o.FD)(eu.EY.B4,{children:[(0,o.Y)("span",{style:{fontWeight:600},children:t.name||""})," ",(0,o.FD)("span",{style:{color:"#888888"},children:["@",t.username]})]})]}),(0,o.Y)(eu.EY.B3,{children:n})]})})})})}var e3=n(98505);function e6(e){let{fullText:t}=e,n=t.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();return(0,o.Y)(eu.EY.B3,{style:{whiteSpace:"pre-wrap"},className:e3.A.text,children:n})}function e7(e){let{attrs:t}=e,{url:n,full_text:r,username:i,name:a,profile_image_url:l,date:s,photos:c,quoted_tweet:d,expanded_url:u,retweet_count:p,like_count:h,reply_count:m,impression_count:g}=t,b=c&&c.length>0,f=d&&Object.keys(d).length>0;return(0,o.Y)(F.h2,{className:"twitter-embed tweet",width:"100%","data-component-name":"TweetToDOMStatic",style:{marginBottom:20,marginTop:20},children:(0,o.Y)("tbody",{children:(0,o.Y)("tr",{children:(0,o.Y)("td",{style:{padding:0},children:(0,o.Y)("a",{href:n,style:{textDecoration:"none",color:"inherit",display:"block"},children:(0,o.FD)(F.jJ,{gap:12,children:[(0,o.Y)(eX,{username:i,name:a,profile_image_url:l}),(0,o.Y)(e6,{fullText:r}),b&&(0,o.Y)(e2,{photos:c}),!b&&!f&&null!=u&&(0,o.Y)(e0,{expandedUrl:u}),f&&(0,o.Y)(e4,{quotedTweet:d}),(0,o.Y)(eZ,{date:s,replyCount:m,retweetCount:p,likeCount:h,impressionCount:g})]})})})})})})}var e5=n(78622),e8=n(65942),e9=n(64998),te=n(64099),tt=n(93038),tn=n(79391),tr=n(47970),ti=n(43427);n(15074);let ta=e=>(0,o.FD)(g.A,(0,l._)((0,a._)({},e),{name:"MoreIcon",svgParams:{height:24,width:24,fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth},children:[(0,o.Y)("path",{d:"M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z"}),(0,o.Y)("path",{d:"M19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12C18 12.5523 18.4477 13 19 13Z"}),(0,o.Y)("path",{d:"M5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13Z"})]}));var tl=n(58299),to=n(85796),ts=n(42686);n(49095),n(14124);var tc=n(16291),td=n(56262);function tu(e){var t,n,r,i,a,l,s,c,d;let{comment:u,utmSource:p,hideUfi:h,commentLinkUrl:m}=e;if(!u)return(0,o.Y)(eu.EY.B3,{"data-component-name":"EmailCommentEmbedError",translated:!0,children:"Could not load comment"});let g=null==(t=u.attachments)?void 0:t.find(e=>"image"===e.type),b=null==(n=u.attachments)?void 0:n.find(e=>"post"===e.type),f=null==b?void 0:b.postSelection,_=null==(r=u.attachments)?void 0:r.find(e=>"image"!==e.type),v=_&&(0,ts.hH)(_),y=null==(i=u.attachments)?void 0:i.find(e=>"video"===e.type);return(0,o.Y)(eM.az,{as:"a",href:null!=m?m:(0,O.Zgx)(u,{urlParams:{utm_source:p}}),display:"block",padding:16,radius:"md",border:"detail",color:"primary",className:"note-flsrqQ","data-component-name":"EmailCommentEmbed",children:(0,o.FD)(F.ZB,{style:{width:"100%"},verticalAlign:"top",gap:12,growLastChild:!0,children:[(0,o.Y)(F.Kb,{src:null!=(l=u.photo_url)?l:(0,I.Ji1)(null!=(a=u.user_id)?a:0),size:48}),(0,o.FD)(F.jJ,{gap:12,style:{lineHeight:1,width:"100%"},children:[(0,o.FD)(eM.az,{children:[(0,o.FD)(eu.EY.B3,{children:[(0,o.Y)(eu.EY,{as:"span",weight:"semibold",children:u.name})," ",(0,o.Y)(eu.EY,{as:"span",color:"secondary",children:(0,tc.A)(u.date).fromNowShort()})]}),(0,o.Y)(eu.EY.B3,{children:(0,Y.truncateWords)(u.body,420)})]}),b&&f&&(0,o.Y)(eu.EY.B3,{children:(0,o.Y)(tg,{attachment:b,selection:f})}),v&&!b&&(0,o.Y)(eu.EY.B4,{color:"highlight",children:v}),y&&(0,o.Y)(tf,{attachment:y}),g&&(0,o.Y)(tb,{attachment:g}),!h&&(0,o.Y)(F.h2,{width:"100%",style:{width:"100%"},children:(0,o.FD)("tr",{children:[(0,o.FD)("td",{width:"20%",children:[(0,o.Y)(ti.A,{width:16,height:16,strokeWidth:1.5,stroke:tm,style:tp,fill:"none",isStatic:!0}),(0,o.Y)(th,{count:null!=(s=u.reaction_count)?s:0})]}),(0,o.FD)("td",{width:"20%",children:[(0,o.Y)(to.A,{height:16,width:16,strokeWidth:1.5,stroke:tm,style:tp,isStatic:!0}),(0,o.Y)(th,{count:null!=(c=u.children_count)?c:0})]}),(0,o.FD)("td",{width:"20%",children:[(0,o.Y)(tl.A,{height:16,width:16,strokeWidth:1.5,stroke:tm,style:tp,isStatic:!0}),(0,o.Y)(th,{count:null!=(d=u.restacks)?d:0})]}),(0,o.Y)("td",{width:"20%",children:(0,o.Y)(ta,{height:16,width:16,strokeWidth:2,stroke:tm,fill:tm,style:tp,isStatic:!0})})]})})]})]})})}let tp={display:"inline-block",verticalAlign:"middle"};function th(e){let{count:t}=e;return(0,o.Y)(eu.EY.B4,{size:12,as:"span",weight:"semibold",color:"secondary",style:{marginLeft:4},children:t>0?(0,Y.numberToRoughShortString)(Math.max(t,1),{plusSignifier:""}):" "})}let tm="#808080";function tg(e){let{attachment:t,selection:n}=e;return(0,o.Y)(eM.az,{padding:12,radius:"md",bg:"secondary",children:(0,o.FD)(eu.EY,{color:"secondary",font:"serif",fontStyle:"italic",lineHeight:24,children:[(0,Y.truncateWords)(n.text.replaceAll("â€œ","â€˜").replaceAll("â€","â€™"),180),"â€ â€” ",(0,td.getPostAuthor)(t.publication,t.post).name]})})}function tb(e){let{attachment:t}=e;return(0,o.Y)(eM.az,{as:"img",src:(0,O.dJ9)(t.imageUrl,800,{crop:"limit",height:800}),width:400,radius:"md",style:{maxHeight:600,objectFit:"cover",margin:0}})}function tf(e){let{attachment:t}=e,n=t.mediaUpload;return(0,o.Y)(eM.az,{as:"img",src:(0,I.Pzx)(n,{isStatic:!0}),width:400,radius:"md",style:{maxHeight:600,objectFit:"cover",margin:0}})}var tY=n(68349),t_=n(51131),tv=n(30192),ty=n(98111),tw=n(41086),tS=n(98949),tk=n(5035),tC=n(8283);let tF=(e,t)=>(0,o.Y)(f.Pz,{language:t,children:e}),tI=function(e,t){var n,r,i,c,d,g;let{shallow:b}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("A"!==e.nodeName||e.getAttribute("rel")||e.setAttribute("rel","pub"in t&&(null==(r=t.pub)?void 0:r.no_follow)?"nofollow ugc noopener":""),(0,tY.nB)(e,"image2")&&e.classList.add("can-restack"),"pub"in t&&t.pub&&"P"===e.nodeName&&(0,tY.nB)(e,"button-wrapper")){let n=((e,t)=>{try{let n=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));if(["".concat(t.pub.base_url,"/subscribe?"),"".concat(t.pub.base_url,"/subscribe?plan=founding"),ty.T.CHECKOUT_URL,ty.T.FOUNDING_CHECKOUT_URL].includes(n.url)){let n=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));return(0,o.Y)(tn.A,(0,a._)({pub:t.pub,subscribeButtonAttrs:n},t.props))}}catch(e){console.error("Failed to parse button:",e)}return null})(e,t);if(n)return n}let f="pub"in t&&(null==(n=t.pub)?void 0:n.language)||"en";return(0,tY.nB)(e,"subscription-widget-wrap-editor")||(0,tY.nB)(e,"subscription-widget-wrap")?tF((0,o.Y)("div",{className:"subscription-widget-wrap",children:(0,o.FD)("div",{className:"subscription-widget show-subscribe",children:[(0,o.Y)("div",{className:"preamble",children:(0,o.Y)("p",{dangerouslySetInnerHTML:{__html:null!=(g=null==(d=e.children[0])||null==(c=d.children[0])||null==(i=c.children[0])?void 0:i.innerHTML)?g:""}})}),(0,o.Y)(tn.A,(0,a._)({pub:t.pub,subscribeButtonAttrs:null,source:"subscribe-widget-preamble"},t.props))]})}),f):(0,tY.nB)(e,"cashtag-wrap")?tF((e=>{try{let t=JSON.parse(e.dataset.attrs).symbol;if(t)return(0,o.Y)(v.A,{symbol:t,prependSymbol:JSON.parse(e.dataset.attrs).prependSymbol,isStatic:JSON.parse(e.dataset.attrs).isStatic});return(0,o.Y)(o.FK,{})}catch(e){return console.error("failed to parse cashtag"),(0,o.Y)(o.FK,{})}})(e),f):(0,tY.nB)(e,"mention-wrap")?tF((e=>{try{let{name:t,id:n,type:r,url:i,photo_url:a,uuid:l,isStatic:s}=JSON.parse(e.dataset.attrs);if(t)return(0,o.Y)(tt.Ay,{name:t,id:n,type:r,url:i,photo_url:a,uuid:l,isStatic:s});return(0,o.Y)(o.FK,{})}catch(e){return(0,o.Y)(o.FK,{})}})(e),f):"pub"in t&&t.pub&&(0,tY.nB)(e,"native-audio-url-embed")?tF(((e,t)=>{let{pub:n,props:{isStatic:r,post:i}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,e8.A)(t));return r?(0,o.Y)(_,{label:e.label,pub:n,post:i,duration:e.duration}):(0,o.Y)(m.$g,{label:e.label,pub:n,post:i,src:e.url,duration:e.duration,downloadable:e.downloadable,autoPlay:!1})}}catch(e){console.error("Failed to parse audio:",e)}return null})(e,t),f):"pub"in t&&t.pub&&(0,tY.nB)(e,"native-audio-embed")?tF(((e,t)=>{let{pub:n,props:{isStatic:r,post:i}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,e8.A)(t));return r?(0,o.Y)(_,{label:e.label,pub:n,post:i,duration:e.duration}):(0,o.Y)(m.$g,{label:e.label,pub:n,post:i,src:"/api/v1/audio/upload/".concat(e.mediaUploadId,"/src"),duration:e.duration,downloadable:e.downloadable,autoPlay:!1,mediaUpload:{id:e.mediaUploadId}})}}catch(e){console.error("Failed to parse audio:",e)}return null})(e,t),f):"pub"in t&&t.pub&&(0,tY.nB)(e,"native-video-embed")?tF(((e,t)=>{let{pub:n,props:{isStatic:r,post:i,dataForEmailRender:a}}=t;try{let t=e.getAttribute("data-attrs");if(t){let{mediaUploadId:e}=JSON.parse((0,e8.A)(t));if(r){var l,s;return(0,o.Y)(ex,{pub:n,post:i,mediaUpload:null!=(s=null==(l=a.idToMediaUpload)?void 0:l[e])?s:null})}return(0,o.Y)(eD.i,{pub:n,post:i,mediaUploadId:e})}}catch(e){console.error("Failed to parse video:",e)}return(0,o.Y)(o.FK,{})})(e,t),f):"pub"in t&&t.pub&&(0,tY.nB)(e,"meeting-embed")?tF(((e,t)=>{let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs");if(t){let{name:e,avatarUrl:r,url:i}=JSON.parse((0,e8.A)(t));return n?(0,o.Y)(t_.D,{name:e,avatarUrl:r,url:i}):(0,o.Y)(t_.l,{name:e,avatarUrl:r,url:i})}}catch(e){console.error("Failed to parse audio:",e)}return null})(e,t),f):(0,tY.nB)(e,"poll-embed")?tF(((e,t)=>{try{let i=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));if(null==i?void 0:i.isEmail){var n,r;return(0,o.Y)("table",{className:"poll-embed poll-email",cellSpacing:"16px",width:"100%",children:(0,o.Y)("tbody",{children:(0,o.Y)("tr",{children:(0,o.Y)("td",{align:"center",children:(0,o.Y)(e9.a1,{id:i.id,embeddedPolls:null!=(r=null==(n=t.props.dataForEmailRender)?void 0:n.embeddedPolls)?r:[],pub:t.pub})})})})})}return(0,o.Y)("div",{className:"poll-embed",dataAttrs:e.getAttribute("data-attrs"),children:(0,o.Y)(e9.sP,{id:i.id,isEditor:!1,post:t.props.post,isVersionView:!!t.props.isVersionView})})}catch(e){return console.error("Failed to parse poll:",e),(0,o.Y)(o.FK,{})}})(e,t),f):(0,tY.nB)(e,"recipe-embed")?tF(((e,t)=>{try{let r=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));if(null==r?void 0:r.isEmail){var n;let e=null==(n=t.props.dataForEmailRender)?void 0:n.recipes[r.id];return(0,o.Y)("table",{className:"recipe-embed",width:"100%",cellPadding:"0",cellSpacing:"0",style:{marginBottom:20},children:(0,o.Y)("tbody",{children:(0,o.Y)("tr",{children:(0,o.Y)("td",{style:{padding:0},children:(0,o.Y)(eG,{recipe:e})})})})})}return(0,o.Y)("div",{"data-attrs":e.getAttribute("data-attrs"),children:(0,o.Y)(eV.h5,{node:{attrs:{id:r.id}},post:t.props.post})})}catch(e){return console.warn("Failed to parse recipe:",e),(0,o.Y)(o.FK,{})}})(e,t),f):(0,tY.nB)(e,"twitter-embed")?tF((e=>{try{let t=e.getAttribute("data-attrs");if(!t)return(0,o.Y)(o.FK,{});let n=JSON.parse((0,e8.A)(t));if(n.isEmail)return(0,o.Y)(e7,{attrs:n});return(0,o.Y)(e5.K,{attrs:n})}catch(e){return console.warn("Failed to parse tweet:",e),(0,o.Y)(o.FK,{})}})(e),f):(0,tY.nB)(e,tk._1)?tF(((e,t)=>{let{props:{isStatic:n,dataForEmailRender:r}}=t;try{let t=e.getAttribute("data-attrs");if(!t)return(0,o.Y)(o.FK,{});let l=JSON.parse((0,e8.A)(t)),s=e.textContent||"";if(n){var i,a;let e=l.nodeId?null==r||null==(a=r.idToHighlightedCodeBlock)||null==(i=a[l.nodeId])?void 0:i.highlightedHtml:void 0;return(0,o.Y)(eO,{code:s,highlightedHtml:e})}return(0,o.Y)(eL,{code:s,language:l.language})}catch(e){return console.warn("Failed to parse highlighted code block:",e),(0,o.Y)(o.FK,{})}})(e,t),f):(0,tY.nB)(e,"pinterest-embed")?tF((e=>{try{let t=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));return(0,o.Y)(ek.L,{attrs:t})}catch(e){console.error("Failed to parse pinterest:",e)}return(0,o.Y)(o.FK,{})})(e),f):(0,tY.nB)(e,"polymarket-embed")?tF((e=>{try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,e8.A)(t));return(0,o.Y)(eC.t,{attrs:e})}}catch(e){console.error("Failed to parse polymarket:",e)}return(0,o.Y)(o.FK,{})})(e),f):(0,tY.nB)(e,"sponsorship-campaign-embed")?tF(((e,t)=>{var n,r,i,a,l,s,c,d,u,p,h;let m=null!=(c=null==(r=t.props)||null==(n=r.post)?void 0:n.sponsorshipCampaigns)?c:null==(a=t.props)||null==(i=a.dataForEmailRender)?void 0:i.sponsorshipCampaigns;if(!m)return(0,o.Y)(o.FK,{});let g=e.getAttribute("data-attrs"),b=m[JSON.parse((0,e8.A)(g)).id];if(!b||"archived"===b.status)return(0,o.Y)(o.FK,{});let f=b.exclude_audience_minimum;if("paid"===f&&!1===t.props.is_freemail||"paid"===f&&(null==(l=t.props.user)?void 0:l.is_subscribed)||"founding"===f&&(null==(s=t.props.user)?void 0:s.is_founding))return(0,o.Y)(o.FK,{});try{let n=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));if(null==n?void 0:n.isEmail)return(0,o.Y)(eE._U,{campaign:b,pub:t.pub,post:null!=(h=null==(u=t.props)?void 0:u.republishingPost)?h:null==(p=t.props)?void 0:p.post});return(0,o.Y)(eE.eF,{dataAttrs:e.getAttribute("data-attrs"),pub:t.pub,campaign:b,post:null==(d=t.props)?void 0:d.post})}catch(e){return console.warn("Failed to parse sponsorship campaign:",e),(0,o.Y)(o.FK,{})}})(e,t),f):(0,tY.nB)(e,"fp-recirc-block")?tF(((e,t)=>{try{let n=JSON.parse((0,e8.A)(e.getAttribute("data-attrs")));if(n.isEmail)return(0,o.Y)(ef.O,(0,a._)({pub:t.pub},n));return(0,o.Y)(ef.u,(0,a._)({pub:t.pub,isEditor:!1},n))}catch(e){return console.warn("Failed to parse stories section:",e),(0,o.Y)(o.FK,{})}})(e,t),f):(0,tY.nB)(e,"image-gallery-embed")?tF(((e,t)=>{let{pub:n,props:{isStatic:r,post:i,onLike:s}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse(t),c={node:{attrs:(0,l._)((0,a._)({},e),{isEditor:!1})}};return r?(0,o.Y)(eF.a9,(0,a._)({},c)):(0,o.Y)(eF.i_,(0,l._)((0,a._)({},c),{post:i,publication:n,onLike:s}))}}catch(e){console.error("Failed to parse image gallery embed:",e)}return(0,o.Y)(o.FK,{})})(e,t),f):(0,tY.nB)(e,"image3")?tF(((e,t)=>{let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs");if(t){var r;let i=null!=(r=JSON.parse(t))?r:{};return n?(0,o.Y)(ev,(0,l._)((0,a._)({},i),{captionHtml:e.innerHTML})):(0,o.Y)(eS,(0,l._)((0,a._)({},i),{captionHtml:e.innerHTML}))}}catch(e){console.error("Failed to parse image3:",e)}return(0,o.Y)(o.FK,{})})(e,t),f):(0,tY.nB)(e,"directMessage")?tF(((e,t)=>{let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse(t),r=(0,a._)({},e);return n?(0,o.Y)(X,(0,a._)({},r)):(0,o.Y)(em,(0,a._)({},r))}}catch(e){console.error("Failed to parse direct message embed:",e)}return(0,o.Y)(o.FK,{})})(e,t),f):(0,tY.nB)(e,"latex-rendered")?tF(((e,t)=>{let{pub:n,props:{isStatic:r}}=t,{iString:i}=I18N.i({pub:n});try{if(r){let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,e8.A)(t)),n=null==e?void 0:e.persistentExpression;return n?(0,o.Y)("img",{src:(0,I.Ojn)(n),style:{transform:"scale(0.5)"},"data-component-name":"LatexImg"}):(0,o.Y)("p",{children:i("Failed to render LaTeX expression â€” no expression found in email")})}return(0,o.Y)("p",{children:i("Failed to render LaTeX expression â€” data attributes not found")})}let t=e.getAttribute("data-attrs"),n=JSON.parse((0,e8.A)(t)),a=null==n?void 0:n.persistentExpression;return a?(0,o.Y)(ec.Ye,{className:"latex-rendered",justifyContent:"center",flex:"grow",paddingBottom:"4px",paddingTop:"4px","data-component-name":"Latex",children:(0,o.Y)(ec.I1,{justifyContent:"center",children:(0,o.Y)(s.A,{inline:!1,children:"\\(".concat(a,"\\)")})})}):(0,o.Y)("p",{children:i("Failed to render LaTeX expression â€” no expression found")})}catch(e){return console.error("failed to render mathjax",e),(0,o.Y)("p",{children:i("Failed to render LaTeX expression â€” error")})}})(e,t),f):(0,tY.nB)(e,"community-chat")?tF(function(e,t){let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs"),r=JSON.parse((0,e8.A)(t));if(!r.pub||!r.subdomain)return console.error("could not deepPrepare communityChat, subdomain or pub missing from node"),(0,o.Y)(u.Fragment,{});return(0,o.Y)("div",{className:"community-chat",dataAttrs:t,children:n?(0,o.Y)(p.$,(0,a._)({},r)):(0,o.Y)(p.b,{pub:r.pub,subdomain:r.subdomain})})}catch(e){return console.error("Failed to parse chat embed:",e),(0,o.Y)(u.Fragment,{})}}(e,t),f):(0,tY.nB)(e,"community-post")?tF(function(e,t){let{props:{isStatic:n,is_freemail:r}}=t;try{let t=e.getAttribute("data-attrs"),i=JSON.parse((0,e8.A)(t));return n?(0,o.Y)(h.T,(0,a._)({is_freemail:r},i)):(0,o.Y)(h.B,(0,a._)({},i))}catch(e){return console.error("Failed to parse chat post embed:",e),(0,o.Y)(u.Fragment,{})}}(e,t),f):(0,tY.nB)(e,"digest-post-embed")?tF(((e,t)=>{let{pub:n,props:{isStatic:r,dataForEmailRender:i,useEnhancedVideoEmbed:s}}=t;try{let t=e.getAttribute("data-attrs");if(t){var c;let e=JSON.parse((0,e8.A)(t)),d=null==i||null==(c=i.postIdToHeroVideo)?void 0:c[e.id],u=e.canonical_url,p="lg"===e.size;if(s&&r&&d&&u&&p)return(0,o.Y)(eA.b,{mediaUpload:d,href:u});return r?(0,o.Y)(K,(0,l._)((0,a._)({},e),{pub:n,isEditor:!1})):(0,o.Y)(y.S,(0,l._)((0,a._)({},e),{pub:n,isEditor:!1}))}}catch(e){console.error("Failed to parse digest post embed:",e)}return(0,o.Y)(o.FK,{})})(e,t),f):(0,tY.nB)(e,"comment")&&!(0,tY.nB)(e,"template-comment")?tF(function(e,t){let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs"),r=JSON.parse((0,e8.A)(t));return n?(0,o.Y)(tu,(0,a._)({},r)):(0,o.Y)(tr.H,(0,a._)({},r))}catch(e){return console.error("Failed to parse chat post embed:",e),(0,o.Y)(u.Fragment,{})}}(e,t),f):(0,tY.nB)(e,"referrals-tier-card")?tF(((e,t)=>{let{pub:n,props:{isStatic:r}}=t;try{let t=e.getAttribute("data-attrs"),i=JSON.parse((0,e8.A)(t));return r?(0,o.Y)(eI.F,(0,l._)((0,a._)({},i),{pub:n})):(0,o.Y)(eI.P,(0,l._)((0,a._)({},i),{pub:n}))}catch(e){console.error("Failed to parse referrals card:",e)}return(0,o.Y)(o.FK,{})})(e,t),f):("undefined"!=typeof window&&(0,tY.nB)(e,"file-embed-button")&&"href"in e&&e.href&&!(0,tw.y)(e.href,"token")&&(e.href=(0,I.yRP)(e.href,{token:(0,tw.y)(window._preloads.original_url,"token")})),"props"in t&&t.props&&"post"in t.props&&t.props.post&&"object"==typeof t.props.post&&"id"in t.props.post&&t.props.post.id&&(0,tY.nB)(e,"footnote")&&(e.id&&(e.id+="-".concat(t.props.post.id)),"href"in e&&e.href&&(e.href+="-".concat(t.props.post.id))),(0,tY.nB)(e,"footnote-anchor"))?tF(((e,t,n)=>{var r;let[i,,a]=e.id.split("-"),l=null==(r=n.wrapper.querySelector("#".concat(i,"-").concat(a)))?void 0:r.nextElementSibling;return l?((0,tS.Fr)()&&(e.href="#_"),(0,o.Y)(tv.j,{trigger:tD(e,t,n),children:(0,o.Y)(eM.az,{padding:12,maxWidth:360,sizing:"border-box",className:"markup typography footnote-hovercard",children:tD(l,t,n)})})):tD(e,t,n)})(e,tI,t),f):b?null:tD(e,tI,t)},tE=function(e){let t={};for(let{name:n,value:r}of Array.prototype.slice.call(e))t[n]=r;return t},tD=(i=(e,t,n,r)=>{var i,s,c,p,h;if(!e)throw Error("Empty node, cannot preactify!");let m=3===e.nodeType?"span":8===e.nodeType?"x_preact_compatible_html_comment_x":e.tagName.toLowerCase(),g=1!==e.nodeType?{}:tE(e.attributes),b=e.children&&e.children.length>0?null:e.textContent;if(r||"script"===m&&e.innerHTML===tC.I)return(0,u.createElement)(m,(0,l._)((0,a._)({},g),{dangerouslySetInnerHTML:{__html:e.innerHTML}}));let f=!!(null==(i=e.parentElement)?void 0:i.getAttribute("data-prose-mirror-wrapper"));if(n&&"pub"in n&&f&&["h1","h2","h3","h4"].includes(m)&&!e.className){let t,r;return t=d()("header-anchor-post",g.className),r=e.children.length?Array.prototype.map.call(e.childNodes,e=>tI(e,n)):[e.textContent],(0,u.createElement)(m,(0,l._)((0,a._)({},g),{className:t}),...r,(0,o.Y)(te.A,{text:null!=(p=e.textContent)?p:"",pub:null==n?void 0:n.pub,post:null==n||null==(s=n.props)?void 0:s.post,offsetTop:!0,isAboutPage:null!=(h=null==n||null==(c=n.props)?void 0:c.isAboutPage)&&h}))}if(b)return(0,u.createElement)(m,g,b);let Y=t(e,n,{shallow:!0});return Y||(0,u.createElement)(m,g,...Array.prototype.map.call(e.childNodes,e=>t(e,n)))},r=0,function(){let e=[].slice.call(arguments,0),t=++r>2500;if(t){var n,a,l;console.error("Too many post nodes to recurse",{postId:null==(l=e[2])||null==(a=l.props)||null==(n=a.post)?void 0:n.id,depth:r})}let o=i.apply(null,[...e,...t?[!0]:[]]);return r--,o});function tA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("div");return r.setAttribute("data-prose-mirror-wrapper","1"),r.innerHTML=e,Array.prototype.map.call(r.childNodes,e=>tD(e,tI,{wrapper:r,pub:t,props:n}))}function tx(e,t){if("undefined"==typeof window)return[];let n=document.createElement("div");n.innerHTML=e;let r=[];for(let e of n.querySelectorAll(null!=t?t:"h1, h2, h3, h4")){var i,a;let t=e.tagName[1],n=t?parseInt(t):NaN;r.push({level:null!=n?n:0,text:null!=(i=e.textContent)?i:"",id:null!=(a=e.id)?a:""})}return r}},64099:function(e,t,n){"use strict";n.d(t,{A:()=>f});var r=n(4006),i=n(32485),a=n.n(i),l=n(82853),o=n(17402),s=n(13950),c=n(8609),d=n(86500),u=n(72569),p=n(89490),h=n(35369),m=n(76977),g=n(58278),b=n(39318);function f(e){let{text:t,post:n,pub:i,offsetTop:f,isAboutPage:Y}=e,_=(0,o.useContext)(c.a),{isStatic:v}=null!=_?_:{isStatic:!1},y=(0,u.c)(),w=(0,g.HN)(t,(null==n?void 0:n.id)||0);if(!n&&!Y||!i||v)return null;let S=Y?"".concat((0,b.DNs)(i,{addBase:!0}),"#\xa7").concat(w):"".concat((0,b.$_T)(i),"/i/").concat(null==n?void 0:n.id,"/").concat(w);return(0,r.Y)(m.pT,{position:"absolute",alignItems:"center",className:"header-anchor-parent",children:(0,r.FD)(s.DH,{children:[(0,r.Y)(p.az,{className:a()("header-anchor",{"offset-top":f}),id:"\xa7".concat(w)}),(0,r.Y)(h.K0,{priority:"secondary",rounded:!1,size:"sm",onClick:e=>{var t;(null==(t=location)?void 0:t.href)&&(e.preventDefault(),(0,d.u4)(d.qY.HEADER_ANCHOR_WIDGET_CLICKED,{destination:S}),y(S))},href:S,children:(0,r.Y)(l.A,{size:18})})]})})}},17436:function(e,t,n){"use strict";n.d(t,{A:()=>o});var r=n(69277),i=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.Y)(l.A,(0,i._)((0,r._)({},e),{name:"EmailIcon",svgParams:{height:25,width:25,strokeWidth:0,fill:"#000Z"},children:(0,a.Y)("g",{children:(0,a.Y)("path",{d:"M22.93,7a2.43,2.43,0,0,0-.41-.93A2.61,2.61,0,0,0,20.39,5H4.61A2.61,2.61,0,0,0,2.48,6.1,2.43,2.43,0,0,0,2.07,7h0A2.78,2.78,0,0,0,2,7.61v9.78A2.61,2.61,0,0,0,4.61,20H20.39A2.61,2.61,0,0,0,23,17.39V7.61A2.25,2.25,0,0,0,22.93,7ZM4.61,6H20.39a1.58,1.58,0,0,1,1.26.62l-8.91,5.31a.49.49,0,0,1-.47,0L3.35,6.62A1.58,1.58,0,0,1,4.61,6ZM22,17.39A1.61,1.61,0,0,1,20.39,19H4.61A1.61,1.61,0,0,1,3,17.39V7.58l8.77,5.22a1.48,1.48,0,0,0,1.47,0L22,7.58Z"})})}))},12293:function(e,t,n){"use strict";n.d(t,{A:()=>c});var r=n(69277),i=n(70408),a=n(32641),l=n(4006),o=n(97731),s=n(57753);let c=e=>{var{isHovered:t}=e,n=(0,a._)(e,["isHovered"]);let c=t?s.Q3.brightOrange.hex:s.Q3.lightGray.hex;return(0,l.FD)(o.A,(0,i._)((0,r._)({},n),{name:"FPCommentIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",stroke:"none",fill:"none"},children:[(0,l.Y)("path",{d:"M22.1538 1V2.83333H24V15.6667H22.1538V17.5H16.6154V19.3333H14.7692V21.1667H12.9231V23H11.0769V21.1667H9.23077V19.3333H7.38462V17.5H1.84615V15.6667H0V2.83333H1.84615V1H22.1538Z",fill:c}),(0,l.Y)("rect",{x:"5",y:"9",width:"2",height:"2",fill:"white"}),(0,l.Y)("rect",{x:"11",y:"9",width:"2",height:"2",fill:"white"}),(0,l.Y)("rect",{x:"17",y:"9",width:"2",height:"2",fill:"white"})]}))}},80703:function(e,t,n){"use strict";n.d(t,{A:()=>c});var r=n(69277),i=n(70408),a=n(32641),l=n(4006),o=n(97731),s=n(57753);let c=e=>{var{isHovered:t}=e,n=(0,a._)(e,["isHovered"]);let c=t?s.Q3.brightOrange.hex:s.Q3.lightGray.hex;return(0,l.FD)(o.A,(0,i._)((0,r._)({},n),{name:"FPShareIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"none"},children:[(0,l.Y)("path",{d:"M5 10H1V22H3V24H21V22H23V10H19V20H5V10Z",fill:c}),(0,l.Y)("path",{d:"M11 0H13V2H15V4H17V6H19V8H15V17H9V8H5V6H7V4H9V2H11V0Z",fill:c})]}))}},54158:function(e,t,n){"use strict";n.d(t,{A:()=>s});var r=n(69277),i=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{color:t="#B6B6B6",height:n=18}=e,s=(0,a._)(e,["color","height"]);return(0,l.FD)(o.A,(0,i._)((0,r._)({},s),{height:n,name:"LockFullIcon",svgParams:{height:18,width:18,viewBox:"0 0 18 18"},children:[(0,l.Y)("rect",{x:"5.5",y:"2.5",width:"7",height:"13",rx:"3.5",stroke:t,fill:"none"}),(0,l.Y)("rect",{x:"3.5",y:"8.5",width:"11",height:"8",rx:"0.5",fill:t,stroke:t})]}))}},59821:function(e,t,n){"use strict";n.d(t,{A:()=>s});var r=n(69277),i=n(70408),a=n(4006),l=n(41181),o=n(97731);let s=e=>(0,a.Y)(o.A,(0,i._)((0,r._)({},e),{name:"LucideRecommend",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,a.Y)(l.A,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},15052:function(e,t,n){"use strict";n.d(t,{A:()=>s});var r=n(69277),i=n(70408),a=n(32641),l=n(4006),o=n(97731);let s=e=>{var{stroke:t="black"}=e,n=(0,a._)(e,["stroke"]);return(0,l.Y)(o.A,(0,i._)((0,r._)({},n),{name:"ThreadIcon",svgParams:{height:19,width:19},children:(0,l.Y)("path",{d:"M10.4286 3H8.57143C5.49441 3 3 5.49441 3 8.57143C3 10.2355 4.16477 12.1934 5.32143 13.2143V16L11.3571 14.1429C14.6071 13.067 16 10.9973 16 8.57143C16 5.49441 13.5056 3 10.4286 3Z",stroke:t,"stroke-linejoin":"round"})}))}},53868:function(e,t,n){"use strict";n.d(t,{A:()=>o});var r=n(69277),i=n(70408),a=n(4006),l=n(97731);let o=e=>(0,a.FD)(l.A,(0,i._)((0,r._)({},e),{name:"UsersIcon",svgParams:{height:14,width:15,stroke:"#B6B6B6"},children:[(0,a.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.91732 12.249V11.0824C9.91732 9.79369 8.87265 8.74902 7.58398 8.74902H2.91732C1.62865 8.74902 0.583984 9.79369 0.583984 11.0824V12.249",fill:"#838383",stroke:"#838383",strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.24935 6.41423C6.53801 6.41423 7.58268 5.36956 7.58268 4.08089C7.58268 2.79223 6.53801 1.74756 5.24935 1.74756C3.96068 1.74756 2.91602 2.79223 2.91602 4.08089C2.91602 5.36956 3.96068 6.41423 5.24935 6.41423Z",fill:"#838383",stroke:"#838383",strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.8118 12.2659H13.563C13.5622 11.2025 14.0005 8.82373 11.666 8.82373",fill:"#838383",stroke:"#838383",strokeLinecap:"round","stroke-linejoin":"round"}),(0,a.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.33398 1.82227C10.3664 2.08661 11.0886 3.01693 11.0886 4.08268C11.0886 5.14844 10.3664 6.07875 9.33398 6.3431",fill:"#838383",stroke:"#838383",strokeLinecap:"round","stroke-linejoin":"round"})]}))},65754:function(e,t,n){"use strict";n.d(t,{e:()=>m});var r=n(4006),i=n(90232),a=n(48635),l=n(99862),o=n(13950),s=n(84605),c=n(53989),d=n(86500),u=n(35369),p=n(76977),h=n(11510);let m=e=>{let{post:t}=e,n=(0,c.Pu)().getSettingFor("enable_prev_next_nav"),m=(0,h.Iu)(),{iString:g}=(0,s.GO)();if(!n)return null;let b=t.next_post_slug,f=t.previous_post_slug;return b||f?(0,r.Y)(o.DH,{children:(0,r.FD)(p.pT,{justifyContent:b&&f?"space-between":b?"end":"start",paddingY:16,children:[f&&(0,r.Y)(u.$n,{leading:(0,r.Y)(i.A,{size:20}),priority:m?"tertiary":"secondary",size:m?"sm":"md",onClick:()=>{(0,d.u4)(d.qY.PREVIOUS_POST_LINK_CLICKED,{post_id:t.id}),(0,l.route)("/p/".concat(f))},children:g("Previous")}),b&&(0,r.Y)(u.$n,{trailing:(0,r.Y)(a.A,{size:20}),priority:m?"tertiary":"secondary",size:m?"sm":"md",onClick:()=>{(0,d.u4)(d.qY.NEXT_POST_LINK_CLICKED,{post_id:t.id}),(0,l.route)("/p/".concat(b))},children:g("Next")})]})}):null}},11333:function(e,t,n){"use strict";n.d(t,{_:()=>c});var r=n(4006),i=n(17402),a=n(78330),l=n(58398),o=n(86500),s=n(98111);function c(e){let t,{className:n,linkClassName:c,user:d,pub:u,post:p,reaction_token:h,height:m,onChange:g,isStatic:b,children:f,sharedShareDialog:Y,noIcon:_,position:v}=e,[y,w]=(0,i.useState)(!1);return t=p.share_url_override?p.share_url_override:b?p?s.T.SHARE_URL:s.T.SHARE_PUB_URL:"javascript:void(0)",(0,r.FD)("span",{className:n,children:[(0,r.FD)("a",{href:t,onClick:e=>(e=>{if((0,o.u4)(o.qY.POST_SHARE_BUTTON_CLICKED,{position:v,post_id:p.id}),!b)if(e&&e.stopPropagation(),Y){var t;null==(t=e.target)||t.dispatchEvent(new CustomEvent("share-post",{bubbles:!0}))}else w(!0)})(e),className:c,children:[!_&&(0,r.Y)(a.A,{className:"recommend-icon post-meta-icon",isStatic:b,height:m,alt:"Share",stroke:"#757575",fill:"transparent",strokeWidth:b?1:1.5}),f]}),!b&&!Y&&(0,r.Y)(l.Z,{isOpen:y,onClose:()=>w(!1),user:d,pub:u,post:p,reaction_token:h,onChange:g,medium:"web"})]})}},90177:function(e,t,n){"use strict";n.d(t,{s:()=>F});var r=n(69277),i=n(4006),a=n(32485),l=n.n(a),o=n(36066),s=n(27437),c=n(53868),d=n(41935),u=n(39318);function p(e){var t;let{pub:n,post:r}=e,a=(0,u.dJ9)("".concat((0,u.$_T)(n),"/p/").concat(r.slug,"/authors.svg"),800,{format:"png",crop:"scale"}),{height:l,width:o}={width:((null==r||null==(t=r.publishedBylines)?void 0:t.length)-1)*32+40+4,height:44};return(0,i.Y)("img",{src:a,width:o,height:l})}var h=n(84605),m=n(53989),g=n(13022),b=n(24078),f=n(22057),Y=n(76977),_=n(49095),v=n(16291),y=n(4016),w=n(56262),S=n(19601),k=n(98949),C=n(82776);function F(e){let{post:t,pub:n,user:a,showDate:F,showDatetime:I,isStatic:E,className:D,postReactionToken:A,onChange:x,allowEdit:N,hidePinning:T,showEmailSent:P,allowSendEmail:O,allowMobileFooter:B,onCommentsClick:L,showRestackModal:R,setFooterShown:M}=e,H=(0,k.Fr)({checkFirst4:!0}),U="undefined"==typeof window,V=(0,C.getBylineUsers)(t),{language:j}=(0,h.GO)(),W=I?(0,v.A)(t.post_date).locale(j).standardDatetime():E?(0,v.A)(t.post_date).locale(j).standardDate():(0,v.A)(t.post_date).locale(j).standardDateOrTime(),{getSettingFor:z}=(0,m.Pu)(),K=n.bylines_enabled&&(0,C.getPrintedByline)(n,t)&&"podcast"!==t.type,J=K&&n.byline_images_enabled&&V.some(e=>{let{photo_url:t}=e;return!!t}),q="page"!==t.type,G=H&&J&&V.length>2,$=(null==n?void 0:n.community_enabled)&&t.slug&&!t.is_draft&&(0,C.showCommentsOnPost)({publication:n,post:t}),Z=K&&1===V.length&&V[0].is_guest&&V[0].primaryPublicationSubscribeUrl&&V[0].primaryPublicationId!==n.id&&!t.is_draft&&!(0,g.Ay)("dont_show_guest_byline"),Q=(0,C.oxfordComma)(V.map(e=>E?(0,i.Y)("a",{className:"byline-profile-link",href:(0,u.laT)(e,n,{base:E}),onClick:e=>e.stopPropagation(),children:e.name}):(0,i.FD)(Y.Ye,{inline:!0,gap:4,alignItems:"center",children:[(0,i.Y)(s.ProfileHoverCard,{subject:e,utmSource:"byline",trigger:(0,i.Y)("a",{className:"byline-profile-link",href:(0,u.laT)(e,n,{base:E}),onClick:e=>e.stopPropagation(),children:e.name})}),!E&&(0,i.Y)(_.UserStatusSymbols,{status:e.status,size:"sm",userId:e.id})]}))),X=!t.is_draft&&(0,S.A)(a,{enable_restacking:!!z("enable_restacking")},t,n,E);return(0,i.FD)("div",{className:l()("post-subheader",D),children:[(0,i.FD)("div",{className:l()("left",{vertical:G}),children:[J&&(E?(0,i.Y)(p,{pub:n,post:t}):(0,i.Y)(f.Z,{users:V.map(e=>{let{id:t,name:n,photo_url:r}=e;return{id:t,name:n,photo_url:r}}),max:5,size:36,renderAvatar:e=>(0,i.Y)(b.tp,(0,r._)({},e))})),(0,i.FD)("div",{className:"label-stack",children:[K&&(0,i.Y)("div",{className:"bylines",children:(0,i.Y)("span",{className:"byline-names",children:Q})}),Z&&(0,i.FD)("div",{className:"guest-author-publication",children:["Writes\xa0",(0,i.Y)("a",{className:"guest-author-publication-name",href:V[0].primaryPublicationUrl,title:V[0].primaryPublicationName,children:V[0].primaryPublicationName}),"\xa0\xb7\xa0",(0,i.Y)("a",{className:"guest-author-publication-subscribe",href:V[0].primaryPublicationSubscribeUrl,children:"Subscribe"})]}),(0,i.FD)("div",{className:"publish-context",children:["adhoc_email"===t.type?(0,i.Y)(c.A,{className:"audience-icon adhoc-email-icon",height:16,isStatic:E}):q&&(0,w.isPaidAudience)(t.audience)&&!(0,y.zM)({post:t})&&(0,i.Y)(o.A,{audience:t.audience,className:"audience-icon audience-lock-icon",size:16,isStatic:E,thin:!0}),(F||I)&&t.post_date&&!t.is_draft&&(0,i.Y)("time",{dateTime:(0,v.A)(t.post_date).toISOString(),children:W}),t.is_draft&&(F||I)&&"Draft"]})]})]}),(0,i.FD)("div",{className:"right",children:[H&&!U&&B&&(0,i.Y)(d.I2,{post:t,pub:n,user:a,isStatic:E,onChange:x,allowEdit:N,hidePinning:T,showEmailSent:P,allowSendEmail:O,hideComments:!$,onCommentsClick:L,showRestackButton:X,showRestackModal:R,setFooterShown:M,postReactionToken:A}),!H&&(0,i.Y)(d.xx,{post:t,pub:n,user:a,isStatic:E,style:"button",onChange:x,allowEdit:N,hidePinning:T,showEmailSent:P,allowSendEmail:O,labelStyle:"counts-or-none",hideComments:!$,onCommentsClick:L,position:"post-header",showRestackButton:X,showRestackModal:R,showClipping:"podcast"===t.type,editButtonIsLast:!0,postReactionToken:A})]})]})}},37494:function(e,t,n){"use strict";n.d(t,{A:()=>W});var r=n(99851),i=n(69277),a=n(70408),l=n(32641),o=n(4006),s=n(83673),c=n.n(s),d=n(38221),u=n.n(d),p=n(2404),h=n.n(p),m=n(41811),g=n(17402),b=n(83628),f=n(69843),Y=n.n(f),_=n(56265),v=n(23623),y=n(58925),w=n(46271),S=n(86500),k=n(68349),C=n(76977),F=n(63136),I=n(28916),E=n(49807),D=n(7642);function A(e){var t,n,r,a,l;let{nuxModal:s,showRestackNux:c}=(0,I.w)("post");return(0,o.FD)(o.FK,{children:[s,!Y()(null==(t=e.selection)?void 0:t.text)&&(null==(l=e.selection)||null==(a=l.text)||null==(r=a.split)||null==(n=r.call(a," "))?void 0:n.length)>=3&&(0,o.Y)(x,(0,i._)({onShare:c},e))]})}function x(e){let{pub:t,post:n,selection:r,onClose:i,userInteractionDisabled:a}=e,l=(0,w.Jd)(),[s,c]=(0,g.useState)(!1);(0,g.useEffect)(()=>{c(!0)},[]);let d=async()=>{(0,S.u4)(S.qY.VIDEO_QUOTE_TEXT_SELECTED,{post_id:n.id,selection_id:r.id}),(0,k.V2)((0,E.U_V)(t,n.id,{selectionForQuote:r.text}),{local_navigation:!1})};(0,g.useEffect)(()=>(window.addEventListener("scroll",i,{passive:!0,capture:!0,once:!0}),()=>{window.removeEventListener("scroll",i,{capture:!0,once:!0})}),[i]);let u=r.text&&r.text.length>2048;return(0,o.Y)(v.a,{children:(0,o.Y)(C.I1,{style:{top:r.y-48-12,left:r.rect.x+r.rect.width/2,transform:"translateX(-50%)",pointerEvents:a?"none":"auto",maxWidth:240},justifyContent:"center",outline:"detail",shadow:"md",radius:"md",className:"".concat(D.A.popover," ").concat(s?D.A.visible:""," ").concat(a?D.A.disabled:""),padding:4,gap:4,children:(0,o.FD)(y.ut,{onClick:d,disabled:!!(!l||u),children:[(0,o.Y)(_.A,{size:20,stroke:"var(--color-utility-white)"}),(0,o.Y)(F.EY.B4,{color:"vibrance-primary",weight:"medium",children:u?"Selection too long":"Use this text"})]})})})}var N=n(85478),T=n(52742),P=n(94729),O=n(2481),B=n(57324);let L=(0,g.createContext)({action:null,selectedImage:null}),R=async e=>{let{imgSrc:t,post:n,pub:r}=e,i=await (0,P.x6)("/api/v1/post_selection/image",{method:"PUT",json:{post_id:n.id,publication_id:r.id,img_src:t}});if(i instanceof Error)throw i;return i.selection.id},M=async e=>{let{imgSrc:t,pub:n,post:r}=e,i=await R({imgSrc:t,post:r,pub:n});return(0,E.wu9)(n,r,{urlParams:{utm_campaign:B._9.postSelection,utm_medium:B.Jn.web,imgSelection:i}})},H=e=>{var t;let{children:n,imageState:r,selectedImageIndex:i,selectedImageAction:a=null,onClose:l,pub:s,post:c,onLike:d}=e,u=(0,O.NP)(),[p,h]=(0,g.useState)(i&&null!=(t=null==r?void 0:r[i])?t:null);(0,g.useEffect)(()=>{if(null!=i&&r){var e;h(null!=(e=r[i])?e:null)}},[r,i]);let m=(0,g.useCallback)(async()=>{(null==p?void 0:p.src)&&u.open({restackUrl:await M({imgSrc:null==p?void 0:p.src,pub:s,post:c}),onCompose(){h(null),l()},onDismiss(){h(null),l()}})},[u,l,c,s,null==p?void 0:p.src]);(0,g.useEffect)(()=>{p&&"restack"===a&&!u.state.isOpen&&m()},[a,u.state.isOpen,p,m]);let b=null!=c&&"comment_count"in c&&"number"==typeof c.comment_count?c:null;return(0,o.FD)(L.Provider,{value:{action:a,selectedImage:p},children:[n,(0,o.Y)(T.V,{isOpen:"view"===a,modalContent:r,onClose:l,step:null!=i?i:0,post:b,publication:s,onLike:d})]})};var U=n(90292),V=n(82776);let j="\n:is(\n  div.body.markup, .pullquote, blockquote, li, caption, .footnote-content\n) > :is(\n  h1, h2, h3, h4, h5, h6, p:not(.button-wrapper)\n)\n";class W extends g.Component{async componentDidMount(){if(!this.body.current)return;let e=Array.from(this.body.current.querySelectorAll(j));this.originalParagraphState=e.map(e=>({text:e.textContent}));let t=new URL(window.location.href).searchParams.get("img"),n=new URL(window.location.href).searchParams.get("cutoffElementIndex"),r=Array.from(this.body.current.querySelectorAll(".image-link.image2"));r.forEach(e=>{"A"!==e.tagName&&console.warn("while parsing prosemirror doc for images, expected an anchor tag, but got",e.tagName)});let i=c()(r.map(e=>{let t=e.querySelector("img");if(!t)return console.warn("missing img when rendering prosemirror document"),null;let n=t.getAttribute("data-attrs"),r=n?JSON.parse(n):{},i=r.width/r.height,a=r.resizeWidth?r.resizeWidth/i:r.height,l=r.resizeWidth?r.resizeWidth/a:i;return{element:e,image:t,attrs:r,extraAttrs:{imageRatio:i,resizeHeight:a,resizeRatio:l}}})),a=0;if(t){let e=i.find(e=>e.attrs.src===t);e&&(a=e.image.getBoundingClientRect().top-65)}else if(n){let e=this.body.current.querySelector("*:nth-child(".concat(n,")"));e&&e.scrollIntoView()}if(i=(i=i.filter(e=>Number(e.attrs.height)>240&&e.extraAttrs.resizeHeight>240)).filter(e=>e.extraAttrs.imageRatio<4&&e.extraAttrs.resizeRatio<4),this.originalImageState=i.map(e=>{let t=e.image.src,n=null,r=e.element.parentElement;if(r&&"FIGURE"===r.tagName){var i;n=null==(i=r.querySelector(":scope > figcaption"))?void 0:i.textContent}return{src:t,attrs:e.attrs,caption:n}}),t&&this.originalImageState){window.scrollTo({top:a});let e=this.originalImageState.findIndex(e=>e.attrs.src===t);e>=0&&this.setState({selectedImgIndex:e})}"undefined"!=typeof window&&(document.addEventListener("selectionchange",this.onSelectionChange),document.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mouseup",this.onMouseUp))}componentWillUnmount(){"undefined"!=typeof window&&(document.removeEventListener("selectionchange",this.onSelectionChange),document.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mouseup",this.onMouseUp))}shouldComponentUpdate(e,t){return this.props.html!==e.html||this.state.selectedImgIndex!==t.selectedImgIndex||this.state.selection!==t.selection||this.state.selectionUserInteractionDisabled!==t.selectionUserInteractionDisabled||this.state.selectingTextForQuote!==t.selectingTextForQuote}onLinkClick(e){var t,n;if(!e.target||!(null==(t=e.target)?void 0:t.nodeName)||"A"!==e.target.nodeName&&(null==(n=e.target.parentNode)?void 0:n.nodeName)!=="A")return;let r="A"===e.target.nodeName?e.target:e.target.parentNode;if((0,S.u4)(S.qY.POST_LINK_CLICKED,{post_id:this.props.post.id,publication_id:this.props.post.publication_id,url:r.href}),window.location.host===r.host){let t=(0,V.transformDocumentLink)(r.href);t!==r.href&&(0,k.V2)(t,{local_navigation:!1,event:e});return}e.preventDefault(),(0,V.handleDocumentLinkClick)(r.href)}getSelectionState(){if(this.props.trackSelection&&window.getSelection)try{let e=window.getSelection();if(!e||e.isCollapsed||e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset)return;let t=this.findParentParagraph(e.anchorNode);if(!t)return;let n=this.findParentParagraph(e.focusNode);if(!n||!this.body.current)return;let r=Array.from(this.body.current.querySelectorAll(j)),i=r.findIndex(e=>e.isSameNode(t));if(-1===i)return;let a=r.findIndex(e=>e.isSameNode(n));if(-1===a)return;let l=this.getCharacterOffsetParagraph(t,e.anchorNode,e.anchorOffset);if(null===l)return;let o=this.getCharacterOffsetParagraph(n,e.focusNode,e.focusOffset);if(null===o)return;let s=i>a||i===a&&l>o,c=e.getRangeAt(0).getBoundingClientRect();return{startParagraph:s?a:i,endParagraph:s?i:a,startOffset:s?o:l,endOffset:s?l:o,y:c.y,height:c.height,rect:c,text:e.toString()}}catch(e){console.error("Failed to parse selection:",e)}}findParentParagraph(e){return e?["P","H1","H2","H3","H4","H5","H6"].includes(e.nodeName)?e:this.findParentParagraph(e.parentNode):null}isAncestorOf(e,t){return null!==e&&(!!e.isSameNode(t)||this.isAncestorOf(e.parentNode,t))}getCharacterOffsetParagraph(e,t,n){let r=n;for(let n=0;n<e.childNodes.length;n++){let a=e.childNodes[n];if(a){if(this.isAncestorOf(t,a))break;else if(a instanceof HTMLElement){if("BR"===a.tagName)r+=1;else if("footnote-anchor"!==a.className){var i;r+=(null==(i=a.textContent)?void 0:i.length)||0}}}}return r}shouldShowImageViewerModal(){let{selectedImgIndex:e}=this.state;return null!=e}render(){var e,t;let n=this.props,{pub:r,isAboutPage:s}=n,c=(0,l._)(n,["pub","isAboutPage"]),d=!!(null==(e=this.context)?void 0:e.getConfigFor("use_enhanced_video_embed_player")),{children:u,html:p}=this.props,{selection:h,selectedImgIndex:m,shouldUseSelectionV2Popover:g,selectingTextForQuote:b,imgAction:f}=null!=(t=this.state)?t:{};"undefined"==typeof window||b||"true"===new URLSearchParams(window.location.search).get("selectQuote")&&this.setState({selectingTextForQuote:!0}),p&&(u=this.memoizedDeepPrepareDocumentBody(p,r,(0,a._)((0,i._)({},c),{isAboutPage:s,useEnhancedVideoEmbed:d})))&&(p=null);let Y=!!u&&Array.from(u).some(e=>{var t,n,r,i;return(null==(t=e.props)?void 0:t.className)==="latex-rendered"||(null==(i=e.props)||null==(r=i.children)||null==(n=r.props)?void 0:n.className)==="latex-rendered"}),_=(0,o.Y)(o.FK,{children:(0,o.FD)(H,{imageState:this.originalImageState,selectedImageIndex:m,selectedImageAction:f,onClose:this.onCloseViewer,pub:r,post:this.props.post,onLike:this.props.onLike,children:[(0,o.Y)("div",{className:"body markup",dangerouslySetInnerHTML:p?{__html:p}:null,ref:this.body,onClick:this.onDocumentClick,onMouseDown:this.onBodyMouseDown,onMouseUp:this.onMouseUp,dir:"auto",children:u}),g&&!b?(0,o.Y)(y.YA,{pub:r,post:this.props.post,selection:h,onClose:this.clearActiveSelection,userInteractionDisabled:this.state.selectionUserInteractionDisabled,themeVariables:this.props.themeVariables}):h&&(0,o.Y)(A,{pub:r,post:this.props.post,selection:h,onClose:this.clearActiveSelection,userInteractionDisabled:this.state.selectionUserInteractionDisabled})]})});return Y&&!c.isStatic?(0,o.Y)(U.q,{children:_}):_}constructor(e,t){super(e,t),(0,r._)(this,"body",void 0),(0,r._)(this,"originalParagraphState",void 0),(0,r._)(this,"originalImageState",void 0),(0,r._)(this,"state",{selection:null,urlSelection:null,selectedImgIndex:null,selectionUserInteractionDisabled:!1,shouldUseSelectionV2Popover:!1,imgAction:null}),(0,r._)(this,"onBodyMouseDown",()=>{this.setState({selectionUserInteractionDisabled:!0})}),(0,r._)(this,"onMouseUp",()=>{this.setState((e,t)=>e.selectionUserInteractionDisabled?(e.selection&&t.trackSelection&&(0,S.u4)(S.qY.POST_TEXT_SELECTED,{post_id:t.post.id,post_audience:t.post.audience,post_type:t.post.type}),{selectionUserInteractionDisabled:!1}):null)}),(0,r._)(this,"onSelectionChange",u()(()=>{let e=this.getSelectionState();if(e){let t=this.shouldShowShareSelectionPopover();this.setState({selection:e,shouldUseSelectionV2Popover:t})}else this.state.selection&&this.setState({selection:null})},10)),(0,r._)(this,"onDocumentClick",e=>{if(!e.target)return;let t=e.target.closest(".image-link.image2");if(t&&this.originalImageState){var n,r;let i=t.querySelector("img"),a=this.originalImageState.findIndex(e=>e.src===(null==i?void 0:i.src)),l=this.originalImageState[a],o=e.target,s=(null==o?void 0:o.classList.contains("restack-image"))||(null==o||null==(n=o.parentElement)?void 0:n.classList.contains("restack-image")),c=(null==o?void 0:o.classList.contains("view-image"))||(null==o||null==(r=o.parentElement)?void 0:r.classList.contains("view-image")),d=l&&!!l.attrs.href;if(l&&(!d||s||c)){e.preventDefault(),this.setState({selectedImgIndex:a,imgAction:s?"restack":"view"});return}}if(this.props.skipTrackClick)return null;this.onLinkClick(e)}),(0,r._)(this,"onCloseViewer",()=>{this.setState({selectedImgIndex:null,imgAction:null})}),(0,r._)(this,"clearActiveSelection",()=>{this.setState({selection:null})}),(0,r._)(this,"closeImageViewerModal",()=>{this.setState({selectedImgIndex:null})}),(0,r._)(this,"shouldShowShareSelectionPopover",()=>{let e;return"undefined"!=typeof window&&(e="true"===new URLSearchParams(window.location.search).get("selectQuote")),!e}),(0,r._)(this,"memoizedDeepPrepareDocumentBody",(0,m.A)(b.bs,h())),this.body=(0,g.createRef)()}}(0,r._)(W,"contextType",N.W8)},79391:function(e,t,n){"use strict";n.d(t,{n:()=>D,A:()=>A});var r=n(99851),i=n(69277),a=n(70408),l=n(4006),o=n(32485),s=n.n(o),c=n(45773),d=n(17402),u=n(97432),p=n(97731);let h=e=>(0,l.Y)(p.A,(0,a._)((0,i._)({},e),{name:"LucideCheck",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,l.Y)(c.A,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}));var m=n(1250),g=n(84605),b=n(53989),f=n(8609),Y=n(21076),_=n(89490),v=n(35369),y=n(76977),w=n(98111),S=n(39318),k=n(41086),C=n(82776),F=n(57324);let I=["Subscribe","Subscribe now","Sign up","Sign up now"];function E(e){let{isStatic:t,pub:n,user:r,freeSignup:i,children:a,pledgesEnabled:o}=e;if(t)return(0,l.Y)(f.a.Consumer,{children:e=>{let{isFreemail:t,isFreeSubscribed:r,isPledged:i}=e;return a({isFreeSubscribed:r,isSubscribed:!t,isFullySubscribed:n.plans?!t:!o||i,isForPaidSubscription:!!n.plans&&t,isPledged:i})}});let s=i||(null==r?void 0:r.is_free_subscribed),c=null==r?void 0:r.is_subscribed,d=(null==r?void 0:r.is_subscribed)&&(null==r?void 0:r.is_founding),u=null==r?void 0:r.is_pledged;return a({isFreeSubscribed:s,isSubscribed:c,isFullySubscribed:n.plans?c:s&&(!o||u),isForPaidSubscription:!!n.plans&&s&&!c,isPledged:u,isFoundingSubscribed:d})}function D(e){let{pub:t,user:n,now:r,isStatic:i}=e,{language:a}=(0,g.GO)();return(0,l.Y)(b.l9.Consumer,{children:e=>{let{getSettingFor:o}=e,s="disabled"===t.payments_state&&!t.invite_only&&!!o("payment_pledges_enabled");return(0,l.Y)(E,{isStatic:i,user:n,pub:t,pledgesEnabled:s,children:e=>{let{isFreeSubscribed:n,isPledged:i}=e;return(0,l.Y)(l.FK,{children:(0,C.getSubscribeText)(t,{now:r,isFreeSubscribed:n,isPledged:i,pledgesEnabled:s,language:a})})}})}})}class A extends d.Component{onSignup(e,t){let{pledgesEnabled:n}=t;this.setState({loading:!0}),this.props.onSignup?this.props.onSignup(e):!this.props.forceEmailInput&&(this.props.pub.plans||this.props.pub.has_recommendations||n)?document.location.href=(0,S.eV6)(this.props.pub,(0,i._)((0,a._)((0,i._)({addBase:!0,utm_medium:F.Jn.web,utm_source:this.props.source||F.VU.subscribeWidget,utm_content:this.props.post&&this.props.post.id,just_signed_up:!0,requires_confirmation:e.body.requires_confirmation?"true":""},e.body.subscription_id&&{subscription_id:e.body.subscription_id},e.body.referral_token&&{referral_token:e.body.referral_token}),{next:this.props.next||document.location.href}),this.props.foundingUpsell&&{plan:"founding"})):(window.history.replaceState({},"",(0,S.yRP)(document.location.href,{just_subscribed:!0})),document.location.reload())}getHref(e,t){let{pub:n,subscribeButtonAttrs:r,isStatic:a,source:l,post:o,next:s,foundingUpsell:c}=this.props,d=(0,i._)({utm_medium:a?F.Jn.email:F.Jn.web,utm_source:l||F.VU.subscribeWidget,utm_content:o&&o.id,next:a?s:s||document.location.href,referring_pub_ids:a?void 0:(0,k.y)("referring_pub_ids")},c&&{plan:"founding"});return e?a?w.T.ACCOUNT_URL:(0,S.FCy)(n,{params:d,addBase:t.isSubstack}):(0,S.eV6)(n,(0,i._)({addBase:!0,root:r?r.url:a?w.T.CHECKOUT_URL:void 0},d))}getButtonLabel(e,t,n){let{isPledged:r,pledgesEnabled:i,foundingUpsell:a,isFoundingSubscribed:l}=n,{pub:o,subscribeButtonAttrs:s}=this.props,{iString:c}=I18N.i({pub:o});if(e||r)return c("Subscribed");let d=s&&s.text;return d&&!I.includes(d)?d:(0,C.getSubscribeText)(o,{now:!t,isFreeSubscribed:t,isPledged:r,pledgesEnabled:i,language:this.context.language,foundingUpsell:a,isFoundingSubscribed:l})}render(){var e;let{additionalPubIds:t,align:n="center",className:r,expectTruncation:i,forceEmailInput:a,foundingUpsell:o,freeSignup:d,freeSignupEmail:p,isStatic:g,noMargin:f,pub:w,source:S,user:k,onConfirmationRequired:I,onError:D,onPrepareData:A}=this.props,{loading:x}=null!=(e=this.state)?e:{};return(0,l.Y)(b.l9.Consumer,{children:e=>{let{getSettingFor:b}=e;return(0,l.Y)(m.oB.Consumer,{children:e=>{let m=!e.isSubstack&&"undefined"!=typeof window&&w.hostname!==window.location.hostname.replace(/[.]localhost$/,"");return(0,l.Y)(E,{pub:w,user:k,isStatic:g,freeSignup:d,pledgesEnabled:"disabled"===w.payments_state&&!w.invite_only&&!!b("payment_pledges_enabled"),children:E=>{var N;let{isFreeSubscribed:T,isSubscribed:P,isFullySubscribed:O,isPledged:B,isFoundingSubscribed:L}=E,R=this.getButtonLabel(O,T,{isPledged:B,pledgesEnabled:"disabled"===w.payments_state&&!w.invite_only&&!!b("payment_pledges_enabled"),isFoundingSubscribed:L,foundingUpsell:o}),M=T||P;return(0,l.Y)("div",{className:s()("subscribe-widget",{"is-signed-up":M,"is-fully-subscribed":O,"no-margin":f},r),"data-component-name":"SubscribeWidget",children:!a&&(M||g)?(0,l.Y)(_.az,{className:"button-wrapper",children:g?(0,l.FD)("a",{className:s()("button subscribe-btn",O?"outline":"primary"),href:this.getHref(O,e),native:!g,children:[O&&(0,l.Y)(h,{stroke:(null==w||null==(N=w.theme)?void 0:N.background_pop_color)||(null==w?void 0:w.theme_var_background_pop)||Y.vW,fill:"transparent",isStatic:!0,className:"check-icon static",height:20}),(0,l.Y)("span",{children:R})]}):(0,l.Y)(y.Ye,{justifyContent:"left"===n?"start":"center",children:(0,l.Y)(v.$n,{href:this.getHref(O,e),localNavigation:!1,priority:O&&(L||!o)?"secondary-accent":"primary",leading:O&&(L||!o)?(0,l.Y)(c.A,{size:20}):null,children:(0,l.Y)("span",{children:R})})})}):(0,l.Y)(y.Ye,{justifyContent:"left"===n?"start":"center",children:(0,l.Y)(u.A,{disabled:M||x,freeSignup:d,freeSignupEmail:p,expectTruncation:i,next:m?window.location.href:null,pub:w,source:S||"subscribe-widget",submitButtonText:M?"âœ“":(0,C.getSubscribeText)(w,{language:this.context.language}),useSubscribeLink:m,useGenericEndpoint:null==e?void 0:e.isSubstack,additionalPubIds:t,user:k,utm_campaign:(null==e?void 0:e.isSubstack)?F._9.reader2:m?F._9.crossPost:null,onConfirmationRequired:I||((null==w?void 0:w.payments_state)==="enabled"?()=>null:void 0),onError:D,onPrepareData:A,onSuccess:e=>this.onSignup(e,{pledgesEnabled:"disabled"===w.payments_state&&!w.invite_only&&!!b("payment_pledges_enabled")})})})})}})}})}})}}(0,r._)(A,"contextType",g.OW)},99927:function(e,t,n){"use strict";n.d(t,{V:()=>_});var r=n(69277),i=n(70408),a=n(4006),l=n(17402),o=n(13589),s=n(85688),c=n(63446),d=n(16514),u=n(15894),p=n(76977),h=n(39318),m=n(57324);let g=e=>{let{children:t,isFreeSubscribed:n,isOpen:r,isSubscribed:i,pub:l,onClose:o}=e,s=(0,h.eV6)(l,{utm_source:m.VU.downloadPdfButton,simple:!0,next:(0,h.yRP)(document.location.href,{triggerPDF:!0}),addBase:!0});return(0,a.Y)(d.w,{closeOnOutsideClick:!0,content:(0,a.FD)(p.I1,{gap:4,position:"relative",children:[(0,a.Y)(u.T,{preset:"d4-serif",children:i?"Paid subscribers can now save articles as PDFs, formatted for printing out and enjoying offline.":"Saving articles as PDFs, formatted for printing and reading offline, is a benefit we're proud to offer our\n              paid subscribers. ".concat(n?"Upgrade":"Sign up"," today to unlock this feature.")}),!i&&(0,a.Y)(p.Ye,{children:(0,a.Y)(c.v,{href:s,localNavigation:!1,size:"sm",trailingIcon:"chevron-right",variant:"tertiary",children:n?"Upgrade now":"Subscribe now"})})]}),isOpen:r,onClose:o,children:t})};var b=n(86500),f=n(68349),Y=n(49807);let _=e=>{let{post:t,pub:n,user:c}=e,[d,u]=(0,o.Mk)(),[h,m]=(0,l.useState)(!1),_=!!(null==c?void 0:c.is_subscribed),v=!!(null==c?void 0:c.is_free_subscribed);return(0,l.useEffect)(()=>{let e=new URL(document.location.href);if(e.searchParams.get("triggerPDF")){if(_){var r;(0,f.V2)((0,Y.MGs)(n,t.id,{token:"token"in window._preloads&&null!=(r=window._preloads.token)?r:void 0}),{local_navigation:!1,newTab:!0})}e.searchParams.delete("triggerPDF"),window.history.replaceState({},"",e)}},[_,t.id,n]),(0,a.Y)(g,{isFreeSubscribed:v,isOpen:h,isSubscribed:_,pub:n,onClose:()=>{m(!1)},children:(0,a.Y)(p.pT,(0,i._)((0,r._)({},u),{cursor:"pointer",onClick:()=>{((0,b.u4)(b.qY.POST_PDF_BUTTON_CLICKED,{post_id:t.id}),_)?(0,f.V2)((0,Y.MGs)(n,t.id),{local_navigation:!1,newTab:!0}):m(!h)},children:(0,a.Y)(s.A,{height:24,isHovered:d,width:24})}))})}},65812:function(e,t,n){"use strict";n.d(t,{A:()=>s});var r=n(4006),i=n(97432),a=n(68349),l=n(39318);let o="emailInput-VN3GpJ";function s(e){let{pub:t,user:n,post:s,utmSource:c,submitButtonText:d,preset:u="primary",allowEmptyInput:p,onSuccess:h}=e,m="accent"===u?"".concat(o," ").concat("emailInputAccent-tTlqVa"," fp-email-input-accent"):"".concat(o," fp-email-input");return(0,r.Y)(i.A,{allowEmptyInput:p,className:"emailContainer-JfVhvU",inputClassName:m,placeholder:"ENTER YOUR EMAIL",promptClassName:"prompt-j7JgJU",pub:t,source:c,submitButtonText:null!=d?d:"SIGN UP",subscribeButtonClassName:"accent"===u?"".concat("subscribeButtonAccent-pwy2Eg"," fp-subscribe-button-accent"):"".concat("subscribeButton-fDC87J"," fp-subscribe-button"),user:n,onAccentBackground:!0,onSuccess:e=>{if(h)return h(e);(0,a.V2)((0,l.my9)(t,{just_signed_up:!0,autoSubmit:!!e.body.prompt_to_login||void 0,email:e.body.email,next:(0,l.wu9)(t,s)}),{replace:!0,local_navigation:!1})}})}},69656:function(e,t,n){"use strict";n.d(t,{Q:()=>h});var r=n(4006),i=n(48697),a=n(17402),l=n(15894),o=n(46271),s=n(68410),c=n(35369),d=n(39318),u=n(57324);let p={container:"container-fkyH3f",content:"content-UDY69G",link:"link-R3vXCZ",dismissButton:"dismissButton-z1E0Nw"},h=e=>{let{pub:t,onDismiss:n}=e,[h,m]=(0,a.useState)(!1),{isMobile:g}=(0,s.sM)(),b=(0,o.Jd)(),f=(0,a.useCallback)(()=>"undefined"==typeof window?"#":(0,d.eV6)(t,{addBase:!0,next:(0,d.yRP)(window.location.href,{follow:!0}),utm_source:u.VU.fixedFooterPaywall,utm_medium:u.Jn.web}),[t]),Y=(0,a.useCallback)(()=>"undefined"==typeof window?"#":(0,d.eV6)(t,{addBase:!0,isSignInAttempt:!0,next:(0,d.yRP)(window.location.href,{follow:!0}),utm_source:u.VU.fixedFooterPaywall,utm_medium:u.Jn.web}),[t]);return h?null:(0,r.FD)("div",{className:"".concat(p.container," ").concat(p.text),children:[(0,r.FD)(l.T,{preset:"detail-large",children:[g?"To read ":"To read this article, ",b?null:(0,r.FD)(r.FK,{children:[(0,r.Y)("a",{className:p.link,href:Y(),native:!0,children:"sign in"})," ","or"," "]}),(0,r.Y)("a",{className:p.link,href:f(),native:!0,children:"subscribe"})]}),(0,r.Y)(c.Nm,{"aria-label":"Dismiss",className:p.dismissButton,onClick:()=>{m(!0),null==n||n()},children:(0,r.Y)(i.A,{size:20})})]})}},16514:function(e,t,n){"use strict";n.d(t,{w:()=>u});var r=n(69277),i=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(13589),d=n(13950);let u=e=>{let{children:t,closeOnOutsideClick:n,content:o,isOpen:u,onClose:p,onToggle:h}=e,{arrowProps:m,layerProps:g,renderLayer:b,triggerProps:f}=(0,c.Z4)({auto:!0,containerOffset:28,isOpen:u,overflowContainer:!0,placement:"bottom-center",possiblePlacements:["bottom-center"],triggerOffset:16,onOutsideClick:n?p:void 0}),Y=g.style,{style:_}=g,v=(0,a._)(g,["style"]),y="undefined"==typeof window;return(0,l.FD)(l.FK,{children:[(0,l.Y)("div",(0,i._)((0,r._)({},f),{onClick:()=>{null==h||h(!u)},children:t})),u&&!y&&b((0,l.FD)("div",(0,i._)((0,r._)({style:Y},v),{className:s()("popoverContainer-EjJsJc","the-free-press-theme"),children:[(0,l.Y)(d.DH,{children:o}),(0,l.Y)(c.i3,(0,i._)((0,r._)({},m),{borderColor:"var(--color-fg-primary-themed)",borderWidth:2,size:10}))]})))]})}},77921:function(e,t,n){"use strict";n.d(t,{n:()=>S});var r=n(69277),i=n(4006),a=n(32485),l=n.n(a),o=n(17402),s=n(13950),c=n(65812),d=n(15894),u=n(84565),p=n(68410),h=n(35369),m=n(76977),g=n(39318),b=n(57324);let f="wrapper-TFWk0w",Y="fade-vBsC3Z",_="signInLink-TZ6ND4",v=[{name:"Annual",price:"$8.33/month",billedAs:"$100 yearly",save:"17%!"},{name:"Monthly",price:"$10/month",billedAs:"$10 monthly"}],y=(0,g.dJ9)("".concat((0,g.Ewe)(),"/img/thefp/save-ribbon.svg"),200),w=e=>{let{onPlanChange:t}=e,[n,r]=(0,o.useState)("Annual"),a=e=>{r(e),null==t||t(e)},{isMobile:s}=(0,p.sM)();return(0,i.Y)(m.pT,{direction:s?"column":"row",gap:0,style:{width:"100%"},children:v.map(e=>(0,i.FD)("div",{className:l()("subPlanContainer-nTA_GR",n===e.name&&"selected-_2BPlx"),onClick:()=>a(e.name),children:[(0,i.Y)("input",{checked:n===e.name,className:"planRadio-wVgJ5P",name:"plan",type:"radio",value:e.name,onChange:()=>a(e.name)}),(0,i.FD)(m.I1,{alignItems:"start",gap:8,children:[(0,i.Y)(d.T,{preset:"lg-preview-byline",children:e.name}),(0,i.Y)(d.T,{color:"blue",preset:"d2-serif-bold",style:{paddingBottom:"2px"},children:e.price}),(0,i.FD)(d.T,{className:"billedAs-aSsRNm",preset:"caption",children:["Billed as ",e.billedAs]}),e.save&&(0,i.FD)("div",{className:"banner-PABwyI",style:{backgroundImage:'url("'.concat(y,'")'),backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"right center",display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"4px 8px 4px 16px"},children:[" ",(0,i.FD)(d.T,{color:"white",preset:"detail-small",children:["Save ",e.save]})]})]})]},e.name))})},S=e=>{let{post:t,user:n,pub:a,freeSignupEmail:p}=e,v="newsletter"===t.type,y=!!(p||(null==n?void 0:n.is_free_subscribed)||!t.current_user_post_meter),S=(0,u.NQ)(),[k,C]=(0,o.useState)("Annual");if(y){let e="treatment"===S.getExperimentVariant("thefp_paywall_with_plans");return S.exposeExperiment("thefp_paywall_with_plans",{ignoreDownsampling:!0}),(0,i.Y)(s.DH,{children:(0,i.FD)(m.I1,{alignItems:"center",className:l()(f,{[Y]:v,"wrapperWithPlans-PEZhOz":e}),gap:24,justifyContent:"center",textAlign:"center",children:[(0,i.FD)(m.I1,{gap:16,children:[(0,i.Y)(d.T,{preset:"h5-sans",children:"Continue Reading The Free Press"}),!!t.current_user_post_meter&&(0,i.Y)(d.T,{preset:"d2-serif",children:"Youâ€™ve reached your monthly article limit"}),(0,i.Y)(d.T,{preset:"d3-serif",children:"To support our journalism, and unlock all of our investigative stories and provocative commentary about the world as it actually is, subscribe below."}),e&&(0,i.Y)(w,{onPlanChange:C})]}),(0,i.Y)(h.Nm,{className:"subscribeButtonLarge-lAytbH",href:(0,g.my9)(a,(0,r._)({utm_source:b.VU.meteredPostPaywall,next:(0,g.wu9)(a,t)},e&&k&&{plan:k.toLowerCase()})),localNavigation:!1,children:(0,i.Y)(d.T,{color:"white",preset:"detail-large",children:"Subscribe Now"})}),(0,i.FD)(m.Ye,{alignItems:"center",gap:8,justifyContent:"center",children:[(0,i.Y)(d.T,{preset:"detail-small",children:"Already have an account?"}),(0,i.Y)("a",{className:_,href:(0,g.my9)(a,{isSignInAttempt:!0,next:(0,g.wu9)(a,t)}),children:(0,i.Y)(d.T,{color:"accent",preset:"detail-large",children:"Sign In"})})]})]})})}return(0,i.Y)(s.DH,{children:(0,i.FD)(m.I1,{alignItems:"center",className:l()(f,{[Y]:v}),gap:24,justifyContent:"center",textAlign:"center",children:[(0,i.FD)(m.I1,{gap:16,children:[(0,i.Y)(d.T,{preset:"h5-sans",children:"Enjoying the story?"}),(0,i.Y)(d.T,{preset:"d2-serif",children:"Enter your email to read this article and receive our daily newsletter."})]}),(0,i.Y)(c.A,{post:t,pub:a,user:n,utmSource:b.VU.meteredPostRegistrationWall}),(0,i.FD)(m.Ye,{gap:16,children:[(0,i.Y)(d.T,{preset:"caption",children:"Already have an account?"}),(0,i.Y)("a",{className:_,href:(0,g.my9)(a,{isSignInAttempt:!0,next:(0,g.wu9)(a,t)}),children:(0,i.Y)(d.T,{color:"accent",preset:"caption",children:"Sign In"})})]})]})})}},1842:function(e,t,n){"use strict";n.d(t,{_:()=>_});var r=n(4006),i=n(32485),a=n.n(i),l=n(38221),o=n.n(l),s=n(17402),c=n(17988),d=n(12293),u=n(15894),p=n(76977),h=n(75303),m=n(58278),g=n(82776);let b="label-gHN5_J",f="active-label-ndUdOP",Y=e=>{let{postId:t,toc:n,title:i,activeItem:l,wordCount:c,leftMargin:Y,commentCount:_,showComments:v,onItemClick:y}=e,w=(0,s.useRef)(null),[S,k]=(0,s.useState)(!1),[C,F]=(0,s.useState)("0"),[I,E]=(0,s.useState)("0"),D=(0,s.useCallback)(()=>{if(w.current){var e,t,n,r,i,a,l;let o=w.current.getBoundingClientRect(),s=null==(e=w.current.parentElement)?void 0:e.getBoundingClientRect(),c=null==(n=w.current.parentElement)||null==(t=n.parentElement)?void 0:t.getBoundingClientRect(),d=window.innerHeight/2;if(o&&s)if(d+2>s.top+o.height/2){let e=(r=c,i=o.height,document.getElementById("discussion")?Number(null==(l=document.getElementById("discussion"))||null==(a=l.getBoundingClientRect())?void 0:a.top)+i/2+20:Number(null==r?void 0:r.bottom)-i/2);e<=d?(k(!0),F(e.toString())):(k(!0),F("50%")),E(s.left.toString())}else k(!1),F("0"),E("0")}},[S,w,C]),A=(0,s.useMemo)(()=>o()(D,25,{trailing:!0,leading:!0,maxWait:60}),[D]);(0,s.useEffect)(()=>(window.addEventListener("scroll",A,{passive:!0}),()=>{window.removeEventListener("scroll",A)}),[S,A]);let x=Y+Number(I)+"px";return(0,r.Y)("div",{id:"toc",style:{position:"relative"},children:(0,r.Y)("div",{ref:w,className:a()("container-NR9v7N",S&&"fixed-gIIqpc"),style:{top:"50%"===C?"50%":Number(C),left:x},children:(0,r.FD)(p.I1,{flex:"grow",gap:4,children:[i&&(0,r.FD)("div",{className:a()("header-ggAXv9",b),id:"header"===l?f:void 0,onClick:()=>y(document.querySelector(".markup")),children:[(0,r.Y)(u.T,{className:"title-3Yeuyx",color:"header"===l?"primary":"disabled",preset:"detail-large",children:i}),!!c&&(0,r.FD)(u.T,{color:"header"===l?"primary":"disabled",preset:"caption",children:[Math.round(c/g.READ_WORDS_PER_MINUTE)," min read"]})]}),n.map((e,n)=>{let i=(0,m.HN)(e.text,t),a=l===i;return(0,r.Y)(h.AE,{href:"#\xa7".concat(i),onClick:e=>{e.preventDefault(),y(document.getElementById("\xa7".concat(i)))},children:(0,r.Y)(p.Ye,{children:(0,r.Y)(u.T,{className:b,color:a?"primary":"disabled",id:a?f:void 0,preset:"body",children:e.text})})},n)}),v&&(0,r.FD)("div",{className:a()("commentContainer-dmiFCB",b),onClick:()=>y(document.getElementById("discussion")),children:[(0,r.Y)(d.A,{isHovered:"discussion"===l}),_]})]})})})},_=e=>{let{postId:t,toc:n,title:i,wordCount:a,leftMargin:l=0,commentCount:o,showComments:d}=e,u=((e,t)=>{let[n,r]=(0,s.useState)("header"),i=[{text:"header",id:"header",selector:".markup > p:first-of-type"},...e,{text:"discussion",id:"discussion",selector:"#discussion > div"}];return(0,s.useEffect)(()=>{let e=[];return i.forEach(n=>{let i=(0,m.HN)(n.text,t),a=document.getElementById("\xa7".concat(i))||n.selector&&document.querySelector(n.selector);if(a){let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.intersectionRatio>=.3&&r(i)})},{rootMargin:"0% 0px -70% 0px"});t.observe(a),e.push(t)}}),()=>e.forEach(e=>e.disconnect())},[e]),n})(n,t),p=(0,c.useMediaQuery)({maxWidth:1100});return n.length<2||p?null:(0,r.Y)(Y,{activeItem:u,commentCount:o,leftMargin:l,postId:t,showComments:d,title:i,toc:n,wordCount:a,onItemClick:e=>{e&&e.scrollIntoView({behavior:"smooth",block:"start"})}})}},90847:function(e,t,n){"use strict";n.d(t,{Z:()=>p});var r=n(4006),i=n(32485),a=n.n(i),l=n(13950),o=n(49984),s=n(68410),c=n(89490),d=n(49807);let u={thefpPostBodyWrapper:"thefpPostBodyWrapper-Sk9SUV",withEagleWatermark:"withEagleWatermark-SQ7w6N",eagleWatermark:"eagleWatermark-QuTSZR",noPaddingOnMobile:"noPaddingOnMobile-SkPaHP",withDropCap:"withDropCap-izNtyr",withSpaceForMissingDropCap:"withSpaceForMissingDropCap-MMwASG",threadHeadBody:"threadHeadBody-gHFj3E"},p=e=>{var t,n;let{children:i,disabled:p,inThreadHead:h,isCustomPage:m,isShowsPost:g,post:b}=e,f=!!(null==b||null==(t=b.postTheme)?void 0:t.disable_drop_cap),{isMobile:Y}=(0,s.sM)(),_=!!b&&(0,o.o6)(b)&&Y;return p?(0,r.Y)(r.FK,{children:i}):(0,r.Y)(l.DH,{children:(0,r.FD)(c.az,{className:a()(u.thefpPostBodyWrapper,u[null==b||null==(n=b.postTheme)?void 0:n.header_variant],{[u.withDropCap]:!(h||m||f),[u.withSpaceForMissingDropCap]:f,[u.threadHeadBody]:h,[u.noPaddingOnMobile]:g||h||m,[u.withEagleWatermark]:_}),children:[_&&(0,r.Y)("div",{className:u.eagleWatermark,style:{backgroundImage:"url(".concat((0,d.dJ9)("".concat((0,d.Ewe)(),"/img/thefp/eagle_stamp.png"),500,{quality:"auto:good",crop:"limit"}),")")}}),i]})})}},61755:function(e,t,n){"use strict";n.d(t,{xn:()=>I,qS:()=>C,ct:()=>k,wu:()=>F});var r=n(69277),i=n(70408),a=n(4006),l=n(36119),o=n.n(l),s=n(54718),c=n(13589),d=n(12293),u=n(32641),p=n(97731),h=n(57753);let m=e=>{var{isHovered:t,isLiked:n}=e,l=(0,u._)(e,["isHovered","isLiked"]);let o=n?h.Q3.mediumRed.hex:t?h.Q3.brightOrange.hex:h.Q3.lightGray.hex;return(0,a.FD)(p.A,(0,i._)((0,r._)({},l),{name:"FPLikeIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",stroke:"none",fill:"none"},children:[(0,a.Y)("path",{d:"M3.69231 1H9.23077V2.83333H11.0769V4.66667H12.9231V2.83333H14.7692V1H20.3077V2.83333H22.1538V4.66667H24V12H22.1538V13.8333H20.3077V15.6667H18.4615V17.5H16.6154V19.3333H14.7692V21.1667H12.9231V23H11.0769V21.1667H9.23077V19.3333H7.38462V17.5H5.53846V15.6667H3.69231V13.8333H1.84615V12H0V4.66667H1.84615V2.83333H3.69231V1Z",fill:o}),(0,a.Y)("rect",{x:"5",y:"4",width:"2",height:"2",fill:"white"}),(0,a.Y)("rect",{x:"3",y:"6",width:"2",height:"4",fill:"white"})]}))};var g=n(80703),b=n(97683),f=n(41935),Y=n(33460),_=n(15894),v=n(35369),y=n(76977),w=n(49807),S=n(82776);let k=e=>{let{cta:t,post:n,pub:l,showCounts:s=!0,size:d,user:u,onChange:p}=e,[h,g]=(0,c.Mk)(),b=o()(Object.values((null==n?void 0:n.reactions)||{})),Y=(0,S.numberToString)(b||0),v="small"===d?16:24,w="small"===d?"sm-preview-byline":"detail-large";return(0,a.Y)(f.Z4,{isStatic:!1,post:n,pub:l,style:"button",user:u,onChange:p,children:e=>{let{isLiked:n,handleLike:l}=e;return(0,a.FD)(y.Ye,(0,i._)((0,r._)({},g),{alignItems:"center",cursor:"pointer",gap:8,role:"button",onClick:l,children:[(0,a.FD)(y.Ye,{alignItems:"center",gap:"small"===d?4:6,children:[(0,a.Y)(m,{height:v,isHovered:h,isLiked:n,width:v}),s&&b>0&&(0,a.Y)(_.T,{preset:w,children:Y})]}),t&&(0,a.Y)(_.T,{preset:"detail-large",children:t})]}))}})},C=e=>{let t,{post:n,pub:l,showCounts:o=!0,size:s,cta:u}=e,[p,h]=(0,c.Mk)(),m=(0,S.numberToString)(n.comment_count),g="small"===s?16:24;return t=(null==n?void 0:n.comment_url_override)?n.comment_url_override:(0,w.wu9)(l,n,{comments:!0}),(0,a.FD)(y.Ye,(0,i._)((0,r._)({},h),{alignItems:"center",cursor:"pointer",gap:8,role:"button",onClick:e=>{e.stopPropagation(),window.location.href=t},children:[(0,a.FD)(y.Ye,{alignItems:"center",gap:"small"===s?4:6,children:[(0,a.Y)(d.A,{height:g,isHovered:p,width:g}),n.comment_count>0&&o&&(0,a.Y)(_.T,{preset:"small"===s?"sm-preview-byline":"detail-large",children:m})]}),u&&(0,a.Y)(_.T,{preset:"detail-large",children:u})]}))},F=e=>{let{pub:t,post:n,user:l,cta:o}=e,[s,d]=(0,c.Mk)();return(0,a.Y)(Y.$8,{post:n,pub:t,trigger:(0,a.FD)(y.pT,(0,i._)((0,r._)({},d),{alignItems:"center",cursor:"pointer",gap:8,children:[(0,a.Y)(g.A,{height:24,isHovered:s,width:24}),o&&(0,a.Y)(_.T,{preset:"detail-large",children:o})]})),user:l})},I=e=>{let{className:t,context:n,post:l,pub:o,user:d}=e,[u,p]=(0,c.Mk)();if(!d)return null;let m=u?h.Q3.brightOrange.hex:h.Q3.lightGray.hex,g=(0,a.Y)(v.Nm,(0,i._)((0,r._)({display:"flex",resetCss:!0},p),{onClick:e=>{e.stopPropagation()},children:(0,a.Y)(s.A,{size:"post-preview"===n?16:24,stroke:m})}));return(0,a.Y)("div",{className:t,style:{cursor:"pointer"},children:(0,a.Y)(b.D,{hideDropCapOption:"post-preview"===n,hidePinning:!0,hidePostHeaderOptions:"post-preview"===n,post:l,pub:o,trigger:g,user:d})})}},18835:function(e,t,n){"use strict";n.d(t,{A:()=>F});var r=n(69277),i=n(70408),a=n(32641),l=n(4006),o=n(32485),s=n.n(o),c=n(17402),d=n(99070),u=n(20347),p=n(3849),h=n(97731);let m=e=>{var t=(0,u._)({},(0,p._)(e));return(0,l.Y)(h.A,(0,i._)((0,r._)({},t),{name:"FPPauseIcon",svgParams:{width:25,height:25,viewBox:"0 0 25 24",fill:"none",stroke:"none"},children:(0,l.FD)("g",{id:"play-circle",children:[(0,l.Y)("path",{id:"Icon",d:"M12.5 22C18.0228 22 22.5 17.5228 22.5 12C22.5 6.47715 18.0228 2 12.5 2C6.97715 2 2.5 6.47715 2.5 12C2.5 17.5228 6.97715 22 12.5 22Z",stroke:"#F2312C",strokeWidth:"2",strokeLinecap:"round"}),(0,l.Y)("rect",{id:"Rectangle 2398",x:"8.5",y:"7.08496",width:"3",height:"10",fill:"#F2312C"}),(0,l.Y)("rect",{id:"Rectangle 2399",x:"13.5",y:"7.08496",width:"3",height:"10",fill:"#F2312C"})]})}))};var g=n(10956),b=n(63446),f=n(16514),Y=n(15894),_=n(86500),v=n(76977),y=n(39318),w=n(82776),S=n(57324);let k="ctaMode-zO5a9a",C=e=>{let{containerRef:t,currentTime:n,remainingTime:r,progress:i,onMouseDown:a,className:o}=e;return(0,l.FD)(v.Ye,{alignItems:"center",className:o,gap:4,children:[(0,l.Y)(Y.T,{preset:"caption",style:{flexShrink:0,minWidth:"28px"},children:n}),(0,l.FD)("div",{ref:t,className:"progressBar-yUZk3A",onMouseDown:a,children:[(0,l.Y)("div",{className:"progressBarBackground-rOIsbW"}),(0,l.Y)("div",{className:"progressBarProgress-EiVcPg",style:{width:"".concat(100*i,"%")}}),(0,l.Y)("div",{className:"progressBarPlayhead-KWfdzC",style:{left:"".concat(100*i,"%")}})]}),(0,l.Y)(Y.T,{preset:"caption",style:{flexShrink:0,paddingLeft:"4px",minWidth:"36px"},children:r})]})},F=e=>{var{mediaUploadId:t,user:n,post:o,pub:u}=e,p=(0,a._)(e,["mediaUploadId","user","post","pub"]);let[h,F]=(0,c.useState)(!0),[I,E]=(0,c.useState)(!1),D=!!(null==n?void 0:n.is_subscribed),A=!!(null==n?void 0:n.is_free_subscribed);return(0,c.useEffect)(()=>{I&&(0,_.u4)(_.qY.TTS_UPGRADE_TO_LISTEN_CLICKED,{post_id:o.id})},[I,o.id]),(0,l.Y)(d.A,(0,i._)((0,r._)({},p),{feature:"Add voiceover",metricsPost:o,post:o,pub:u,render:e=>{let{isPaywalled:t,currentTime:n,isPlaying:r,progress:i,progressBarRef:a,progressBarOnMouseDown:c,remainingTime:d,duration:p,togglePlayback:_}=e,x=()=>{t?E(!0):(h&&F(!1),_())},N=(0,l.FD)(v.Ye,{alignItems:"center",className:s()("wrapper-LdgflB",{[k||""]:h}),gap:16,justifyContent:"space-between",children:[(0,l.FD)(v.Ye,{alignItems:"center",className:s()("innerWrapper-ersGfZ",{[k||""]:h}),gap:16,onClick:h?x:void 0,children:[(0,l.Y)(v.I1,{className:s()("playButton-vLW5qd",{[k||""]:h,"static-tP398S":t}),style:{flexShrink:0},onClick:()=>{x()},children:r?(0,l.Y)(m,{}):(0,l.Y)(g.A,{})}),(0,l.Y)(C,{className:s()("progressBarWrap-vpoiUw",{[k||""]:h}),containerRef:a,currentTime:n,progress:i,remainingTime:d,onMouseDown:c}),(0,l.FD)(v.Ye,{alignItems:"center",className:s()("cta-GdLXe1",{[k||""]:h}),gap:16,children:[(0,l.Y)(Y.T,{preset:"detail-small",children:t?"Upgrade to Listen":"Listen to Article"}),(0,l.Y)(Y.T,{color:"tertiary",preset:"caption",style:{flexShrink:0},children:(0,w.secondsToLargestUnit)(p||300)})]})]}),(0,l.Y)(Y.T,{className:s()("disclaimer-i3yYG0",{[k||""]:h}),color:"tertiary",preset:"caption",children:"Produced by ElevenLabs using AI narration"})]});return t?(0,l.Y)(f.w,{closeOnOutsideClick:!0,content:(0,l.FD)(v.I1,{gap:4,position:"relative",children:[(0,l.Y)(Y.T,{preset:"d4-serif",children:"Listening to articles, is a benefit we're proud to offer our paid subscribers. Sign up today to unlock this feature."}),!D&&(0,l.Y)(v.Ye,{children:(0,l.Y)(b.v,{href:(0,y.my9)(u,{UTM_SOURCE:S.VU.voiceoverPlayer,next:(0,y.wu9)(u,o)}),localNavigation:!1,size:"sm",trailingIcon:"chevron-right",variant:"tertiary",children:A?"Upgrade now":"Subscribe now"})})]}),isOpen:I,onClose:()=>{E(!1)},children:N}):N},src:t?"/api/v1/audio/upload/".concat(t,"/src"):null,trackingProps:{}}))}},81668:function(e,t,n){"use strict";n.d(t,{w:()=>m});var r=n(4006),i=n(17402),a=n(84605),l=n(86500),o=n(35369),s=n(76977),c=n(16993),d=n(63136),u=n(54542),p=n(39318),h=n(57324);function m(e){let{postId:t,onClose:n}=e,{iString:u}=(0,a.GO)();return(0,i.useEffect)(()=>{(0,l.u4)(l.qY.LISTEN_TO_THIS_POST_MODAL_SHOWN,{post_id:t})},[]),(0,r.FD)(c.aF,{isOpen:!0,onClose:n,children:[(0,r.Y)(c.rQ,{showClose:!0,onClose:n}),(0,r.Y)(c.cw,{children:(0,r.FD)(s.I1,{alignItems:"center",gap:24,children:[(0,r.FD)(s.I1,{style:{textAlign:"center"},justifyContent:"center",gap:8,children:[(0,r.Y)(d.EY.H3,{weight:"heavy",children:u("Listen to this post")}),(0,r.Y)(d.EY,{color:"secondary",style:{lineHeight:1.5},children:u("Get the Substack app to hear this article read aloud.")})]}),(0,r.Y)(g,{})]})}),(0,r.Y)(c.jl,{showDivider:!0,direction:"column",primaryButton:(0,r.Y)(o.$n,{priority:"primary",href:(0,p.wHz)({utm_source:h.VU.web,utm_campaign:h._9.ttsModal}),onClick:()=>(0,l.u4)(l.qY.LISTEN_TO_THIS_POST_MODAL_GET_THE_APP_CLICKED,{post_id:t}),children:u("Get the app")})})]})}function g(){let e="/img/main/tts-dialog";return(0,r.FD)("video",{height:220,autoPlay:!0,muted:!0,loop:!0,children:[(0,r.Y)("source",{src:"".concat(e,"/nux.mp4"),type:"video/mp4"}),(0,r.Y)("img",{width:374,height:233,src:"".concat(e,"/1x.png"),srcset:Array.from((0,u.y1)(1,4)).map(t=>"".concat(e,"/").concat(t,"x.png ").concat(t,"x")).join(", ")})]})}},1459:function(e,t,n){"use strict";n.d(t,{e:()=>r});let r=(e,t)=>"enabled"===t.payments_state?e.is_subscribed:e.is_free_subscribed},36375:function(e,t,n){"use strict";n.d(t,{A:()=>u});var r=n(4006),i=n(45994),a=n(34746),l=n(52077),o=n(84605),s=n(86500),c=n(56458),d=n(82776);let u=e=>{let{post:t,pub:n,user:u,playerRef:p}=e,h=!(0,d.canSeeTranscription)(u,t),m=(0,c.NJ)(t),{iString:g}=(0,o.GO)();return((0,i.vJ)(()=>{(0,s.u4)(s.qY.TRANSCRIPTION_PAGE_VIEWED,{post_id:t.id})},[t.id]),m)?h?(0,r.Y)(a.pU,{user:u,publication:n,post:t,title:g("Transcriptions on this post are for paid subscribers"),reauthenticationTitle:g("To see the post, please re-authenticate.")}):(0,r.Y)(l.Ay,{transcription:m,player:p,postId:t.id}):null}},19256:function(e,t,n){"use strict";n.d(t,{_:()=>m});var r=n(4006),i=n(67078),a=n(17402),l=n(84605),o=n(86500),s=n(89490),c=n(35369),d=n(76977),u=n(16993),p=n(63136),h=n(49807);let m=e=>{let{isOpen:t,onClose:n,profile:m,dmUpgradeOptions:g,isEditor:b=!1}=e,{iString:f}=(0,l.GO)();(0,a.useEffect)(()=>{(0,o.u4)(o.qY.DIRECT_MESSAGE_WRITER_UPSELL_MODAL_SEEN,{subscribeButtonShown:y})},[]);let Y=null==m?void 0:m.primaryPublication,_=g?g.includes("free_subscribers")?"free_subscribers":g.includes("paid_subscribers")?"paid_subscribers":g.includes("founding_subscribers")?"founding_subscribers":null:null,v=_?(e=>{switch(e){case"free_subscribers":return"Subscribers";case"paid_subscribers":return"Paid subscribers";case"founding_subscribers":return"Founding members"}})(_):null,y=v&&(b||!b&&Y),w="founding_subscribers"===_?{plan:"founding",utm_source:"direct-message-writer"}:void 0,S=!b&&Y?(0,h.eV6)(Y,{addBase:!b,params:w}):(0,h.eV6)({},{addBase:!1,params:w}),k=(0,s.iF)({width:200});return(0,r.Y)(u.aF,{isOpen:t,onClose:n,children:(0,r.Y)(u.cw,{children:(0,r.FD)(d.I1,{gap:16,alignItems:"center",children:[(0,r.Y)(s.az,{bg:"secondary",radius:"full",padding:16,children:(0,r.Y)(i.A,{size:32})}),(0,r.FD)(d.I1,{gap:8,alignItems:"center",padding:8,children:[!!v&&(0,r.FD)(p.EY.B1,{children:[v," only"]}),!!v&&(0,r.Y)(p.EY.B3,{color:"secondary",align:"center",children:f("".concat(null==m?void 0:m.name," only accepts messages from ").concat(null==v?void 0:v.toLowerCase()))}),!v&&(0,r.Y)(p.EY.B3,{color:"secondary",align:"center",children:f("".concat(null==m?void 0:m.name," is not currently accepting message invites"))})]}),(0,r.FD)(d.I1,{gap:8,alignItems:"center",padding:8,children:[y&&(0,r.FD)(r.FK,{children:[(0,r.Y)(c.$n,{className:k,priority:"primary",href:S,newTab:!0,children:f((null==m?void 0:m.isSubscribed)?"Upgrade":"Subscribe")}),(0,r.Y)(c.$n,{className:k,onClick:()=>{(0,o.u4)(o.qY.DIRECT_MESSAGE_WRITER_UPSELL_MODAL_MAYBE_LATER_CLICKED),n()},priority:"secondary",children:f("Maybe later")})]}),!y&&(0,r.Y)(c.$n,{className:k,onClick:()=>{(0,o.u4)(o.qY.DIRECT_MESSAGE_WRITER_UPSELL_MODAL_OKAY_CLICKED),n()},priority:"secondary",children:f("Okay")})]})]})})})}},14124:function(e){e.exports=function(e){if(!e)return 0;let t=(e=e.replace(/<(.|\n)*?>/g," ")).match(/[a-zA-ZÃ€-Ã¿0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g)||e.match(/([\u0600-\u06ff]+|[\u0591-\u05F4]+)/g);if(null===t)return 0;let n=0;for(let e=0;e<t.length;e+=1){let r=t[e];r&&(r.charCodeAt(0)>=19968?n+=r.length:n+=1)}return n}},65942:function(e,t,n){"use strict";function r(e){return(e||"").replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t))}n.d(t,{A:()=>r})}}]);