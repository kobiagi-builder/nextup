"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["95611"],{44502:function(e,t,n){n.r(t),n.d(t,{ReaderOnboardingModal:()=>y,ReaderOnboardingModalWithUserContext:()=>f});var i=n(99851),r=n(69277),a=n(70408),l=n(32641),o=n(4006),s=n(17402),d=n(86271),c=n(52820),u=n(46271),p=n(86500),h=n(20360),E=n(7717),m=n(14868),_=n(95573),b=n(51651),g=n(21980),Y=n(30950),R=n(55087),I=n(10023),S=n(71419),A=n(52023),N=n(78979),D=n(39318),v=n(49807);class y extends d.w{componentDidMount(){super.componentDidMount()}componentWillReceiveProps(e){this.setState({skipRedirectOnExit:e.skipRedirectOnExit,zIndex:e.zIndex,entry:e.entry,onBeforeClose:e.onBeforeClose})}getDefaultStep(){return N.d.CATEGORIES}openForPub(e,t){this.setState({pub:e,profile:t,step:t?this.props.user?N.d.CATEGORIES:N.d.PUB_SIGNUP:N.d.PUB_LANDING}),this.open()}openToPubSignup(e){this.setState({pub:e,step:N.d.PUB_SIGNUP,profile:null}),this.open()}setStep(e){if((0,p.u4)(p.qY.READER_ONBOARDING_STEP_CHANGED,{from_step:this.state.step,to_step:e,modal:!0}),e===N.d.EXIT)if(this.state.skipRedirectOnExit)this.close();else{var t;let e=null!=(t=this.redirect)?t:this.state.pub&&"reader2"===this.state.entry?(0,D.$_T)(this.state.pub):(0,v.oT5)();document.location.href=e}else setTimeout(()=>this.setState({step:e}),0)}setPreviousStepData(e,t){this.setState({previousStepData:(0,a._)((0,r._)({},this.state.previousStepData),{[e]:t})})}getClassName(){return"reader-onboarding-modal wide"}onClose(){(0,p.u4)(p.qY.READER_ONBOARDING_MODAL_CLOSED,{entry:this.props.entry,step:this.state.step}),this.setStep(this.getDefaultStep()),document.location.reload()}onOpen(){var e;(0,p.u4)(p.qY.READER_ONBOARDING_MODAL_OPENED,{entry:this.props.entry,step:this.state.step,for_pub_id:null==(e=this.state.pub)?void 0:e.id})}handleError(e){let{ignore:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{step:n}=this.state;console.error("Error in reader onboarding ".concat(n," step: ").concat(e)),(0,p.u4)(p.qY.READER_ONBOARDING_ERROR,{step:n,entry:this.props.entry,ignore:t}),t||this.setStep(N.d.ERROR)}renderStep(){let e=this.props,{ref:t}=e,n=(0,l._)(e,["ref"]),{step:i,open:s,pub:d,profile:c,previousStepData:u}=this.state,p={setStep:this.setStep,handleError:this.handleError,close:this.close,setPreviousStepData:this.setPreviousStepData},D=()=>{this.setPreviousStepData(N.d.APP_UPSELL,!0),this.setStep(N.d.WELCOME)};if(!s)return null;switch(i){case N.d.SIGNUP:return(0,o.Y)(I.A,(0,a._)((0,r._)({},n,p),{previousStepData:u}));case N.d.PUB_LANDING:return(0,o.Y)(Y.A,(0,a._)((0,r._)({},n,p),{pub:d}));case N.d.PUB_SIGNUP:return(0,o.Y)(R.A,(0,a._)((0,r._)({},n,p),{pub:d,profile:null!=c?c:null}));case N.d.CATEGORIES:return(0,o.Y)(b.I,(0,a._)((0,r._)({},n,p),{pub:d}));case N.d.PROFILE:return(0,o.Y)(g.A,(0,r._)({},n,p));case N.d.START_WRITING:return(0,o.Y)(S.A,(0,r._)({},n,p));case N.d.CREATE_PUBLICATION:return(0,o.Y)(E.A,(0,r._)({},n,p));case N.d.CREATE_PUBLICATION_SUCCESS:return(0,o.Y)(m.A,(0,a._)((0,r._)({},n,p),{previousStepData:u}));case N.d.ERROR:return(0,o.Y)(_.A,(0,r._)({},n,p));case N.d.APP_UPSELL:return(0,o.Y)(h.A,{onComplete:D});case N.d.WELCOME:default:return(0,o.Y)(A.A,(0,a._)((0,r._)({},n,p),{pub:d,profile:null!=c?c:null}))}}renderChildren(){return(0,o.Y)("div",{className:"reader-onboarding-modal-container",children:this.renderStep()})}constructor(e,t){var n;super(e,t),(0,i._)(this,"redirect",void 0),this.setStep=this.setStep.bind(this),this.state.pub=e.pub||null,this.handleError=this.handleError.bind(this),this.state.previousStepData={},this.setPreviousStepData=this.setPreviousStepData.bind(this),this.state.skipRedirectOnExit=null!=(n=e.skipRedirectOnExit)&&n,this.redirect=e.redirect&&"/"!==e.redirect?e.redirect:null,this.state.step=e.step||this.getDefaultStep()}}(0,i._)(y,"contextType",c.qL);let f=(0,s.forwardRef)((e,t)=>{let n=(0,u.ur)(),i=e.onBeforeClose,l=i?()=>i(n.user):void 0,s=(0,a._)((0,r._)({},e),{onBeforeClose:l,user:n.user});return(0,o.Y)(y,(0,a._)((0,r._)({},s),{ref:t}))})},51651:function(e,t,n){n.d(t,{I:()=>y});var i=n(79785),r=n(4006),a=n(45994),l=n(15734),o=n.n(l),s=n(84605),d=n(86500),c=n(12501),u=n(35369),p=n(76977),h=n(57820),E=n(63136),m=n(82772),_=n(60322),b=n(81203),g=n(39318),Y=n(57324);let R=e=>{let{pubs:t,selected:n,setSelected:i,onRecommendationsFirstVisible:a}=e;return(0,r.FD)(p.I1,{padding:8,style:{marginBottom:"20px"},children:[(0,r.Y)(p.Ye,{alignItems:"center",justifyContent:"end",children:(0,r.Y)(E.EY.Meta,{onClick:()=>{(0,d.u4)(d.qY.ALL_ONBOARDING_PUBLICATIONS_TOGGLED,{surface:"reader_onboarding",action:n.length<t.length?"select_all":"unselect_all",pubIds:t.map(e=>{let{id:t}=e;return t})}),n.length<t.length?i(t.map(e=>{let{id:t}=e;return t})):i([])},padding:4,cursor:"pointer",children:n.length<t.length?"Select all":"Unselect all"})}),(0,r.Y)(p.I1,{divider:"detail",style:{overflow:"auto",height:"50vh",paddingBottom:20,paddingRight:8},children:t.map((e,t)=>(0,r.Y)(I,{pub:e,index:t,selected:n.includes(e.id),toggleSelected:()=>{var t;let r;return t=e.id,r=!1,void(n.includes(t)?i(n.filter(e=>e!==t)):(i([...n,t]),r=!0),(0,d.u4)(d.qY.READER_ONBOARDING_RECOMMENDED_PUB_TOGGLED,{surface:"reader_onboarding",publication_id:t,added:r}))},onRecommendationsFirstVisible:a},e.id))})]})},I=e=>{let{pub:t,selected:n,index:i,toggleSelected:l,onRecommendationsFirstVisible:o}=e,s=(0,a.li)(null);(0,m.S8)(s,()=>{o&&o(t,i)},{threshold:.5});let d=t.subdomain?"".concat((0,g.$_T)({subdomain:t.subdomain}),"/?utm_source=").concat(Y.VU.homepageReaderOnboarding):void 0;return(0,r.FD)(p.Ye,{ref:s,alignItems:"start",justifyContent:"space-between",paddingY:12,children:[(0,r.FD)(p.Ye,{alignItems:"start",justifyContent:"start",gap:8,children:[(0,r.Y)(b.wg,{logoUrl:t.imageUrl,publicationName:t.name,pub:t,href:d}),(0,r.FD)(p.I1,{justifyContent:"start",alignItems:"start",gap:4,children:[(0,r.FD)(p.I1,{alignItems:"start",justifyContent:"center",children:[(0,r.Y)(E.EY.H4,{children:t.name}),(0,r.Y)(E.EY.B4,{color:"pub-secondary-text",children:t.subtitle})]}),t.description&&(0,r.Y)(E.EY.B4,{color:"pub-secondary-text",textAlign:"left",children:t.description})]})]}),(0,r.Y)(_.S,{checked:n,onChange:l,size:"md"})]})};var S=n(59956),A=n(78979),N=n(38018);let D="contentContainer-A4QvRn";function v(){let e=(0,i._)(["Select "," more to continue"]);return v=function(){return e},e}let y=e=>{let{onCategoriesFinalized:t=null,setStep:n,handleError:i,pub:l=null,entry:m,user:_,setPreviousStepData:b,canBeSkipped:g=!1}=e,{iString:Y,iPlural:I,iTemplate:y}=(0,s.GO)(),[f,O]=(0,a.J0)([]),[C,P]=(0,a.J0)([]),[T,B]=(0,a.J0)(!1),[G,U]=(0,a.J0)([]),[L,k]=(0,a.J0)(!1),{result:F,isLoading:w}=(0,c.st)({pathname:"/api/v1/categories/recommended",auto:!0}),{result:x,isLoading:q,refetch:J}=(0,c.st)({pathname:"/api/v1/onboarding/recommended",auto:!1});(0,a.vJ)(()=>{(0,d.u4)(d.qY.READER_ONBOARDING_CATEGORIES_SCREEN_SHOWN,{entry:m,hasSelectedCategories:T})},[m,T]),(0,a.vJ)(()=>{if(T&&x&&!q){let e=(e=>{var t,n,i,r,a;let l=[],o=new Set,s=null==e||null==(t=e.collections.find(e=>(null==e?void 0:e.title)==="\uD83D\uDC64️ For you"))?void 0:t.publications;if(s&&(l=s.slice(0,N.l)).forEach(e=>o.add(e.id)),l.length<N.l){let t=(null==e||null==(n=e.collections)?void 0:n.length)||0;if(t>=3){let t=0;for(;l.length<N.l;){let n=!1;for(let r=0;r<3;r++){let a=null==e?void 0:e.collections[r],s=null==a||null==(i=a.publications)?void 0:i[t];if(s&&!o.has(s.id)&&(l.push(s),n=!0,o.add(s.id),l.length>=N.l))break}if(!n)break;t++}}else{let n=0;for(;l.length<N.l;){let i=Math.floor(n/t),s=null==e||null==(r=e.collections)?void 0:r[n%t],d=null==s||null==(a=s.publications)?void 0:a[i];if(!d)break;!o.has(d.id)&&(l.push(d),o.add(d.id),n++)}}}return l})(x);0===e.length&&(0,d.u4)(d.qY.READER_ONBOARDING_CATEGORIES_ERROR,{entry:m,error:"No recommendations found"}),P(e),e.some(e=>737237===e.id)&&U([737237])}},[x,q,T,m]);let W=null==F?void 0:F.categories,M=async()=>{try{let e={categoryIds:JSON.stringify(f)};await J({query:e})}catch(e){i(e,{ignore:!0}),n(A.d.PROFILE);return}for(let e of((0,d.u4)(d.qY.READER_ONBOARDING_CATEGORIES_FINALIZED,{entry:m,numberOfCategories:f.length}),f))(0,d.u4)(d.qY.READER_ONBOARDING_CATEGORY_REQUESTED,{entry:m,categoryId:e});B(!0),null==t||t()},K=async()=>{let e=_?_.profile_set_up_at?_.has_publication?A.d.APP_UPSELL:A.d.START_WRITING:A.d.PROFILE:A.d.SIGNUP;if(G.length>0)try{k(!0),(0,d.u4)(d.qY.READER_ONBOARDING_BULK_SUBSCRIBE_SELECTED_IN_UI,{entry:m,numberOfSubscriptions:G.length,recommendationsFrom:"model"}),_?(await o().post("/api/v1/bulk_signup").send({publications:G,source:"reader2-onboarding-modal"}),(0,d.u4)(d.qY.READER_ONBOARDING_BULK_SUBSCRIBED,{entry:m,numberOfSubscriptions:G.length,recommendationsFrom:"model"})):b(A.d.CATEGORIES,{publications:G,selectedCategoryIds:f}),n(e)}catch(e){(0,d.u4)(d.qY.READER_ONBOARDING_CATEGORIES_ERROR,{entry:m,error:e}),i(e,{ignore:!1})}else _?(0,d.u4)(d.qY.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:m,recommendationsFrom:"model"}):b(A.d.CATEGORIES,{publications:[],selectedCategoryIds:f}),n(e)};return T||0!==C.length?(0,r.FD)(p.I1,{children:[(0,r.FD)(p.I1,{children:[(0,r.Y)(E.EY.H2,{translated:!0,children:"Creators you may like"}),(0,r.Y)(E.EY.B2,{color:"pub-secondary-text",translated:!0,children:"We found some writers based on your interests."})]}),q?(0,r.Y)(h.y$,{}):(0,r.Y)(R,{pubs:C,selected:G,setSelected:U,onRecommendationsFirstVisible:(e,t)=>{(0,d.u4)(d.qY.READER_ONBOARDING_PUB_RECOMMENDED,{entry:m,publication_id:e.id,suggestion_rank:t,recommendationFrom:"model"})}}),(0,r.FD)(p.I1,{gap:8,children:[(0,r.FD)(u.$n,{priority:"primary",onClick:K,disabled:L,children:[G.length>0&&I("Subscribe and continue","Subscribe to %1 and continue",G.length),0===G.length&&Y("Continue without subscribing")]}),g&&(0,r.Y)(u.$n,{priority:"secondary",onClick:()=>{(0,d.u4)(d.qY.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:m,recommendationsFrom:"model"}),n(A.d.APP_UPSELL)},disabled:L,children:Y("Skip for now")})]})]}):(0,r.FD)(p.I1,{className:"categories-step",gap:2,children:[(0,r.FD)(p.I1,{children:[l?(0,r.FD)(p.I1,{children:[(0,r.Y)(E.EY.H3,{translated:!0,children:"You're subscribed!"}),(0,r.Y)(E.EY.B2,{color:"pub-secondary-text",translated:!0,children:"Now dive into your interests"})]}):(0,r.Y)(E.EY.H3,{translated:!0,children:"Dive into your interests"}),(0,r.Y)(E.EY.B2,{color:"pub-secondary-text",translated:!0,children:"We'll recommend top publications based on the topics you select."})]}),w?(0,r.Y)(h.y$,{}):W?(0,r.Y)(p.I1,{className:D,children:(0,r.Y)(S.LJ,{hasFeatured:!1,categories:W,categoryIds:f,onCategoryClicked:e=>{let{categoryId:t}=e;if(f.includes(t)){var n;let e=null==W||null==(n=W.find(e=>(null==e?void 0:e.id)===t))?void 0:n.subcategories;O(f.filter(n=>n!==t&&!(null==e?void 0:e.some(e=>e.id===n))))}else O([...f,t])},ranking:"all",defaultExpanded:!0})}):(0,r.Y)(p.I1,{className:D,children:(0,r.Y)(E.EY.B2,{translated:!0,children:"Something went wrong."})}),(0,r.Y)(u.$n,{className:"primary",onClick:M,children:f.length<3?y(v(),3-f.length):Y("Continue")})]})}},20360:function(e,t,n){n.d(t,{A:()=>u});var i=n(4006),r=n(45994),a=n(47963),l=n(86500),o=n(35369),s=n(76977),d=n(63136),c=n(57324);function u(e){let{onComplete:t}=e;return(0,r.vJ)(()=>(0,l.u4)(l.qY.READER_ONBOARDING_APP_UPSELL_SHOWN),[]),(0,i.FD)(s.I1,{paddingTop:24,gap:12,children:[(0,i.Y)(d.EY.H1,{weight:"heavy",children:"Download the Substack app"}),(0,i.Y)(d.EY.B3,{children:"Get the best reading experience on Android and iOS."}),(0,i.Y)(a.gF,{utm_campaign:c._9.readerOnboarding,utm_source:c.VU.substack}),(0,i.Y)("div",{className:"modal-ctas",children:(0,i.Y)(o.$n,{priority:"primary",onClick:t,children:"Continue"})})]})}},7717:function(e,t,n){n.d(t,{A:()=>D});var i=n(4006),r=n(45994),a=n(32485),l=n.n(a),o=n(38221),s=n.n(o),d=n(15734),c=n.n(d),u=n(42250),p=n(69277),h=n(70408),E=n(97731);let m=e=>(0,i.Y)(E.A,(0,h._)((0,p._)({},e),{name:"InvertedWarningIcon",svgParams:{height:18,width:18},children:(0,i.Y)("path",{d:"M9.00033 0.666992C4.39783 0.666992 0.666992 4.39783 0.666992 9.00033C0.666992 13.6028 4.39783 17.3337 9.00033 17.3337C13.6028 17.3337 17.3337 13.6028 17.3337 9.00033C17.3337 4.39783 13.6028 0.666992 9.00033 0.666992ZM9.00033 2.33366C12.682 2.33366 15.667 5.31866 15.667 9.00033C15.667 12.682 12.682 15.667 9.00033 15.667C5.31866 15.667 2.33366 12.682 2.33366 9.00033C2.33366 5.31866 5.31866 2.33366 9.00033 2.33366ZM8.16699 4.83366V9.83366H9.83366V4.83366H8.16699ZM8.16699 11.5003V13.167H9.83366V11.5003H8.16699Z"})}));var _=n(23725),b=n(86500),g=n(35369),Y=n(76977),R=n(63136),I=n(78979),S=n(82776);let A="errorText-XpsJyQ",N="aTag-yo_zoZ",D=e=>{let{user:t,setStep:n,entry:a,setPreviousStepData:o}=e,d=(0,r.li)(null),p=(0,r.li)(null),[h,E]=(0,r.J0)(""),[D,v]=(0,r.J0)([]),[y,f]=(0,r.J0)(!1),[O,C]=(0,r.J0)(!1),[P,T]=(0,r.J0)(!1);(0,r.vJ)(()=>{let e=async()=>{try{let e=await c().get("/api/v1/publication/suggestion");e.body.subdomain&&(f(!0),E(e.body.subdomain))}catch(e){console.error("Failed to get subdomain suggestion:",e)}};O||(C(!0),(0,b.u4)(b.qY.READER_ONBOARDING_CREATE_PUBLICATION_STEP_STARTED,{entry:a}),e(),C(!1))},[O,C,a]);let B=s()(e=>{G(e)},500),G=async e=>{let t=e.target.value;if(E(t),0===t.length)return void v([]);try{(await c().get("/api/v1/check_subdomain",{subdomain:t})).body.available?(f(!0),v([])):(f(!1),v([{msg:"This URL is taken. Try another."}]))}catch(t){var n,i;let e=[];null==(i=t.response.body)||null==(n=i.errors)||n.forEach(n=>{t.response.body.errors.length>1&&"Please enter a valid web URL (letters and numbers only)"===n.msg||e.push(n)}),f(!1),v(e)}},U=async()=>{var e,i,r,l,s;try{let r=(await c().post("/api/v1/publication").send({name:"".concat((0,S.guessFirstName)(null!=(i=null==t?void 0:t.name)?i:null)||"My"," Publication"),subdomain:h,hero_text:"Welcome to my publication",tos:!0,captcha_response:P&&(null==p||null==(e=p.current)?void 0:e.getResponse())})).body;o(I.d.CREATE_PUBLICATION,{createdPub:r}),n(I.d.CREATE_PUBLICATION_SUCCESS)}catch(t){if((0,b.u4)(b.qY.READER_ONBOARDING_CREATE_PUBLICATION_STEP_ERROR,{entry:a,message:t.toString()}),401===t.response.statusCode){T(!0),f(!1),v([]);return}let e=[];null==(l=t.response.body)||null==(r=l.errors)||r.forEach(n=>{t.response.body.errors.length>1&&"Please enter a valid web URL (letters and numbers only)"===n.msg||e.push(n)}),(null==(s=t.response.body)?void 0:s.error)&&e.push({msg:t.response.body.error}),f(!1),v(e)}};return(0,i.FD)(Y.I1,{gap:32,paddingTop:48,className:"mobileAwareWidth-lMCXnu",children:[(0,i.Y)(R.EY.H1,{children:"Create your publication"}),(0,i.FD)(Y.I1,{className:"borderedBox-PucNvX",gap:56,paddingTop:56,paddingBottom:32,paddingX:{mobile:12,desktop:48},radius:"md",children:[(0,i.FD)(Y.I1,{gap:16,children:[(0,i.Y)(R.EY.B3,{align:"left",weight:"bold",children:"Publication URL"}),(0,i.FD)(Y.Ye,{gap:12,alignItems:"center",children:[(0,i.Y)("input",{ref:d,type:"text",name:"subdomain",id:"subdomain",onInput:e=>{B(e)},value:h,className:l()("liveUpdatingInput-AypZsP",{["".concat("invalid-mVGeLg")]:D.length})}),(0,i.Y)(R.EY.B3,{children:".substack.com"}),(0,i.Y)(Y.pT,{className:"right-XckP6Z",children:y&&!D.length?(0,i.Y)(_.A,{isStatic:!0,height:18,fill:"#4c3",stroke:"#4c3"}):(0,i.Y)(m,{height:16,width:16,fill:"#D72B2B",stroke:"#D72B2B",strokeWidth:0})})]}),P&&(0,i.Y)(u.A,{ref:p}),(D.length>0||P)&&(0,i.FD)(Y.I1,{gap:8,children:[D.map(e=>(0,i.Y)(R.EY.B4,{className:A,align:"left",children:e.msg})),P&&(0,i.Y)(R.EY.B4,{className:A,align:"left",children:"Please complete the captcha to continue"})]})]}),(0,i.Y)(Y.I1,{gap:24,children:(0,i.Y)(g.$n,{size:"lg",onClick:U,disabled:D.length>0,children:"Continue"})})]}),(0,i.Y)(Y.pT,{className:"autoMargins-UJ_Q1X",alignItems:"center",children:(0,i.FD)(R.EY.B4,{color:"secondary",className:"narrower-nMJULR",children:["By signing up, you agree to"," ",(0,i.Y)("a",{className:N,href:"https://substack.com/pa",target:"_blank",rel:"noopener",children:"our publisher agreement"}),","," ",(0,i.Y)("a",{className:N,href:"https://substack.com/ccpa#personal-data-collected",target:"_blank",rel:"noopener",children:"information collection notice"}),", and"," ",(0,i.Y)("a",{className:N,href:"https://substack.com/privacy",target:"_blank",rel:"noopener",children:"privacy policy"})]})})]})}},14868:function(e,t,n){n.d(t,{A:()=>u});var i=n(4006),r=n(45994),a=n(86500),l=n(35369),o=n(76977),s=n(63136),d=n(78979),c=n(39318);let u=e=>{let{setStep:t,entry:n,previousStepData:u}=e;return(0,r.vJ)(()=>{(0,a.u4)(a.qY.READER_ONBOARDING_CREATE_PUBLICATION_SUCCESS_STEP_STARTED,{entry:n})}),(0,i.FD)(o.I1,{gap:48,paddingBottom:120,alignItems:"center",children:[(0,i.Y)("img",{className:"image-OdneRK",src:(0,c.dJ9)("/img/reader_onboarding/car.png",264)}),(0,i.FD)(o.I1,{gap:4,children:[(0,i.Y)(s.EY.H1,{children:"Success!"}),(0,i.Y)(s.EY.B3,{children:"You're all set! Head over to your dashboard and tell the world about your Susbtack"})]}),(0,i.FD)(o.I1,{className:"buttonGroup-HpHxnd",gap:4,children:[(0,i.Y)(l.$n,{size:"lg",onClick:()=>{window.location.href=(0,c.Z96)(u[d.d.CREATE_PUBLICATION].createdPub,{addBase:!0})},children:"Visit writer dashboard"}),(0,i.Y)(l.$n,{size:"lg",priority:"secondary",onClick:()=>{(0,a.u4)(a.qY.READER_ONBOARDING_CREATE_PUBLICATION_SUCCESS_STEP_SKIPPED,{entry:n}),t(d.d.APP_UPSELL)},children:"Visit later"})]})]})}},95573:function(e,t,n){n.d(t,{A:()=>l});var i=n(4006),r=n(24142),a=n(35369);let l=e=>{let{close:t}=e;return(0,i.FD)("div",{className:"welcome-step",children:[(0,i.FD)("div",{className:"headings",children:[(0,i.Y)(r.A,{className:"substack",width:72,height:72}),(0,i.Y)("h3",{children:"Something went wrong"}),(0,i.Y)("p",{children:"We're sorry for the inconvenience."})]}),(0,i.Y)("div",{className:"spacer"}),(0,i.Y)("div",{className:"spacer"}),(0,i.Y)("div",{className:"modal-ctas",children:(0,i.Y)(a.$n,{priority:"secondary",onClick:t,children:"Close"})})]})}},21980:function(e,t,n){n.d(t,{A:()=>b});var i=n(69277),r=n(70408),a=n(4006),l=n(45994),o=n(32485),s=n.n(o),d=n(15734),c=n.n(d),u=n(61431),p=n(5109),h=n(46271),E=n(86500),m=n(94729),_=n(78979);let b=e=>{let{setStep:t,handleError:n,user:o,entry:d,followUserIds:b,redirectAfterProfile:g=!1,barebones:Y=!1}=e,[R,I]=(0,l.J0)(null),[S,A]=(0,l.J0)(!1),N=o?o.id:null,{setUser:D}=(0,h.ur)();(0,l.vJ)(()=>{(async()=>{if(null==b?void 0:b.length)try{await (0,m.x6)("/api/v1/feed/bulk-follow",{method:"POST",json:{surface:"post-follow-referrer-prompt",userIds:b}})}catch(e){console.error("could not bulk-follow",e)}})()},[b]),(0,l.vJ)(()=>{(0,E.u4)(E.qY.READER_ONBOARDING_PROFILE_SETUP_STARTED,{entry:d});let e=async()=>{try{var e;let t=(await c().get("/api/v1/user/".concat(N,"/profile/edit"))).body;t&&!t.profile_set_up_at&&(null==(e=t.subscriptions)?void 0:e.length)>0&&(t.subscriptions=t.subscriptions.map(e=>(0,r._)((0,i._)({},e),{visibility:"public"}))),I(t)}catch(e){n(e,{ignore:!0}),t(_.d.APP_UPSELL)}};N&&e()},[n,t,N,d]);let v=!!(null==R?void 0:R.profile_set_up_at);return(0,a.FD)(a.FK,{children:[(0,a.FD)("div",{className:s()("profile-step",{hidden:!S}),children:[(0,a.Y)("h3",{children:"Subscriptions displayed on profile"}),(0,a.Y)("p",{children:"Subscriptions appear on your profile by default, but you can choose to hide some or all of them"}),(0,a.Y)(u._,{profile:R,onFinalizeVisibility:()=>A(!1),onSetVisibility:e=>{R?I((0,r._)((0,i._)({},R),{subscriptions:[...R.subscriptions.map(t=>{let n=e[t.publication.id];return n?(0,r._)((0,i._)({},t),{visibility:n}):t})]})):console.warn("No profile, cannot set visibility")},source:"homepage-reader-onboarding"})]}),(0,a.FD)("div",{className:s()("profile-step",{hidden:S}),children:[(0,a.Y)("h3",{children:"Tell us about yourself"}),(0,a.Y)("p",{children:"Add your name, a profile picture, and a bit more about who you are."}),(0,a.Y)(p.dx,{pageTitle:"",user:o,freeSignup:!0,freeSignupEmail:null,needsPhoto:!1,optionalPhoto:!0,isPostInvite:!1,primaryEligiblePublications:[],onSuccess:e=>{let n=null==e?void 0:e.body;n&&D(n),g?t(_.d.EXIT):t(_.d.APP_UPSELL)},onEditReadVisibility:()=>{A(!0),(0,E.u4)(E.qY.READER_ONBOARDING_PROFILE_SETUP_SKIPPED,{entry:d})},numVisibleSubscriptions:(null==R?void 0:R.subscriptions.filter(e=>{let{visibility:t}=e;return"public"===t}).length)||0,numSubscriptions:(null==R?void 0:R.subscriptions.length)||0,complete:!0,text:"Continue",profileExists:v,prepareData:e=>(e.reads_visibility=(null==R?void 0:R.subscriptions.map(e=>{let{id:t,visibility:n}=e;return{id:t,visibility:n}}))||[],e),barebones:Y})]})]})}},30950:function(e,t,n){n.d(t,{A:()=>E});var i=n(4006),r=n(34206),a=n(9266),l=n(34835),o=n(86500),s=n(1683),d=n(35369),c=n(81203),u=n(40659),p=n(78979),h=n(39318);let E=e=>{let{pub:t,user:n,setStep:E,entry:m}=e,_=(0,u.rG)();return(0,i.Y)("div",{className:"pub-landing-step",children:(0,i.FD)(r.Ay,{method:"post",action:"/api/v1/reader/signup/pub",loading:!1,autoLock:!0,onSuccess:e=>{(0,o.u4)(o.qY.READER_ONBOARDING_PUB_LANDING_SIGNUP_SUCCEEDED,{entry:m}),n||(0,l.E)({user:e.body.user}),E(p.d.CATEGORIES)},children:[(0,i.FD)("div",{className:"headings",children:[(0,i.Y)(c.Nq,{pub:t,size:84}),(0,i.Y)("h3",{className:"publication-title",children:t.name}),(0,i.Y)("p",{className:"publication-description",children:t.editorial_bio||t.hero_text}),(0,i.Y)("p",{className:"publication-details",children:(0,a.Be)(t)})]}),(0,i.Y)("input",{type:"hidden",name:"email",value:null==n?void 0:n.email}),(0,i.Y)("input",{type:"hidden",name:"source",value:"".concat(m,"-reader-onboarding")}),(0,i.Y)("input",{type:"hidden",name:"publication_id",value:t.id}),(0,i.Y)("input",{type:"hidden",name:"noWelcomeEmail",value:"true"}),(0,i.Y)("input",{type:"hidden",name:"first_url",value:s.R9}),(0,i.Y)("input",{type:"hidden",name:"first_referrer",value:s.b7}),(0,i.Y)("input",{type:"hidden",name:"first_session_url",value:s.K0}),(0,i.Y)("input",{type:"hidden",name:"first_session_referrer",value:s.OG}),(0,i.Y)("input",{type:"hidden",name:"current_url",value:s.AT}),(0,i.Y)("input",{type:"hidden",name:"current_referrer",value:s.uC}),Object.entries(_).map(e=>{let[t,n]=e;return(0,i.Y)("input",{type:"hidden",name:t,value:n},t)}),(0,i.FD)("div",{className:"modal-ctas",children:[(0,i.Y)("a",{className:"button let-me-read",href:(0,h.yRP)((0,h.$_T)(t),{no_cover:!0,utm_source:"".concat(m,"-reader-onboarding")}),onClick:()=>{(0,o.u4)(o.qY.READER_ONBOARDING_PUB_LANDING_LET_ME_READ_CLICKED,{entry:m}),(0,o.fN)(t,m)},children:"Let me read it first"}),(0,i.Y)(d.$n,{priority:"primary",onClick:e=>{(0,o.u4)(o.qY.READER_ONBOARDING_PUB_LANDING_SUBSCRIBE_CLICKED,{entry:m}),n||(e.preventDefault(),E(p.d.PUB_SIGNUP))},type:"submit",children:"Subscribe"})]})]})})}},55087:function(e,t,n){n.d(t,{A:()=>Y});var i=n(4006),r=n(45994),a=n(34206),l=n(9266),o=n(46271),s=n(34835),d=n(86500),c=n(1683),u=n(35369),p=n(76977),h=n(81203),E=n(63136),m=n(61554),_=n(40659),b=n(78979),g=n(39318);let Y=e=>{let{pub:t,user:n,profile:Y,setStep:R,entry:I}=e,{setUser:S}=(0,o.ur)(),[A,N]=(0,r.J0)(""),[D,v]=(0,r.J0)(!1),[y,f]=(0,r.J0)(!1),O=(0,_.rG)();return(0,i.FD)("div",{className:"pub-signup-step",children:[(0,i.FD)("div",{className:"headings",children:[(0,i.Y)(h.Nq,{pub:t,size:84,className:"pub-icon"}),(0,i.Y)("h3",{className:"publication-title",children:Y?"Create an account to start reading":"Subscribe to ".concat(t.name)}),(0,i.Y)("p",{className:"publication-description",children:Y?"Create a Substack account to subscribe to ".concat(Y.name):t.editorial_bio||t.hero_text}),(0,i.Y)("p",{className:"publication-details",children:Y?"Author of ".concat(t.name):(0,l.Be)(t)})]}),(0,i.FD)(a.Ay,{method:"post",action:"/api/v1/reader/signup/pub",loading:!1,autoLock:!0,onSuccess:e=>{n||((0,s.E)({user:e.body.user}),S(e.body.user)),e.body.requires_confirmation?((0,d.u4)(d.qY.READER_ONBOARDING_PUB_SIGNUP_FAILED,{reason:"user_exists",entry:I}),v(!0)):((0,d.u4)(d.qY.READER_ONBOARDING_PUB_SIGNUP_SUCCEEDED,{entry:I}),(0,s.E)({user:e.body.user}),R(b.d.CATEGORIES))},children:[(0,i.FD)("p",{children:[(0,i.Y)("label",{for:"email",children:"Email"}),(0,i.Y)("input",{type:"email",name:"email","aria-label":"Email",value:A,tabIndex:0,onInput:e=>{N(e.target.value)},onChange:e=>{N(e.target.value)}}),(0,i.Y)("input",{type:"hidden",name:"source",value:"".concat(I,"-reader-onboarding")}),(0,i.Y)("input",{type:"hidden",name:"publication_id",value:t.id}),(0,i.Y)("input",{type:"hidden",name:"noWelcomeEmail",value:"true"}),(0,i.Y)("input",{type:"hidden",name:"first_url",value:c.R9}),(0,i.Y)("input",{type:"hidden",name:"first_referrer",value:c.b7}),(0,i.Y)("input",{type:"hidden",name:"first_session_url",value:c.K0}),(0,i.Y)("input",{type:"hidden",name:"first_session_referrer",value:c.OG}),(0,i.Y)("input",{type:"hidden",name:"current_url",value:c.AT}),(0,i.Y)("input",{type:"hidden",name:"current_referrer",value:c.uC}),Object.entries(O).map(e=>{let[t,n]=e;return(0,i.Y)("input",{type:"hidden",name:t,value:n},t)}),D&&(0,i.FD)("div",{className:"error",children:["Additional confirmation is required to complete your signup. Please"," ",(0,i.Y)("a",{href:(0,g.a7q)({for_pub:t.subdomain,email:A}),children:"login"})," ","or click the confirmation link in your email."]})]}),(0,i.Y)("div",{id:"error-container"}),(0,i.FD)(p.I1,{alignItems:"center",justifyContent:"space-between",paddingTop:64,gap:4,children:[(0,i.Y)(m.U,{checked:y,onCheckboxChange:e=>{f(e)}}),(0,i.Y)(u.$n,{type:"submit",priority:"primary",disabled:!y||!A,style:{marginTop:12,marginBottom:4},children:"Subscribe and continue"}),(0,i.FD)(E.EY.B5,{weight:"light",color:"secondary",children:["Already have a Substack account?"," ",(0,i.Y)(E.EY.B5,{as:"a",weight:"light",color:"secondary",href:(0,g.a7q)({for_pub:t.subdomain}),target:"_blank",style:{textDecoration:"underline"},children:"Sign in"})]})]})]})]})}},10023:function(e,t,n){n.d(t,{A:()=>I});var i=n(4006),r=n(45994),a=n(32485),l=n.n(a),o=n(15734),s=n.n(o),d=n(34206),c=n(24142),u=n(46271),p=n(34835),h=n(86500),E=n(60322),m=n(76977),_=n(63136),b=n(92028),g=n(78979),Y=n(39318),R=n(80856);function I(e){var t,n,a,o,c;let{user:I,setStep:A,entry:N,previousStepData:D,prefilledEmail:v,skipCategories:y=!1}=e,{setUser:f}=(0,u.ur)(),[O,C]=(0,r.J0)(null!=v?v:""),[P,T]=(0,r.J0)(!1),[B,G]=(0,r.J0)(!1);(0,r.vJ)(()=>{I&&!D[g.d.CATEGORIES]&&A(g.d.CATEGORIES)},[I,A,D]);let[U,L]=(0,r.J0)(!1),k=async e=>{if(e.body.userExists)return void T(!0);if(e.body.emailConfirmationRequired)return void G(!0);if((0,h.u4)(h.qY.READER_ONBOARDING_SIGNUP_SUCCEEDED,{entry:N}),I||((0,p.E)({user:e.body.user}),f(e.body.user)),D[g.d.CATEGORIES]){var t;e.body.userExists?A(g.d.APP_UPSELL):A(g.d.PROFILE);let n=null==(t=D[g.d.CATEGORIES])?void 0:t.publications;(null==n?void 0:n.length)?(await s().post("/api/v1/bulk_signup").send({publications:n,source:"".concat(N,"-reader-onboarding"),email:O}),(0,h.u4)(h.qY.READER_ONBOARDING_BULK_SUBSCRIBED,{entry:N,numberOfSubscriptions:n.length,recommendationsFrom:"categories"})):(0,h.u4)(h.qY.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:N,recommendationsFrom:"categories"})}else y?A(g.d.PROFILE):A(g.d.CATEGORIES)};if(B)return(0,i.FD)(m.I1,{className:"signup-step",children:[(0,i.Y)(S,{title:"Verify your email address"}),(0,i.FD)(_.EY.B3,{children:["We just sent an email to ",(0,i.Y)("strong",{children:O}),". Please check your inbox before continuing."]}),(0,i.Y)(m.pT,{flex:"grow"}),(0,i.Y)("div",{className:"modal-ctas",children:(0,i.Y)(b.Q,{onClick:e=>{e.preventDefault(),G(!1)},children:(0,i.Y)(_.EY,{as:"span",decoration:"hover-underline",children:"Or edit your email address or try again."})})})]});let F=null!=(o=null==(t=D[g.d.CATEGORIES])?void 0:t.publications)?o:[],w=null!=(c=null==(n=D[g.d.CATEGORIES])?void 0:n.selectedCategoryIds)?c:[];return(0,i.FD)("div",{className:"signup-step",children:[(0,i.Y)(S,{title:"Sign up to subscribe",subtitle:"Substack is the home for great writing."}),(0,i.FD)(d.Ay,{method:"post",action:"/api/v1/reader/signup/just_email",loading:!1,autoLock:!0,onSuccess:k,children:[(0,i.Y)("input",{type:"hidden",name:"publicationIds",value:F.join(",")}),(0,i.Y)("input",{type:"hidden",name:"selectedCategoryIds",value:w.join(",")}),(0,i.FD)("p",{children:[(0,i.Y)("label",{for:"email",children:"Your email address"}),(0,i.Y)("input",{type:"email",name:"email","aria-label":"Email",value:O,tabIndex:0,onInput:e=>{C(e.target.value)},onChange:e=>{C(e.target.value)}}),P&&(0,i.FD)("div",{className:"error",children:["This email is already registered with Substack. Please"," ",(0,i.Y)("a",{native:!0,href:(0,Y.fxv)(),children:"sign in to continue"}),"."]}),B&&(0,i.Y)("div",{className:"error",children:"We have sent you a confirmation email. Please check your inbox before continuing."})]}),(0,i.Y)("div",{id:"error-container"}),(0,i.FD)(m.I1,{gap:16,children:[(0,i.FD)(m.Ye,{as:"label",gap:8,className:"checkboxLabel-gCoESV",children:[(0,i.Y)(E.S,{checked:U,onChange:e=>{L(e)},size:"sm"}),(0,i.Y)(m.I1,{flex:"grow",children:(0,i.FD)(_.EY.B3,{as:"span",textAlign:"left",children:["I agree to Substack’s"," ",(0,i.Y)("a",{href:(0,R.lk)(),target:"_blank",children:"Terms of Use"})," ","and acknowledge its"," ",(0,i.Y)("a",{href:(0,R.iQ)(),target:"_blank",children:"Information Collection Notice"})," ","and"," ",(0,i.Y)("a",{href:(0,R.gB)(),target:"_blank",children:"Privacy Policy"})]})})]}),(0,i.Y)("button",{className:l()("button primary",{disabled:!U},"noMargin-hNmNqv"),type:"submit",disabled:!U,children:D[g.d.CATEGORIES]&&(null==(a=D[g.d.CATEGORIES])?void 0:a.publications.length)?"Subscribe and join Substack":"Get started"}),(0,i.FD)(_.EY.B3,{children:["Already have a Substack account?"," ",(0,i.Y)("a",{native:!0,href:(0,Y.fxv)(),children:"Sign in"})]})]})]})]})}function S(e){let{title:t,subtitle:n}=e;return(0,i.FD)("div",{className:"headings",children:[(0,i.Y)(c.A,{className:"substack",width:68,height:68}),(0,i.Y)("h3",{children:t}),n&&(0,i.Y)("p",{children:n})]})}},71419:function(e,t,n){n.d(t,{A:()=>u});var i=n(4006),r=n(45994),a=n(86500),l=n(35369),o=n(76977),s=n(63136),d=n(78979),c=n(39318);let u=e=>{let{setStep:t,entry:n}=e;return(0,r.vJ)(()=>{(0,a.u4)(a.qY.READER_ONBOARDING_START_WRITING_STEP_STARTED,{entry:n})}),(0,i.FD)(o.I1,{alignItems:"center",gap:48,paddingBottom:120,children:[(0,i.Y)("img",{className:"image-eElYa7",src:(0,c.dJ9)("/img/reader_onboarding/jobpage_penholder.png",150)}),(0,i.FD)(o.I1,{gap:4,children:[(0,i.Y)(s.EY.H1,{children:"Want to start writing on Substack?"}),(0,i.Y)(s.EY.B3,{color:"secondary",children:"Write posts, grow your audience, and make money on Substack"})]}),(0,i.FD)(o.I1,{className:"buttonGroup-BqeO0U",gap:4,children:[(0,i.Y)(l.$n,{size:"lg",onClick:()=>t(d.d.CREATE_PUBLICATION),children:"Create my publication"}),(0,i.Y)(l.$n,{size:"lg",priority:"secondary",onClick:()=>{(0,a.u4)(a.qY.READER_ONBOARDING_START_WRITING_STEP_SKIPPED,{entry:n}),t(d.d.APP_UPSELL)},children:"Skip for now"})]})]})}},52023:function(e,t,n){n.d(t,{A:()=>s});var i=n(4006),r=n(24142),a=n(86500),l=n(35369),o=n(78979);let s=e=>{let{pub:t=null,profile:n,entry:s,setStep:d}=e;return(0,i.FD)("div",{className:"welcome-step",children:[(0,i.FD)("div",{className:"headings",children:[(0,i.Y)(r.A,{className:"substack",width:68,height:68}),(0,i.Y)("h3",{children:"You're all set up"}),(0,i.FD)("p",{children:["You will now start receiving new posts from"," ",n?(0,i.FD)(i.FK,{children:[(0,i.Y)("b",{children:n.name})," and the other writers"]}):t?(0,i.FD)(i.FK,{children:[(0,i.Y)("b",{children:t.name})," and the other publications"]}):"the publications"," ","you subscribed to. Happy reading!"]})]}),(0,i.Y)("div",{className:"spacer"}),(0,i.Y)("div",{className:"spacer"}),(0,i.Y)("div",{className:"modal-ctas",children:(0,i.FD)(l.$n,{priority:"primary",onClick:()=>{(0,a.u4)(a.qY.READER_ONBOARDING_START_READING_CLICKED,{entry:s}),d(o.d.EXIT)},children:["Start reading",n?" ".concat(n.name):t?" ".concat(t.name):""]})})]})}},78979:function(e,t,n){n.d(t,{d:()=>i});let i={SIGNUP:"SIGNUP",PUB_LANDING:"PUB_LANDING",PUB_SIGNUP:"PUB_SIGNUP",CATEGORIES:"CATEGORIES",CATEGORIES_SUGGESTIONS:"CATEGORIES_SUGGESTIONS",PROFILE:"PROFILE",START_WRITING:"START_WRITING",CREATE_PUBLICATION:"CREATE_PUBLICATION",CREATE_PUBLICATION_SUCCESS:"CREATE_PUBLICATION_SUCCESS",WELCOME:"WELCOME",ERROR:"ERROR",EXIT:"EXIT",APP_UPSELL:"APP_UPSELL"}},38018:function(e,t,n){n.d(t,{l:()=>i});let i=7}}]);